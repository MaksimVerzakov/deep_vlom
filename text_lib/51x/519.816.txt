УДК 519.816
О способе интеграции нечетких моделей для организации поддержки принятия решений в слабо структурируемой предметной области1
Аверкин А.Н., Аграфонова Т.В.
e-mail: averkin2003@inbox.ru, solnishko3@yandex.ru
Вычислительный Центр им. А.А. Дородницына Российской Академии Наук

Рассматривается интегрированная модель поддержки принятия решений в слабо структурированных ситуациях, в основе которой лежит нечеткая иерархическая модель. В результате анализа модели ситуации, ранжируется множество альтернатив по многим критериям, важность которых определяется относительно генеральной цели в построенной иерархической модели ситуации.

Введение. 
Работа направлена на интеграцию различных моделей для разработки объектов с синергетическим эффектом, используемых для решения неоднородных задач в системах поддержки принятия решений (СППР), оценивающих альтернативы, выбирающих лучший вариант и согласовывающих групповые решения.
В представленной работе решается задача поддержки принятия решений в слабо структурированной предметной области, которая характеризуется представлением предметной области в виде качественных и количественных описаний системообразующих факторов, с преобладанием качественных описаний; взаимовлияние факторов определяется методом субъективных экспертных оценок.
В основе разрабатываемой модели лежит идея об интеграции модели представления знаний о слабо структурируемой предметной области в виде нечеткой иерархии и метода многокритериального ранжирования нечетких объектов.
Представленная в рамках данной работы интегрированная модель использует представление предметной области в виде нечеткой иерархии, а также позволяет проводить многокритериальное оценивание заранее заданных альтернатив с учетом значимости критериев относительно  целей, заданных в системе.
Разработанные методы и алгоритмы использованы при создании программного комплекса, предназначенного для автоматизации процесса решения задач выбора оптимального подмножества возможных альтернатив путем упорядочения (ранжирования) объектов с учетом сформированного множества целей. 
1. Методы и алгоритмы построения и анализа нечеткой иерархической  модели слабо структурированной ситуации.
1.1. Нечеткая иерархическая модель слабо структурированной предметной области
Анализируется методология анализа иерархических моделей ситуации. При рассмотрении проблем функционирования или развития сложных объектов, связи между системообразующими факторами часто удается представить в виде многоуровневой иерархически упорядоченной структуры.
Введем несколько основных понятий.
Альтернативами называются варианты принимаемых решений. 
Критерий – способ описания альтернативных вариантов решений, способ выражения различий между ними с точки зрения предпочтений ЛПР.
Критерии определяются ЛПР на основе его целей и требований к задаче выбора. Критерии называются зависимыми, когда оценка альтернативы по одному из критериев определяет оценку по другому критерию. При большом количестве критериев они могут быть объединены в группы зависимых критериев, имеющих определенное смысловое значение. Такие группы, как правило, являются независимыми. Таким образом, появляется иерархия критериев, т.е. могут быть построены иерархии критериев с различным числом уровней. Представление в виде  иерархической структуры является  наиболее удобным способом представления слабо структурированной ситуации. В качестве  модели используется дерево критериев, в котором общие критерии разделяются на критерии частного характера. Для каждой группы критериев определяются коэффициенты важности относительно критерия верхнего уровня. 
Определение:  Иерархия - есть определенный тип системы, основанный на предположении, что элементы системы могут группироваться в несвязные множества. Элементы каждой группы находятся под влиянием некоторой вполне определенной группы, и, в свою очередь, оказывают влияние на элементы другой группы.
1.2. Основные этапы определения коэффициентов важности объектов в иерархических системах
В существующих методах анализа иерархических структур за уровнем листовых критериев следует уровень альтернатив А={KJ}, J=1,M. Каждая из альтернатив KJ есть некоторое решение, характеризующееся набором атрибутов, которые совпадают с названиями листовых критериев ki. 
Возникает задача нахождения наилучшей альтернативы KJ  (т.е. наилучшего решения из множества рассматриваемых решений) относительно генеральной цели (элемента верхнего уровня иерархической структуры). Для решения задачи нахождения наилучшей альтернативы необходимо, прежде всего, определить коэффициенты относительной важности (т.е. веса) критериев в построенной иерархии относительно генеральной цели (критерия 0 уровня построенной модели). 
Процесс определения коэффициентов важности в иерархических системах состоит  из следующих этапов. 
1.2.1. Построение иерархической модели.
Иерархия строится методом  структурной декомпозиции рассматриваемой ситуации (формирование структур “сверху”). Цели нижележащего уровня иерархии есть средства для достижения целей вышестоящего уровня. Для уровней, нижележащих по отношению к ним, они являются целями. В настоящее время пока еще нет сложившейся строгой постановки задачи построения иерархических (многоуровневых) структур системообразующих факторов. Однако можно указать основные принципы их практического построения [1].
На множестве объектов ситуации Z = {1,...,N} определяется ориентированный граф G = (Z,W) без контуров с множеством вершин Z, совпадающим с множеством объектов, и множеством дуг W. Наличие дуги (i,j)W означает, что вес z объекта (вершины) i непосредственно зависит от веса z объекта j.  Граф  имеет структуру дерева целей и задач, если его вершины можно расположить на непересекающихся уровнях V,...,V так, что дуги графа соединяют только вершины смежных уровней, причем: дуги ведут сверху вниз, с уровня V на уровень V, i = 1,...,M-1; все вершины, из которых дуги не выходят, находятся на уровне V. Построение иерархии  оканчивается уровнем листовых критериев , т.е.  таких критериев, что они являются далее не декомпозируемыми  и  для каждого из них можно построить ограниченное линейно - упорядоченное множество принимаемых значений (шкалу). 
1.2.2.  Проведение элементарных экспертиз и Определение весов дуг иерархии. 
Элементарная экспертиза состоит в получении для некоторой вершины iV парных оценок весов дуг (i,j)W, jГ= {k|(i,k)W}. Парные оценки r показывают, во сколько раз вклад объекта j больше вклада объекта k в решение задачи, стоящей перед объектом i; j,kГ. 
Эти оценки могут быть: 
а) точечными (rR - неотрицательные числа); 
б) интервальными (r = [a,b]R - интервалы); 
в) нечеткими числами (r = {(t,(t))| tR} - замкнутые выпуклые подмножества на положительной полуоси R}. Последний случай включает также лингвистические оценки и два предыдущих случая.
Таким образом, результатом элементарной экспертизы является взвешенное бинарное отношение R = {(j,k), r)| j,kГ} на множестве объектов Г, задающее интенсивности превосходства объектов. 
Результат усреднения парных оценок в i-й элементарной экспертизе - точечное, интервальное или нечеткое отношение R с интенсивностью превосходства используется для определения весов всех дуг (i,j)W, выходящих из вершины i, с помощью метода анализа нечетких иерархий (МАНИ) [1,2]. 
1.2.3. Определение коэффициентов важности. 
После обработки результатов элементарных экспертиз определены веса  w критериев  первого уровня иерархии и   веса  всех дуг (i,j)W.  Далее, для  каждой дуги (i,j) W  определяем знак  влияния критерия нижнего уровня на критерий предыдущего уровня, обозначим   - положительный знак на дуге и, соответственно,  - отрицательный знак на дуге. Тогда веса  всех дуг (i,j)W  определяются следующим образом: 
 
Веса критериев нижнего уровня определяются тогда следующим способом: путем рекуррентного сверху вниз пересчета весов критериев, с учетом знаков на дугах  иерархии: 
w =  w, iV,
…………………………
w =  w, iV,
(Г = {j| (j,i)E}),V1,…, VS - уровни в иерархии.
В результате применения методов анализа количественной и качественной информации об интенсивности предпочтений в иерархии получили веса листовых критериев.
2. Методы и алгоритмы построения и анализа модели нечеткого многокритериального ранжирования альтернатив.
Принятие решений как особый вид целенаправленной деятельности заключается в выборе одной или нескольких альтернатив из заданного множества на основе системы предпочтений, характеризующей желательность этих альтернатив для аналитика в рамках данной задачи, то есть в соответствии с зафиксированными им цепью и ограничивающими условиями.
Здесь и далее термин «альтернатива» используется для обозначения рассматриваемых объектов, вариантов, способов действий и т. п., из которых не обязательно должна выбираться только одна альтернатива.
В рамках настоящей работы разрабатывается метод, соответствующие алгоритмы и создается на их основе диалоговая система для решения слабо структурированных задач ранжирования альтернатив в условиях нечетких исходных данных.
1.3. Метод решения многокритериальной задачи выбора вариантов.
В общих чертах метод предлагаемый для решения сформулированной задачи ранжирования состоит в следующем.
Во-первых, в любой задаче принятие решения со многими критериями возникает проблема выбора обобщенного (глобального) критерия, Существует множество методов построения обобщенных критериев.
Заметим только, что во многих практических задачах нет оснований априори считать один критерий более важным, чем другой; в предлагаемом подходе принято, что на системного аналитика возлагается задача построения упорядоченных согласно (3.1) классов равноценных градаций . Отсюда вытекает первая задача исследования: зная классы  и их упорядочение (3.1) необходимо определить понятия обобщенной шкалы и предложить способ вычисления оценок каждой альтернативы  на этой шкале (то есть обобщенных оценок ) на основе частных оценок  .
Во-вторых, необходимо предложить метод попарного сравнения любых двух альтернатив i и j из множества Х на основе знания их обобщенных оценок  и  и определить в результате этого сравнения оценку  степени предпочтения альтернативы i перед j.
Проведя такое сравнение для всех пар альтернатив  можно построить квадратную  матрицу, определяющее некоторое бинарное нечеткое отношение R на Х и содержащую в агрегированном виде предпочтения как системного аналитика, так и группы экспертов. 
В-третьих, по нечеткому отношению R необходимо проранжировать объекты. Данная задача сводится к задаче аппроксимации R нечеткой обратимой квазисерией.
Таким образом, предлагаемый метод заключается в следующем: на основе перечисленной выше исходной информации построить исходную шкалу, вычислить обобщенные оценки альтернатив, построить на основе этих оценок бинарное нечеткое отношение предпочтения R, а затем найти ближайшую к нему обратимую квазисерию.
3. Методология построения гибридной модели слабо структурированной ситуации на основе интеграции нечеткой иерархической модели и модели нечеткого многокритериального ранжирования альтернатив.
Принципиальной особенностью процесса выбора решения является использование информации об исходном состоянии факторов. Из-за неполноты количественной информации о состоянии факторов и показателей вводится система бинарных отношений предпочтения, вводятся порядковые шкалы для качественных критериев. В иерархической системе имеет место граф системообразующих факторов, согласно которому организуется обмен информацией между уровнями подсистем, предусматривается распределение функций по обработке информации, при этом цели подсистем не противоположны. Таким образом, критерий эффективности является векторным критерием. Разработанные алгоритмы анализа иерархических структур позволяют перейти к скалярным критериям, упорядоченным по важности относительно главной цели, заданной в системе [3]. 
Для упорядоченных по важности скалярных критериев разработанными методами многокритериального ранжирования строится обобщенная шкала измерения, являющейся сверткой шкал используемых количественных и качественных критериев. Таким образом, проводится оценка мероприятий (объектов) по интегрированному критерию, с использованием количественных оценок, полученных из информационно-справочной системы, и качественных оценок, полученных от экспертов.
Модель иерархического оценивания описывает ситуацию с точки зрения цели управления ситуацией, степень достижения которой выражается через предпочтения эксперта, в виде коэффициентов важности системообразующих факторов в некоторой шкале. 
Необходимо решить задачу построения дискретной шкалы для системообразующих факторов на последнем уровне иерархии, являющихся критериями для многокритериальной оценки заданных в системе альтернатив. Вводимая дискретная шкала для каждого их критериев должна позволять описывать оценки альтернатив по рассматриваемым критериям. Вводимые на дискретной шкале градации должны позволять описывать изменение предпочтений экспертов по мере перемещения от одной градации к другой. 
Задача построения шкалы фактора разбивается на две подзадачи:
1. Построение дискретной шкалы принимаемых данным фактором значений (построение дискретной шкалы проводится экспертами, либо осуществляется преобразованием непрерывной шкалы принимаемых фактором значений, см.[4]) 
2. Отображение построенной шкалы принимаемых значений факторов на отрезок [0,1]. Отображение строится таким образом, что каждой градации шкалы ставится в соответствие экспертом некоторое число из отрезка [0,1], означающее степень полезности данной градации для рассматриваемого фактора. ”0” – является минимальным значением полезности, “1” – является максимальным значением полезности. 
Для каждого фактора нижнего уровня модели иерархического оценивания строится дискретная шкала с содержательно определенными, упорядоченными и пронумерованными в порядке возрастания предпочтительности градациями. Такие шкалы принято называть порядковыми. На построенной шкале фактора с упорядоченными по предпочтительности градациями экспертом строится три класса полезности градаций (неудовлетворительные, приемлемые и наилучшие.
Для ранжирования заданного в системе множества альтернатив, с точки зрения выполнения цели заданной в иерархической модели, необходимо определить значения на построенных шкалах факторов нижнего уровня иерархии для каждой альтернативы из заданного множества альтернатив.
В предлагаемом методе [5] за счет интеграции модели иерархического оценивания и многокритериального ранжирования каждая альтернатива представляет собой вектор значений на шкалах факторов нижнего уровня иерархической модели. 
Общая схема построения интегрированной модели:
Построение нечеткой целевой иерархической модели в виде ориентированного графа G  без контуров с множеством вершин Z, совпадающим с множеством объектов, и множеством дуг Е. 
Определение шкал факторов нижнего уровня иерархической модели. 
Построение обобщенной шкалы для шкал факторов нижнего уровня иерархической модели.
Анализ и оценивание иерархической модели: т.е. проведение элементарных экспертиз, усреднение экспертных оценок, определение весов дуг в модели по модифицированному методу анализа  иерархий, определение коэффициентов важности факторов всех уровней иерархической модели относительно общей цели с учетом знаков влияния на дугах, анализ достоверности полученных весов.
Для каждой альтернативы из заданного множества альтернатив определение значений на построенных шкалах факторов нижнего уровня иерархии.
Заключение
Построенная интегрированная модель позволяет проводить оценивание заранее заданных альтернативных вариантов решения как с точки зрения оценок альтернатив по критериям, так и с точки зрения заданной в иерархической модели системы целей. Используемые алгоритмы нечеткого оценивания в иерархической модели и при многокритериальном ранжировании позволяют анализировать неопределенность, возникающую в результате экспертного оценивания. Также, в рассматриваемой модели есть возможность согласовывать групповые экспертные оценки в соответствии с заданными весовыми коэффициентами компетентности экспертов. В интегрированной модели альтернативный вариант решения представляется в виде вектора значений факторов нижнего уровня иерархии. Т.к. каждое значение на шкалах факторов нижнего уровня относится к одной из областей (неудовлетворительной, приемлемой или наилучшей), то ЛПР имеет возможность проанализировать принимаемые факторами значения  полезности для каждой альтернативы. Данная модель применима для поддержки принятия решений в слабоструктурированной предметной области с заранее заданным множеством альтернативных вариантов решений. На основе построенной модели создан макет системы поддержки принятия решений, реализующий методы и алгоритмы анализа нечетких иерархических структур, построение шкал для факторов нижнего уровня иерархии, а также многокритериальное ранжирование заданных альтернатив с использованием весов факторов нижнего уровня иерархии и построенных шкал.
Литература
1. Макеев С.П., Шахнов И.Ф. «Упорядочение объектов в иерархических системах», Известия АН СССР, Техническая  кибернетика, 1991, N 3, с. 29 - 46. 
2. А.Н. Аверкин, О.П. Кузнецов, А.А. Кулинич, Н.В Титова «Поддержка принятия решений в слабоструктурированных предметных областях: анализ ситуаций и оценка альтернатив», М.: Теория и системы управления. Известия РАН,  3, 2006,  стр. 139-149.
3. Averkin A., Agrafonova T., Titova N. “Synthesis of distributed fuzzy hierarchical model  in decision support systems  in fuzzy environment”,  EUSFLAT, Ostrava, 2007, Proceedings, с. 428-423.
4. Шахнов И., Яковлев Е. “Построение и использование дискретных шкал при многокритериальном анализе нечетких альтернатив”, Москва, ВЦ РАН, 2007, Моделирование, декомпозиция и оптимизация сложных динамических процессов, стр. 86-110.
5. Аграфонова Т., Титова Н., Использование гибридных моделей представления знаний в СППР., Труды Международной конференции по мягким вычислениям и измерениям  SCM, СПб.: 2006,том 2, с. 113-115.
