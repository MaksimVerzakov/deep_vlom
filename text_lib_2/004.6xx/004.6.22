Благодарности за HP Virtual Server Environment
«Эта книга расскажет профессионалам о компонентах Виртуальной Серверной Среды
и о том, как ими управлять при выполнении ежедневных задач. Она демонстрирует,
как управлять уровнем использования ресурсов в реальном времени и на полную
мощность. Брайен и Дэн вовлечены в создание и разработку большого количества
компонент VSE, и уровень их компетенции позволил им написать эту книгу».
– D’Ann Chorak
Software Engineering Project Manager
«Великолепные краткие обзоры, подробности технологий и детализированные
практические примеры».
– George Williams
iSolution Architect, Hewlett-Packard Co.
«C точки зрения заказчика, почти любой сможет использовать решения и концепции,
описанные в книге HP Virtual Server Environment. Некоторые решения предлагаются
на бесплатной основе, так что есть возможность получить преимущества даром. Независимо от того, какое решение используется, в результате выиграют все (win-win), и
в первую очередь заказчик».
– Alan Hymes
Solution Architect, Hewlett-Packard Co.
«Материал хорошо изложен. Книга адресована администраторам высококритичных систем и архитекторам, которые заинтересованы в создании среды Адаптивной
Инфраструктуры или улучшении уже существующего окружения».
– Rob Lucke
Chief Solutions Officer, Vista Solutions Corp.
«Эта книга подходит для тех, кому нужен краткий высокоуровневый обзор VSE, и для
тех, кто исследует возможности использования технологий VSE в центрах обработки
данных».
– Erik Bostrom
Engineering Program Manager, Hewlett-Packard Co.
«Книга HP VSE представляет почти исчерпывающий курс, посвященный базовым и
общим возможностям программного обеспечения. Даже случайные пользователи,
прочитав эту книгу, почувствуют, что они понимают назначение и общие принципы
использования программ. Это добавит им уверенности в том, что они смогут интегрировать эти возможности в свое серверное окружение».
– Dave Butenof
Instant Capacity and PPU Software Architect, Hewlett-Packard Co.
The HP Virtual Server Environment
Making the Adaptive Enterprise Vision
a Reality in Your Datacenter
Dan Herington and Bryan Jacquot
www.hp.com/hpbooks
Prentice Hall Professional Technical Reference
Upper Saddle River, NJ • Boston• Indianapolis • San Francisco
New York • Toronto • Montreal • London • Munich • Paris • Madrid
Capetown • Sydney • Tokyo • Singapore • Mexico City
Виртуальная Серверная Среда HP
Сделайте Адаптивную Инфраструктуру
реальностью в Вашем центре обработки
данных
Дэн Эрингтон и Брайен Джаккуот
Перевод с английского Г. Прилипко
под редакцией М. Мосейкина
www.hp.com/hpbooks
Prentice Hall Professional Technical Reference
Upper Saddle River, NJ • Boston• Indianapolis • San Francisco
New York • Toronto • Montreal • London • Munich • Paris • Madrid
Capetown • Sydney • Tokyo • Singapore • Mexico City
УДК 004.6
ББК 32.973�018.2
Э77
Эрингтон Д.
Э77
Виртуальная Серверная Среда HP : сделайте адаптив. инфра�
структуру реальностью в вашем центре обработки данных : [учеб.
пособие] / Дэн Эрингтон и Брайен Джаккуот ; под ред. М. Мосей�
кина ; пер. с англ. Г. Прилипко. � М. : ИНТУИТ.РУ, 2007. � 518 с. :
ил., табл.
Книга описывает каждую из технологий Виртуальной Серверной Среды HP (VSE),
включая решения по разбиению систем на разделы, набор Utility Pricing решений, набор
продуктов обеспечения высокой готовности, полный набор инструментов управления и
единственные в индустрии продукты для управления приложениями на основании
определенных целей. Эта книга служит картой�гидом при развертывании эффективной и
гибкой компьютерной инфраструктуры с помощью HP VSE.
Книга рассчитана на разработчиков решений, архитекторов и инженеров, которые
обсуждают развертывание технологий VSE, а также на менеджеров проекта, инженеров и
администраторов, которые связаны с работой по осуществлению одной или нескольких
технологий VSE.
ISBN 978�5�9556�0103�8 (ИНТУИТ.РУ)
ISBN 0�13�185522�0 (англ.)
УДК 004.6
ББК 32.973�018.2
All rights reserved. No part of this book may be reproduced or transmitted in any form or by any
means, electronic or mechanical, including photocopying, recording or by any information storage
retrieval system, without permission from Pearson Education, Inc. RUSSIAN language edition pub�
lished by INTUIT.ru. Copyright © 2007.
Все права защищены. Никакая часть этой книги не может быть воспроизведена в любой
форме и любыми средствами, электронными или механическими, включая
фотографирование, магнитную запись или иные средства копирования или сохранения
информации без письменного разрешения издательства Pearson Education, Inc.
Перевод на русский язык издается
Интернет�Университетом Информационных Технологий и издательством «ЭКОМ».
© Pearson Education, Inc.,
ISBN 978�5�9556�0103�8 (ИНТУИТ.РУ)
ISBN 0�13�185522�0 (англ.)
Publishing as Prentice Hall Professional
Technical Reference Upper Saddle River,
New Jersy 07458, 2006
© Перевод на русский язык, оформление.
Издательство «ЭКОМ»,
Интернет�Университет
Информационных Технологий, 2007
Дэн — Моей прекрасной жене Таре,
которая всегда самоотверженно делает все,
что необходимо сделать.
Я не смог бы сделать это без нее.
И моим удивительным детям Либби и Мэту,
которые наполняют меня гордостью
и поднимают мне настроение.
Брайен — Моей прекрасной жене Кэйле,
которая обеспечивает безоговорочную
и решительную поддержку и ободрение.
Моим замечательным детям:
Тайлу, Микаэлю, Элизе и Лукасу,
которые доставляют мне непрерывную
радость и восхищение.
Много обозначений, используемых производителями и продавцами для того, чтобы
отличить их продукты, являются торговыми марками (trademarks). Там, где они появляются
в этой книге и издатель знал о зарегистрированной торговой марке, обозначения были
напечатаны с заглавной буквы или большими буквами.
Авторы и издатель тщательно готовили эту книгу, но не дают никакой явно выраженной
или подразумеваемой гарантии и не несут ответственности за ошибки или упущения.
Автоты также не несут никакой ответственности за непредвиденные убытки, которые
связаны с использованием информации или программ, содержащихся в книге, или
проистекают из их примения.
Издатель предлагает значительные скидки на эту книгу при оптовых покупках или
специальных продажах, которые могут включать электронные версии и/или обложки
заказчика и содержимое, специфичное для Вашего бизнеса, целей обучения,
фокусирование на маркетинге и продвижении торговой марки. Для дополнительной
информации, пожалуйста, обращайтесь:
U. S. Corporate and Government Sales
(800) 382-3419
corpsales@pearsontechgroup.com
For sales outside the U. S., please contact:
International Sales
international@pearsoned.com
Visit us on the Web: www.phptr.com
Library of Congress catalog number:
Copyright © 2006 Hewlett-Packard Development Company, L.P.
All rights reserved. Printed in the United States of America. This publication is protected by
copyright, and permission must be obtained from the publisher prior to any prohibited reproduction, storage in a retrieval system, or transmission in any form or by any means, electronic,
mechanical, photocopying, recording, or likewise. For information regarding permissions,
write to:
Pearson Education, Inc.
Rights and Contracts Department
One Lake Street
Upper Saddle River, NJ 07458
ISBN 0-13-185522-0
Text printed in the United States on recycled paper at R.R. Donnelley & Sons, Inc.,
Crawfordsville, IN.
First printing, August, 2005
Оглавление
vii
Оглавление
Предисловие		 xiii
Благодарности	 xv
Об авторах		 xvi
Глава 1	
Взгляд на виртуальную серверную среду HP 	
1
Обзор главы	 
          Широкое распространение систем с избыточными ресурсами	 
                                                           Обзор виртуальной серверной среды HP	 
                                                                                         Поддержка операционных систем в HP VSE	 
                                                                                                                     Продукты, график выхода и наименования	 
                                                                                                                                                      Резюме	 
Глава 2 	
1
1
6
10
10
11
Спектр решений НР для разбиения на разделы	 12
Взгляд на спектр решений HP для разбиения на разделы
(Partitioning Continuum)	
nPartition (электрически изолированные аппаратные разделы)	
Виртуальные разделы (виртуализация с максимальной
производительностью)	
HP Integrity Virtual Machines (полностью виртуализированное
разбиение на разделы)	
Безопасные разделы ресурсов (разбиение на разделы
внутри одной копии HP-UX)	
Резюме	
Глава 3	
12
18
27
32
38
47
Сделайте больше с решениями для разбиения на разделы 	 48
Обзор главы	
Выбор решения для разбиения на разделы	
Комбинирование решений разбиения на разделы	
Поддержка nPar независимыми производителями программного
обеспечения (ISV)	
Резюме	
48
48
65
67
69
viii
Виртуальная серверная среда HP
Глава 4	
70
Обзор главы	 
          Краткое описание HP nPartition сервера	 
                                Данные, поддерживаемые Процессором Управления	 
                                                                         Парадигмы управления nPartition	 
                                                                                            Примерный сценарий nPartition управления	 
                                                                                                                       Резюме	 
Глава 5	
nPartition-серверы	 70
                          70
                         74
                        77
                       85
                      97
Виртуальные разделы HP	 98
Обзор главы	
Краткий обзор виртуальных разделов	
Терминология Виртуальных Разделов	
Примерный сценарий создания Виртуальных Разделов	
Резюме	
Глава 6	
Integrity Виртуальные машины	
Обзор главы	
Терминология Integrity Виртуальных Машин	
Обзор виртуальных машин Integrity	
Примерный сценарий использования Integrity
виртуальных машин	
Резюме	
Глава 7	
Безопасные ресурсные разделы	
Обзор главы	
Обзор безопасных ресурсных разделов	
Терминология безопасных ресурсных разделов	
Пример сценария безопасных ресурсных разделов	
Резюме	
Глава 8	
Обзор Utility Pricing решений HP	
Utility pricing решения 	
CPU Instant Capacity	
CPU Temporary Instant Capacity	
Instant Capacity ячейки	
Pay Per Use подсчет использования ресурсов	
Резюме	
98
99
101
102
127
128
128
129
131
138
148
151
151
152
154
156
180
182
182
185
190
192
193
197
Оглавление
Глава 9	
Сделайте больше с помощью Utility Pricing решений	
Обзор главы	
Instant Capacity	
Temporary Instant Capacity	
Pay Per Use (PPU)	
Рекомендации для ISV	
Изменение размера nPar при использовании
Utility Pricing решений	
Резюме	
Глава 10	
	
Решение по моментальному активированию
ресурсов — Instant Capacity (ICAP)	
Обзор главы	
Обзор Instant Capacity	
Терминология Instant Capacity	
Пример сценария Instant Capacity	
Резюме	
Глава 11	
	
Временно активируемые ресурсы — Temporary
Instant Capacity	
Обзор главы	
Обзор Temporary Instant Capacity	
Терминология Temporary Instant Capacity	
Пример сценария Temporary Instant Capacity 	
Резюме	
Глава 12	
Оплата по мере использования – Pay Per Use	
Обзор главы	
Обзор Pay Per Use	
Пример сценария Pay Per Use 	
Резюме	
ix
198
198
199
205
209
211
212
213
214
214
214
218
219
235
236
236
237
238
238
248
249
249
249
250
256

Виртуальная серверная среда HP
Глава 13	
	
	
Обзор инструментов управления виртуальной
серверной средой и инструментов для обеспечения
высокой доступности	
Обзор главы	
Задачи отображения состояния и конфигурации элементов VSE	
HP-UX Workload Manager	
Высокая готовность и HP Serviceguard	
Global Workload Manager	
Capacity Advisor	
Резюме	
Глава 14	
	
Workload Manager	
Обзор главы	
Обзор архитектуры Workload Manager	
Терминология Workload Manager	
Сценарий использования Workload Manager
и виртуальных разделов	
Сценарий работы Workload Manager и Serviceguard	
Резюме	
Глава 16	
258
260
270
281
293
299
305
Сделайте больше с инструментами управления виртуальной
серверной средой и инструментами высокой готовности	
307
Обзор главы	
Integrity Essentials Virtualization Manager	
Workload Manager	
Serviceguard	
Планирование мощности с помощью Capacity Advisor	
Резюме	
Глава 15	
258
Serviceguard	
Обзор главы	
Терминология Serviceguard	
Обзор Serviceguard	
Примерный сценарий Serviceguard	
Резюме	
307
307
311
318
324
326
327
327
328
332
333
357
370
371
371
372
373
377
407
Оглавление
Глава 17	
Virtualization Manager	
Обзор главы	
Терминология Virtualization Manager	
Обзор Virtualization Manager	
Тур по Virtualization Manager	
Резюме	
Глава 18	
Capacity Advisor	
Обзор главы	
Обзор Capacity Advisor	
Аргументы в пользу планирования ресурсов	
Сценарий работы с Capacity Advisor	
Резюме	
Глава 19	
Global Workload Manager	
Обзор главы	
Терминология Global Workload Manager	
Обзор Global Workload Manager	
Сценарий работы Global Workload Manager	
Резюме	
Приложение A	 Справочная информация	
nPartition-серверы 	
Виртуальные разделы	
Integrity Виртуальные машины	
Безопасные ресурсные разделы	
Решение по моментальному активированию ресурсов –
Instant Capacity (ICAP)	
Временно активируемые ресурсы – Temporary Instant Capacity	
Оплата по мере использования – Pay Per Use	
Workload Manager	
Serviceguard	
Virtualization Manager	
Capacity Advisor	
Global Workload Manager	
xi
409
409
410
411
413
426
428
428
429
430
432
449
450
450
451
452
457
483
484
484
484
485
485
485
485
486
486
486
486
486
487
xii
Виртуальная серверная среда HP
Приложение B	 Версии продуктов	
488
Глава 4. nPartition-серверы	 
            Глава 5. Виртуальные разделы HP	 
                                   Глава 6. Integrity Виртуальные машины	 
                                                         Глава 7. Безопасные ресурсные разделы 	 
                                                                                        Глава 10. Решение по моментальному активированию 
                                                                                                                                ресурсов – Instant Capacity (ICAP)	 
                                                                                                                                          Глава 11. Временно активируемые ресурсы – 
                                                                                                                                                                            Temporary Instant Capacity	 
                                                                                                                                                                            Глава 12. Оплата по мере использования – Pay Per Use	 
                                                                                                                                                                                                            Глава 15. Workload Manager	 
                                                                                                                                                                                                                 Глава 16. Serviceguard	 
                                                                                                                                                                                                                      Глава 17. Virtualization Manager	 
                                                                                                                                                                                                                           Глава 18. Capacity Advisor	 
                                                                                                                                                                                                                                Глава 19. Global Workload Manager	 
488
488
489
489
490
490
490
491
491
491
491
Приложение C Перечень использованных в примерах команд	 492
Глава 4. nPartition-серверы	 492
            Глава 5. Виртуальные разделы HP	 493
                                   Глава 6. Integrity Виртуальные машины	 494
                                                         Глава 7. Безопасные ресурсные разделы	 495
                                                                                        Глава 10. Решение по моментальному активированию 
                                                                                                                                ресурсов – Instant Capacity (ICAP)	 
                                                                                                                                          Глава 11. Временно активируемые ресурсы – 
                                                                                                                                                                            Temporary Instant Capacity	 
                                                                                                                                                                            Глава 12. Оплата по мере использования – Pay Per Use	 
                                                                                                                                                                                                            Глава 15. Workload Manager	 
                                                                                                                                                                                                                 Глава 16. Serviceguard	 
                                                                                                                                                                                                                      Глава 17. Virtualization Manager	 
                                                                                                                                                                                                                           Глава 18. Capacity Advisor	 
                                                                                                                                                                                                                                Глава 19. Global Workload Manager	 
489
496
496
496
497
498
500
500
500
Предисловие
О чем рассказывается в этой книге
Эта книга описывает каждую из технологий Виртуальной Серверной Среды HP (VSE),
включая решения по разбиению систем на разделы, набор Utility Pricing решений, набор
продуктов обеспечения высокой готовности, полный набор инструментов управления
и единственные в индустрии продукты для управления приложениями на основании
определенных целей. Эта книга служит картой-гидом при развертывании эффективной
и гибкой компьютерной инфраструктуры с помощью HP VSE.
Разные технологии HP VSE поддерживаются на HP-UX, Linux, OpenVMS и Windows
Microsoft. Например, HP nPartition поддерживают все четыре системы, продукты HP
Serviceguard поддерживаются на операционных системах HP-UX и Linux, а HP Global
Workload Manager поддерживается на HP-UX, Linux и OpenVMS. Технология Pay Per Use
поддерживает HP-UX и Windows. Эта книга охватывает полный набор возможностей HP
VSE для каждой операционной системы, поддерживаемой VSE-технологиями, и отмечает,
как операционные системы поддерживаются каждой технологией.
На кого рассчитана эта книга
Эта книга предназначена для двух аудиторий. Первая — разработчики решений, архитекторы или инженеры, которые обсуждают развертывание технологий VSE, и вторая
— менеджеры проекта, инженеры и администраторы, которые связаны с работой по осуществлению одной или нескольких технологий VSE.
Если вы — архитектор, изучающий информацию о том, как разработать решение,
использующее VSE, вы получите хороший обзор VSE-технологий в первых двух главах
каждой части книги. Вы можете перейти к следующим за ними главам, детально описывающим эти продукты, которые, возможно, соответствуют вашим требованиям.
Если вы — администратор, то вы, возможно, уже знаете, о каких продуктах вам нужна
дополнительная информация, так что вы сможете сразу перейти к главам, которые рассказывают о конкретных продуктах и обеспечат Вас руководством и примерами их использования для решения реальных проблем.
Эта книга написана в предположении, что читатель уже имеет базовое понимание
архитектуры систем и администрирования систем. Знание основных понятий в области
виртуализации было бы полезным, но не является обязательным.
Читателям этой книги поможет общее понимание того, как администрируются операционные системы HP-UX, Linux и Windows. Книга сосредотачивается на технологиях VSE
и не пытается обратиться к технологиям операционных систем и методам системного
администрирования.
xiv
Виртуальная серверная среда HP
Как составлена эта книга
Эта книга состоит из вводной главы и разделена на три части. В главе 1 обеспечивается
краткий обзор VSE на верхнем уровне, который может быть использован в качестве руководства по другим частям книги для получения подробной информации. Части 1-3
описывают различные решения, доступные в Виртуальной Серверной Среде в области
разбиения на разделы (Partitioning), Utility Pricing и управления соответственно. Каждая
часть книги содержит три типа глав, включая:
•	 Обзорную главу — первая глава каждой части (главы 2, 8 и 13) охватывает каждое
из VSE-решений с большим количеством деталей. Эти главы в основном фокусируются на описании ключевых возможностей каждого решения и того, что может
быть сделано с их помощью.
•	 Главу «Сделай больше» — каждая часть содержит главу, которая рассказывает о возможностях каждого решения, и помогает вам понять, на что вы должны обратить
особое внимание. Они предоставляют «лакомые кусочки» (sweet spots), подсказки
и хитрости решений, описанных в этой части книги. Это главы 3, 9 и 14.
•	 Главы с продуктами/решениями — каждый продукт или решение имеет посвященную ему главу. Каждая из этих глав начинается с введения в технологию и описания
основной терминологии. Дальше рассматривается архитектура продукта, описывающая пример сценария. Сценарий используется для того, чтобы провести читателя
через процесс внедрения решения. Эти сценарии обеспечивают понимание каждой
технологии, не погружаясь в нюансы и особенности продукта.
В конце книги есть три приложения. Приложение A обеспечивает детальный список ссылок, к которым можно обратиться для получения дополнительной информации
о каждом продукте или решении, описанном в этой книге. Наиболее важны руководства пользователя каждого продукта, которые могут служить справочником для каждой
технологии VSE. В приложении B перечисляются версии программного обеспечения и
firmware, которые используются в примерных сценариях в главах, посвященных продуктам/решениям. И наконец, приложение C обеспечивает список команд продуктов VSE
вместе со ссылкой на страницу справочника и полным путем (path) к каждой команде.
Что охватывает эта книга
Эта книга не предназначалась для того, чтобы служить справочником по продуктам.
Сейчас в Виртуальную Серверную Среду входит 14 продуктов, и собрать вместе даже
краткие ссылки на все эти технологии в одной книге нереально. Цель этой книги состоит
в том, чтобы сделать полный обзор технологий, дать вам возможность определить, какие
технологии лучше подходят для вашей ИТ-инфраструктуры и обеспечить достаточной
информацией для того чтобы, оценить, что можно использовать в вашей работе. В этой
книге достаточно информации для менеджера проекта, чтобы составить план проекта и
иметь высокий уровень уверенности в оценке необходимой работы для создания стратегии адаптивной инфраструктуры (Adaptive Infrastructure) с помощью VSE. В главах,
посвященных продуктам, достаточно деталей для того, чтобы помочь менеджерам или
системным администратором узнать, какие команды и утилиты доступны для каждого
продукта, так чтобы вы знали, где искать дополнительную информацию.
Благодарности
Число людей, которые предоставили материалы для этой книги, очень велико для того,
чтобы их всех упомянуть. В частности, исходные материалы для многих рисунков в этой
книге были обеспечены различными экспертами по конкретным вопросам:
•	 Richard Stormo и Tim Jacobson обеспечили много подробностей того, как ИТ-организация HP использует преимущества VSE- технологии, и подобрали реальные данные
о нагрузке для некоторых графиков, приведенных в этой книге.
•	 Stuart Haden, Mark Shaw и Greg Huff обеспечили и понимание, и детальные архитектурные диаграммы для серверов HP Superdome.
•	 Bob Sauers предоставил обширную информацию и диаграммы о наборе продуктов
HP Serviceguard.
•	 Steve Gonzalez предоставил очень полезную информацию и диаграммы, описывающие, как некоторые заказчики HP получают преимущество от использования VSEтехнологий.
•	 Steve Cooke, Ute Albert и Vicki Martel предоставили богатую маркетинговую VSEинформацию на ранних стадиях процесса написания книги и обзора. Это помогло
книге опереться на твердую почву.
Было также большое число рецензентов, как и должно было быть с книгой, охватывающей так много тем. В особенности мы хотели бы поблагодарить людей, которые
рассмотрели всю книгу в целом. Это требует огромных усилий, и мы им за это очень
признательны. Это Paco Romero, Jim Darling и Rob Lucke.
Много людей просмотрели эту книгу. Их специальные знания продукта очень ценны.
Хотелось бы особо отметить следующих рецензентов: Erik Bostrom, Dave Butenhof, D'Ann
Chorak, Edgar Circenis, Mark Coffey, Bob Cohen, Steve Cooke, Jerry Harrow, Alan Hymes,
Barry Lyden, Dave Parker, Scott Rhine, Wade Satterfield, Mark Shaw, Eric Soderberg, Steve
Stichler и George Williams.
Об авторах
Дэн Эрингтон (Dan Herington) — Главный Архитектор HP Virtual Server Environment
Advanced Technology Center. ATC — группа лабораторий HP, задача которых — гарантировать успех заказчиков в развертывании решений, основанных на технологиях VSE. За
прошедшие четыре года он был архитектором в лаборатории, работающей с лидирующим в индустрии продуктом HP Workload Manager и VSE Management продуктами. Он
был также ответственным за взаимодействие по техническим вопросам между заказчиками и службой поддержки продуктов HP для разделения на разделы, по utility pricing и
workload management продуктам. Эта двойная ответственность предоставила ему уникальную возможность получать техническую информацию и от службы поддержки HP,
и от заказчиков, и быть уверенным в том, что будущие версии продуктов удовлетворят
требованиям заказчиков, использующих эти продукты. Он провел сотни семинаров по
HP VSE технологиям во время посещения заказчиков, обучения службы поддержки HP
заказчиков и выставок во всем мире. Недавно он был ключевым докладчиком при определении видения следующего поколения VSE и его управляющих инструментов, включая
ряд новых продуктов, охватываемых этой книгой. Эта роль включает работу с проектными командами, которые отвечают за разработку индивидуальных продуктов для того,
чтобы гарантировать, что они составляют хорошо интегрированное решение, и удостовериться, что пользователи могут легко реализовать с помощью этих продуктов свое
видение адаптивной инфраструктуры.
Перед возвращением в HP в 2000 году Дэн занимал главные технические и управляющие позиции в крупном системном интеграторе и start-up компании по разработке программного обеспечения. Дэн начал свою карьеру в HP в Купертиино, штат Калифорния,
где он занимал различные технические должности в проекте OpenView. Он был вовлечен в перенос этого проекта из Купертино в Форт Коллинз, штат Колорадо, а позднее
переехал в Гренобль, (Франция), где он в начале 1990-х годов помогал развивать проект
OpenView в Европе.
Брайен Джаккуот (Bryan Jacquot) — архитектор программного обеспечения в HP Virtual
Server Environment Advanced Technology Center. Брайен работал и разработчиком, и архитектором программного обеспечения приложений для системного администрирования
предприятия более шести лет. Он разрабатывал первый графический пользовательский
интерфейс для управления серверами HP Superdome — Partition Manager. Кроме того,
Брайен разрабатывал первый в HP-UX основанный на web интерфейс системного администрирования, который используется для настройки ядра HP-UX — kcweb. Сейчас
он работает техническим архитектором программного обеспечения нового поколения
системных управляющих инструментов для HP VSE. Кроме того, он работает в тесном
сотрудничестве с заказчиками для сбора требований, а также подготовки презентаций
и тренингов по HP VSE. Брайен имеет степень бакалавра по Computer Science в Montana
State University — Bozeman. Кроме того, он является HP Certified IT Professional, Microsoft
Certified System Administrator и RedHat Certified Technician.
1
Взгляд на виртуальную
серверную среду HP
Обзор главы
Добро пожаловать в HP Virtual Server Environment! Адаптивное предприятие (Adaptive
Enterprise Vision) может стать реальностью в вашем центре обработки данных. Решение
HP Virtual Server Environment (HP VSE) – виртуальная серверная среда - включает в себя
набор продуктов, которые разработаны и собраны вместе для того, чтобы обеспечить
пользователям возможность получить максимальную отдачу от серверов семейств HP
9000 и Integrity. Большая отдача - это более высокий уровень использования ресурсов,
повышенная эффективность, большая доступность и управляемость.
В этой главе дается краткий обзор содержания книги. Авторы уделяют основное внимание целям VSE, входящим в эту среду продуктам и решениям, а также механизмам их
интеграции. Но самое важное - читателям здесь предлагается некоторое руководство, как
лучше воспользоваться преимуществами VSE.
Широкое распространение систем с
избыточными ресурсами
Ключевая проблема, ради которой разрабатывалась VSE, связана с широким распространением систем, ресурсы которых избыточны для запущенных на них приложений. Даже
сегодня большинство заказчиков допускает среднюю утилизацию систем в диапазоне от
25 до 30%, и это на 64-разрядных серверах HP высшего класса. В 32-разрядных средах
Windows и Linux часто используется и менее 10% ресурсов. На рис. 1.1 показан пример
средней утилизации большого количества серверов в центре обработки данных.
Прим. переводчика: приступая к чтению книги, полезно еще раз просмотреть предисловие. Это
поможет лучше понять некоторые особенности организации материала и сделает работу с книгой
более эффективной.

Виртуальная серверная среда HP
Рис. 1.1. Средняя утилизация серверов в большом центре обработки данных
На этом рисунке видно, что вычислительные ресурсы многих серверов избыточны. В
то же время некоторые серверы (обычно более старые) больше не способны справляться
с возложенной на них нагрузкой. В данном случае предоставляется хорошая возможность
для консолидации приложений. Она заключается в перемещении ряда задач, работающих
на серверах, которые изображены на рисунке слева и справа, на более мощные серверы,
чтобы неиспользованная вычислительная мощность (на рисунке слева) могла быть выделена для других приложений (на рисунке справа). Это позволяет получить целый ряд
значительных преимуществ, в том числе:
•	 высокую степень утилизации ресурсов - комбинированные нагрузки могут поднять
уровень использования новых разделяемых серверов;
•	 более низкую стоимость владения - поскольку становится возможным приобретать
и обслуживать меньшее число систем;
•	 лучшую производительность – приложения (справа) будут демонстрировать более
высокую производительность, поскольку им будет доступно больше ресурсов.
Дело в том, что даже простая консолидация приложений, изображенных на рисунке
слева, обеспечивает целый ряд преимуществ. Основной проблемой остается избыточность многих систем. Это приводит к увеличению стоимости управления большим количеством серверов, чьи возможности используются не в полной мере. Давайте проведем
небольшое исследование и выясним, почему столь низок уровень использования ресурсов в большинстве центров обработки данных и что с этим можно сделать.
Почему ресурсы часто используются нерационально?
Избыточность ресурсов продолжает считаться нормой по многим причинам.
•	 Стремление выделить свой сервер для каждого типа нагрузки. Довольно часто возникает необходимость запускать некоторые приложения на отдельном сервере.
Например, операционное окружение должно быть специально настроено под конкретное приложение, или требуется гарантировать, что не будет других приложений,
которые будут бороться с ним за ресурсы.
•	 Бизнес-подразделения (Business Units - BU) «монопольно» владеют серверами. Бизнес-подразделения компании выдвигают требования к серверу, вместе с ИТ-служГлава 1 Взгляд на виртуальную серверную среду HP

бами выбирают сервер и оплачивают его стоимость. Затем ИТ-службы приобретают
его и разворачивают на нем приложение. Поскольку сервер уже оплачен, бизнесподразделения не заинтересованы выделять свои ресурсы приложениям других
подразделений даже в том случае, если большая часть ресурсов не используется.
•	 Часто планирование мощности – это задачка на сообразительность. Если приложение развернуто на новом сервере впервые, у администраторов еще очень мало
информации о предполагаемой загрузке, необходимых ресурсах или требованиях к
производительности. Это приводит к тому, что часто устанавливаются завышенные
требования к запрашиваемым ресурсам.
•	 Плата за ошибки в планировании и недооценку необходимых ресурсов достаточно
высока. Одна из причин завышения предварительной оценки обычно заключается
в том, что при недооценке потребности в ресурсах потребуется еще одна модернизация. Придется покупать еще больший сервер и инициировать еще одну миграцию приложения с ранее купленного сервера. Потребуется не только заплатить
за новый сервер, нужно будет еще раз потратить некоторое время на миграцию
и тестирование приложения. Из-за такой недооценки может произойти снижение
уровня доверия к Вашим будущим рекомендациям по планированию вычислительной мощности.
Таким образом, сочетание этих проблем является решающим фактором в распространении систем, предназначенных только для одного приложения. В реальности, если на
системе запущено только одно приложение, вы не можете достигнуть уровня использования ресурсов более 50% без риска возникновения проблем с производительностью в
те моменты, когда оно наиболее активно. На рис. 1.2 показан пример сведений об использовании ресурсов реальным приложением.
Здесь мы видим, что существует много кратковременных пиков загрузки, но только
часть из них достаточно высока, но и они непродолжительны. Если вы рассчитываете
Рис. 1.2. Профиль требований реальной нагрузки

Виртуальная серверная среда HP
количество ресурсов системы, необходимых для этого приложения, следует ориентироваться на пиковую производительность, предусмотрев также и некоторый запас под
рост в течение жизни системы. Конечный результат будет таким: каждый день, за исключением одного или двух часов, система будет использоваться неэффективно и средняя
загрузка будет составлять около трети мощности системы.
Консолидация позволит повысить уровень использования ресурсов
Поскольку у каждой задачи есть свои пики использования ресурсов, необходимо гарантировать, что их будет достаточно для любого уровня нагрузки. Утилизация ресурсов
снижается, поскольку пики обычно высоки и кратковременны. Способ ее повышения
заключается в предоставлении возможности использования ресурсов, избыточных для
одних задач, другими приложениями.
Некоторые исследования показывают, что запуск нагрузок в консолидированных средах снижает потребность в процессорных ресурсах приблизительно до 40% без потери
производительности. Причина в том, что пики требований к ресурсам разных приложений обычно непродолжительны и не происходят одновременно.
Есть несколько технических и организационных барьеров на пути к успеху традиционной консолидации (запуска нескольких приложений на одном экземпляре операционной
системы). Технические барьеры таковы:
•	 коллизии пространства имен файловой системы – разные приложения пытаются
читать или писать в одни и те же файлы;
•	 коллизии сетевых портов – различные приложения пытаются использовать одни и
те же сетевые порты;
•	 коллизии коммуникаций между процессами системы (IPC) - различные приложения
или экземпляры одного и того же приложения пытаются получить доступ к одним и
тем же сегментам разделяемой памяти, очередям сообщений, именованным каналам
и т. д.;
•	 несовместимые настройки параметров ядра или наборы патчей – каждое приложение может требовать специальных настроек или патчей, несовместимых с теми,
которые необходимы для других приложений.
Хотя перечисленные технические барьеры и могут сделать консолидацию некоторых
приложений на одной операционной системе невозможной, на самом деле они довольно
редки. Гораздо чаще встречаются организационные барьеры. Вот некоторые из них:
•	 Очень сложно скоординировать перезагрузку систем. Если приложения используются разными группами пользователей, разделяющими сервер, очень трудно осуществлять координацию между ними в ситуации, когда необходима перезагрузка
системы для решения проблемы, связанной только с одним из приложений.
•	 В результате отказа нарушается работа сразу нескольких приложений.
•	 Поддерживать несколько программных продуктов может оказаться сложнее. Даже
если приложения могут прекрасно работать под одной операционной системой,
независимые разработчики программного обеспечения (ISV) часто не поддержи
Прим. ред.: patch – «заплатка», программный пакет для обновления ПО, как правило, с целью
исправления имеющихся ошибок.
Глава 1 Взгляд на виртуальную серверную среду HP

вают работу своих приложений с рядом других программных пакетов, а значит, их
невозможно будет использовать совместно при промышленной эксплуатации.
•	 Осторожность пользователей. Многие пользователи, естественно, недовольны тем,
что их задачи запускаются в среде, где есть еще одно или несколько приложений,
которыми они не владеют и которых не понимают. Обычно подобная настороженность проявляется после того, как другое приложение повлияло на работу их задачи
– тогда пользователи будут просить администратора поместить их прикладную систему в изолированную среду (на другой сервер).
Таким образом, необходима возможность запуска приложений на одной системе, так,
чтобы они могли разделять ресурсы и в то же время были изолированы друг от друга.
Вот для чего нам нужна виртуализация.
Виртуализация облегчает консолидацию
Ключевым компонентом концепции адаптивного предприятия является виртуализация
информационной инфраструктуры, в которой работают приложения. Это позволяет переназначать неиспользуемые ресурсы одной виртуальной среды приложениям другой
среды, которым они необходимы. С помощью виртуализации это можно сделать незаметно для пользователей приложения и даже для самого приложения.
Для чего нужна виртуальная серверная среда (VSE)
На сегодня существует два способа повышения уровня использования имеющихся ресурсов. Первый подразумевает консолидацию приложений на сервере, чтобы предоставить
ресурсы, не задействованные одним приложением, для использования другим. Второй
заключается в обеспечении наличия в системе запаса ресурсов, которые оплачиваются
только тогда, когда используются, и отключены до тех пор, пока не понадобятся. Виртуальная серверная среда (VSE) позволяет применять оба способа.
Современная консолидация сильно отличается от той, которая была даже пять лет
назад. Сейчас разработан целый ряд вариантов разбиения систем на разделы, что позволяет изолировать приложения друг от друга и при этом разделять ресурсы между ними.
Однако одного только разбиения на разделы недостаточно - необходимо динамическое
перераспределение ресурсов. Что толку в том, что мы разбили комплекс на четыре процессорных раздела, если нельзя гибко распределять ресурсы между ними? VSE предоставляет четыре разных способа разбиения на разделы, и это позволяет запустить несколько
приложений на каждом сервере так, что свободные ресурсы могут быть переданы активному приложению, которое может их использовать. Они обеспечивают различный
уровень аппаратной и программной изоляции, так что приложения не могут повлиять
на работу друг друга, даже если они запущены на одной системе.
Существует также несколько решений Utility Pricing, позволяющих платить за ресурсы
только тогда, когда они используются. Это позволяет обеспечить систему достаточными
ресурсами для соответствия ожидаемым пиковым нагрузкам, при этом часть из них
будет установлена, но неактивна. Вы можете получить систему с более высоким уровнем
утилизации и при этом точно знать, что во время пика загрузки у вас под рукой будет
достаточно ресурсов.

Виртуальная серверная среда HP
Наконец, в VSE предусмотрен ряд инструментов управления, которые обеспечивают
простой конфигурационный интерфейс, возможность автоматического выделения ресурсов и средства для поддержки высокой готовности. Это значительно облегчает использование наиболее эффективных возможностей VSE.
Обзор виртуальной серверной среды HP
Существует три основных группы решений VSE:
•	 Решения VSE для разбиения на разделы – в виртуальной серверной среде предусмотрено несколько различных типов разбиения на разделы.
•	 Utility Pricing решения VSE - решения, которые позволяют заказчикам получить
достаточное количество системных ресурсов для пиковых загрузок, но платить за
них только тогда, когда они используются.
•	 Управляющие инструменты VSE и инструменты для обеспечения высокой готовности. Они включают решения по управлению нагрузками, конфигурированию,
планированию вычислительной мощности, обеспечению высокой готовности и устойчивости к сбоям.
В книге описаны все эти группы решений. Давайте теперь рассмотрим, какие инструменты включены в каждую из них.
VSE-решения для разбиения на разделы
Разбиение на разделы позволяет запустить несколько приложений на одной системе и
изолировать их, «виртуализировав» ресурсы таким образом, чтобы они не могли повлиять друг на друга. Еще одно важное преимущество – более тщательный контроль при
выделении ресурсов приложениям.
На рис. 1.3 показаны предусмотренные в VSE четыре решения для разбиения на разделы:
•	 nPartition (nPar) - полностью изолированные аппаратные разделы. Одно из их преимуществ заключается в том, что аппаратные отказы «локализуются» в тех разделах,
где они произошли. Кроме того, можно выполнять техобслуживание одного из разделов, в то время как другие разделы продолжают работать.
•	 Виртуальные разделы (vPar) позволяют запустить несколько экземпляров операционной системы HP-UX на одном сервере или аппаратном разделе. Это позволяет
обеспечить лучшее разделение ресурсов системы, чем в случае nPar, в дополнение
к этому они могут перераспределяться между работающими виртуальными разделами. Продукт vPar доступен как на HP 9000, так и на Integrity, и обеспечивает
указанную функциональность путем назначения определенных аппаратных компонентов каждому разделу.
•	 Integrity Virtual Machines (VM) — виртуальные машины Integrity похожи на vPar тем,
что можно запустить несколько независимых экземпляров операционных систем на
одной системе или nPar. Integrity Virtual Machines обеспечивают полную виртуалиГлава 1 Взгляд на виртуальную серверную среду HP

Рис. 1.3. Спектр решений разбиения на разделы для платформ HP 9000 и Integrity
зацию оборудования, что позволяет иметь разделы с делением на уровне доли процессора (sub-CPU), и они могут разделять физические карты ввода/вывода между
разными экземплярами операционных систем. Кроме того, виртуальные машины
могут перемещаться из одной системы в другую совершенно незаметно для приложений, запущенных внутри них.
•	 Безопасные разделы ресурсов: они позволяют запустить несколько нагрузок в одном
экземпляре операционной системы и изолировать их друг от друга. Изоляция относится и к ресурсам, и к коммуникациям. Хотя они и работают на одной копии
HP-UX, каждый раздел получает собственный сетевой интерфейс, процессорные
ресурсы и ресурсы памяти.
На рис. 1.3 показано, что эти решения возможно использовать вместе, одно над другим. Можно запустить vPar, Integrity VM или Secure Resource Partitions (SRP) внутри
nPartition; можно запустить SRP внутри vPar или Integrity VM. Многие заказчики обнаружили, что одновременное применение нескольких типов разделов на одном сервере
обеспечивает хороший уровень изоляции и гибкость при совместном использовании
ресурсов.
Все эти решения для разбиения на разделы подробно описаны в первой части книги.

Виртуальная серверная среда HP
VSE Utility Pricing
Решения HP Utility Pricing для HP 9000- и Integrity-серверов позволяют приобретать оборудование, уже сконфигурированное для будущих потребностей, но при этом владелец
имеет возможность решать, когда и как оплачивать эти ресурсы.
Замечание
Решения Utility Pricing предоставляют отличную возможность сэкономить денежные средства. Причем экономия может оказаться столь значительной, что, как мы
думаем, не стоит приобретать или арендовать серверы, которые не поддерживают
эти решения. Почему это так, объясняется во второй части книги.
Решения Utility Pricing доступны и в случае приобретения в собственность, и при
аренде систем. Решения при приобретении системы включают:
•	 Instant Capacity («мгновенно доступная вычислительная мощность», «заранее установленные ресурсы»). Предоставление ресурсов по требованию обеспечивает
возможность приобретения системы с неактивированными компонентами. Оплата
большей части их стоимости откладывается до тех пор, пока они не понадобятся
клиенту. Эта программа поддерживает активирование процессоров и/или ячеек
вместе с находящейся в них памятью. Программа Instant Capacity была разработана
для облегчения модернизации систем — она предоставляет пользователям достаточно запасной вычислительной мощности для поддержки будущего роста, но не
требует ее полной оплаты с самого начала.
•	 Temporary Instant Capacity – возможность временно активировать Instant Capacityпроцессоры. Это позволяет заказчикам задействовать дополнительные процессорные ресурсы только на время короткой пиковой активности приложений.
Заказчики, выбравшие аренду серверов, могут получить преимущества от использования модели аренды Pay-per-use. Ее можно рассматривать как настоящую utility («коммунальные услуги») модель, в которой ежемесячные платежи основываются на реальной
загрузке сервера в предыдущем месяце.
Эти программы описаны во второй части книги.
Инструменты управления VSE и инструменты для обеспечения
высокой готовности
Уникальный уровень адаптации, обеспечиваемый VSE, позволяет устанавливать серверы
с несколькими приложениями, которые изолированы друг от друга и в то же время могут
разделять ресурсы. Кроме того, ресурсы могут динамически перераспределяться между
ними по требованию, а сами приложения могут перемещаться между серверами. Это
значительно повышает уровень использования ресурсов серверов. Более того, все это
может быть сделано незаметно для пользователей. Однако такой уровень виртуализации
и гибкости привносит и ряд новых проблем, связанных с управлением.
Глава 1 Взгляд на виртуальную серверную среду HP

Компания HP для решения этих проблем выпустила набор инструментов для управления VSE - VSE management suite. Он охватывает основные функции управления для
центров обработки данных, включая:
•	 обеспечение прикладных задач ресурсами – предоставляются инструменты, которые облегчают создание новых разделов и виртуальных машин;
•	 визуализацию и конфигурирование - с каждым продуктом для разбиения на разделы поставляются средства конфигурирования и мониторинга. Однако есть одна
существенная особенность, которая появилась вместе с выходом первой версии ПО
HP Integrity Essentials Virtualization Manager: все эти решения интегрированы на базе
единого пользовательского интерфейса, так что теперь легко идентифицировать,
какие приложения работают в каждом разделе каждого сервера центра обработки
данных;
•	 управление нагрузками - начиная с выпуска продукта HP-UX Workload Manager в
апреле 2000 года, HP остается лидером в области разработки средств управления нагрузками. Решения VSE management suite в основном базируются на этом продукте,
но можно получить более тесную их интеграцию с помощью нового продукта Global
Workload Manager;
•	 планирование мощности (capacity planning) - поскольку в VSE доступен уникальный
уровень гибкости при распределении ресурсов, необходимо, чтобы инструменты
планирования мощности имели представление о доступных на управляемых серверах технологиях. Для этого HP выпустила продукт HP Integrity Essentials Capacity
Advisor в качестве составной части VSE management suite;
•	 высокая доступность и устойчивость к сбоям. Еще одной уникальной возможностью VSE является возможность перемещения приложений от одной системы к другой. Например, это можно сделать с помощью инструментария Integrity VM, тогда
«машина» будет перемещаться вместе со всеми ресурсами и адресами. Кроме того,
HP предоставляет набор решений Serviceguard для обеспечения высокой готовности
приложений и устойчивости к сбоям. Интеграция этих продуктов в VSE management
suite упрощает наблюдение за тем, где запущены приложения, и позволяет перемещать их при отказе серверов или по другим причинам.
Эти инструменты тесно интегрированы друг с другом и с HP Systems Insight Manager
таким образом, что пользователю нет необходимости знать, какой именно инструмент
используется для выполнения задачи.
Не все возможности полностью поддерживаются в первой версии, но со временем эти
пробелы будут восполнены.
Возможности инструментов управления VSE будут подробно описаны в третьей части
книги.
Интеграция решений VSE
Мы перечислили ряд очень полезных инструментов для создания и управления адаптивным предприятием. Особенно характерно для этих решений то, что они интегрированы
друг с другом. Сейчас можно объединить ряд различных типов разделов на системе для
запуска нескольких нагрузок, обеспечить наличие в системе «запасной мощности» (ус10
Виртуальная серверная среда HP
тановленных, но неактивированных ресурсов) и автоматически активировать и перераспределять ресурсы в зависимости от нагрузок.
Поддержка операционных
систем в HP VSE
Серверы HP Integrity поддерживают четыре операционных системы (ОС) - HP-UX,
Linux, MS Windows и OpenVMS. Целью VSE является поддержка всех этих операционных систем большинством или всеми решениями. На сегодня не для всех операционных систем доступна полная функциональность решений VSE.
Флагманская операционная система HP - HP-UX. Специалисты HP в течение многих
лет работали над тем, чтобы обеспечить в HP-UX свойства безопасности, надежности,
производительности и виртуализации для выполнения критически важных (missioncritical) бизнес-приложений. Поскольку HP полностью контролирует базовый код
операционной системы HP-UX, именно для нее в первую очередь выпускаются продукты, относящиеся к VSE. Когда появляется соответствующая функциональность
на других операционных системах, продукты переносятся и тестируются на новых
платформах.
Далее в книге будет рассказано, какие операционные системы поддерживаются для
каждого из продуктов и решений, составляющих VSE. Поддержка операционных систем, отличных от HP-UX, эволюционирует, и по мере добавления новых возможностей
в эти операционные системы станет возможной и поддержка большинства решений
виртуальной серверной среды.
Продукты, график выхода и наименования
В этой книге рассматриваются многие возможности продуктов, которые на момент
написания еще не были полностью доступны. Соответственно, некоторые названия
продуктов и их возможности могли быть изменены. Там, где мы не были уверены в
окончательных названиях, мы старались использовать такие наименования, чтобы их
можно было узнать даже в случае небольшого изменения.
Кроме того, HP продолжает инвестировать в рассматриваемые здесь технологии.
Пользователи могут рассчитывать на то, что у этих продуктов регулярно будут появляться новые возможности. Мы пытались указать возможности, которые считаем
важными, но не хотели описывать конкретные версии продуктов. Перечень новых
возможностей и приоритеты их развития со временем могут измениться без всякого
уведомления.
Глава 1 Взгляд на виртуальную серверную среду HP
11
Резюме
Адаптивное предприятие с точки зрения HP – это инфраструктура ИТ, которая может
быть легко изменена в соответствии с требованиями бизнеса. Эти изменения могут быть
как обычным ежедневным всплеском загрузки OLTP (OnLine Transaction Processing)
приложения, так и результатом слияний и поглощений различных компаний. Важно,
что сегодня статическая ИТ-инфраструктура больше уже не способна обеспечить возможность проведения достаточно быстрых изменений и не удовлетворяет современным
требованиям.
Эта книга раскрывает перед читателями возможности продуктов и решений, доступных в VSE, рассказывает о том, как они могут быть скомбинированы для предоставления
уникальных решений и каким образом начать их использовать. Мы надеемся, что она
будет вам полезна.

омбинированы для предоставления
уникальных решений и каким образом начать их использовать. Мы надеемся, что она
будет вам полезна.

